/*! For license information please see 560.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[560],{7757:(e,t,i)=>{e.exports=i(5666)},1804:(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var n=i(3645),s=i.n(n)()((function(e){return e[1]}));s.push([e.id,'.review__date{margin-left:auto;margin-right:0}.review__stars{color:#f90!important}.review__comment{font-size:15px;margin-bottom:20px;margin-top:10px}.horizontal-line{background-color:#f90;border-radius:3px;content:"";display:block;filter:drop-shadow(0 3px 3px rgba(0,0,0,.45));height:3px;width:100%;z-index:0}.v-review{margin:10px 0;padding:0}',""]);const l=s},5278:(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var n=i(3645),s=i.n(n)()((function(e){return e[1]}));s.push([e.id,".v-listing{margin-bottom:10px;margin-top:10px;text-align:center}.listing{margin:0!important}.listing p{font-size:1.4rem;margin:0 auto;padding:0 10px}.listing button{background-color:#f90;border-radius:100%;color:#fff;height:2rem;width:auto}.listing button span{font-size:2rem;text-align:center}.listing button:hover{box-shadow:0 0 10px #393939}",""]);const l=s},6445:(e,t,i)=>{"use strict";i.d(t,{Z:()=>l});var n=i(3645),s=i.n(n)()((function(e){return e[1]}));s.push([e.id,"input[type=number]{width:150px}.input{height:25px!important}input[type=file]::-webkit-file-upload-button{background-color:#f90;border:2px solid #000;border-radius:5px}input[type=file]::file-selector-button{background-color:#f90;border:2px solid #000;border-radius:5px}.card__available{color:#f90}.card__not-available{color:red}.review__form{font-size:15px}.login-redirect{border-bottom:1px solid #000;display:inline;font-size:25px}.card__img-content{background:#e4e4e4;border-radius:20px;box-shadow:0 4px 4px rgba(0,0,0,.25);height:230px;margin-bottom:30px;position:relative;text-align:center;width:150px;z-index:3}.card__img{filter:drop-shadow(12px 9px 4px rgba(0,0,0,.25));-webkit-filter:drop-shadow(12px 9px 4px rgba(0,0,0,.25));height:95%;position:relative;width:auto;z-index:3}.card__text{font-size:15px!important}.col-11,.play{padding:0!important}.play{background-color:#f90;border-radius:100%;color:#fff;height:40px;margin-left:10px;width:40px}.play span{font-size:30px!important;text-align:center}",""]);const l=s},5666:e=>{var t=function(e){"use strict";var t,i=Object.prototype,n=i.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",a=s.toStringTag||"@@toStringTag";function r(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{r({},"")}catch(e){r=function(e,t,i){return e[t]=i}}function u(e,t,i,n){var s=t&&t.prototype instanceof m?t:m,l=Object.create(s.prototype),o=new P(n||[]);return l._invoke=function(e,t,i){var n=d;return function(s,l){if(n===p)throw new Error("Generator is already running");if(n===f){if("throw"===s)throw l;return L()}for(i.method=s,i.arg=l;;){var o=i.delegate;if(o){var a=A(o,i);if(a){if(a===g)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=p;var r=c(e,t,i);if("normal"===r.type){if(n=i.done?f:h,r.arg===g)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(n=f,i.method="throw",i.arg=r.arg)}}}(e,i,o),l}function c(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",h="suspendedYield",p="executing",f="completed",g={};function m(){}function v(){}function b(){}var _={};r(_,l,(function(){return this}));var y=Object.getPrototypeOf,x=y&&y(y(z([])));x&&x!==i&&n.call(x,l)&&(_=x);var w=b.prototype=m.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){r(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function i(s,l,o,a){var r=c(e[s],e,l);if("throw"!==r.type){var u=r.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,o,a)}),(function(e){i("throw",e,o,a)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return i("throw",e,o,a)}))}a(r.arg)}var s;this._invoke=function(e,n){function l(){return new t((function(t,s){i(e,n,t,s)}))}return s=s?s.then(l,l):l()}}function A(e,i){var n=e.iterator[i.method];if(n===t){if(i.delegate=null,"throw"===i.method){if(e.iterator.return&&(i.method="return",i.arg=t,A(e,i),"throw"===i.method))return g;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var s=c(n,e.iterator,i.arg);if("throw"===s.type)return i.method="throw",i.arg=s.arg,i.delegate=null,g;var l=s.arg;return l?l.done?(i[e.resultName]=l.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):l:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function z(e){if(e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function i(){for(;++s<e.length;)if(n.call(e,s))return i.value=e[s],i.done=!1,i;return i.value=t,i.done=!0,i};return o.next=o}}return{next:L}}function L(){return{value:t,done:!0}}return v.prototype=b,r(w,"constructor",b),r(b,"constructor",v),v.displayName=r(b,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,r(e,a,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},k(C.prototype),r(C.prototype,o,(function(){return this})),e.AsyncIterator=C,e.async=function(t,i,n,s,l){void 0===l&&(l=Promise);var o=new C(u(t,i,n,s),l);return e.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(w),r(w,a,"Generator"),r(w,l,(function(){return this})),r(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var n=t.pop();if(n in e)return i.value=n,i.done=!1,i}return i.done=!0,i}},e.values=z,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function s(n,s){return a.type="throw",a.arg=e,i.next=n,s&&(i.method="next",i.arg=t),!!s}for(var l=this.tryEntries.length-1;l>=0;--l){var o=this.tryEntries[l],a=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var r=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(r&&u){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(r){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var l=s;break}}l&&("break"===e||"continue"===e)&&l.tryLoc<=t&&t<=l.finallyLoc&&(l=null);var o=l?l.completion:{};return o.type=e,o.arg=t,l?(this.method="next",this.next=l.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),S(i),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var s=n.arg;S(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:z(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},6012:(e,t,i)=>{"use strict";i.d(t,{ZP:()=>C});const n={name:"colorPicker",add:function(e){const t=e.context;t.colorPicker={colorListHTML:"",_colorInput:"",_defaultColor:"#000",_styleProperty:"color",_currentColor:"",_colorList:[]},t.colorPicker.colorListHTML=this.createColorList(e,this._makeColorList)},createColorList:function(e,t){const i=e.options,n=e.lang,s=i.colorList&&0!==i.colorList.length?i.colorList:["#ff0000","#ff5e00","#ffe400","#abf200","#00d8ff","#0055ff","#6600ff","#ff00dd","#000000","#ffd8d8","#fae0d4","#faf4c0","#e4f7ba","#d4f4fa","#d9e5ff","#e8d9ff","#ffd9fa","#f1f1f1","#ffa7a7","#ffc19e","#faed7d","#cef279","#b2ebf4","#b2ccff","#d1b2ff","#ffb2f5","#bdbdbd","#f15f5f","#f29661","#e5d85c","#bce55c","#5cd1e5","#6699ff","#a366ff","#f261df","#8c8c8c","#980000","#993800","#998a00","#6b9900","#008299","#003399","#3d0099","#990085","#353535","#670000","#662500","#665c00","#476600","#005766","#002266","#290066","#660058","#222222"];let l=[],o='<div class="se-list-inner">';for(let e,i=0,n=s.length;i<n;i++)e=s[i],e&&("string"==typeof e&&(l.push(e),i<n-1)||(l.length>0&&(o+='<div class="se-selector-color">'+t(l)+"</div>",l=[]),"object"==typeof e&&(o+='<div class="se-selector-color">'+t(e)+"</div>")));return o+='<form class="se-form-group"><input type="text" maxlength="9" class="_se_color_picker_input se-color-input"/><button type="submit" class="se-btn-primary _se_color_picker_submit" title="'+n.dialogBox.submitButton+'">'+e.icons.checked+'</button><button type="button" class="se-btn _se_color_picker_remove" title="'+n.toolbar.removeFormat+'">'+e.icons.erase+"</button></form></div>",o},_makeColorList:function(e){let t="";t+='<ul class="se-color-pallet">';for(let i,n=0,s=e.length;n<s;n++)i=e[n],"string"==typeof i&&(t+='<li><button type="button" data-value="'+i+'" title="'+i+'" style="background-color:'+i+';"></button></li>');return t+="</ul>",t},init:function(e,t){const i=this.plugins.colorPicker;let n=t||(i.getColorInNode.call(this,e)||this.context.colorPicker._defaultColor);n=i.isHexColor(n)?n:i.rgb2hex(n)||n;const s=this.context.colorPicker._colorList;if(s)for(let e=0,t=s.length;e<t;e++)n.toLowerCase()===s[e].getAttribute("data-value").toLowerCase()?this.util.addClass(s[e],"active"):this.util.removeClass(s[e],"active");i.setInputText.call(this,i.colorName2hex.call(this,n))},setCurrentColor:function(e){this.context.colorPicker._currentColor=e,this.context.colorPicker._colorInput.style.borderColor=e},setInputText:function(e){e=/^#/.test(e)?e:"#"+e,this.context.colorPicker._colorInput.value=e,this.plugins.colorPicker.setCurrentColor.call(this,e)},getColorInNode:function(e){let t="";const i=this.context.colorPicker._styleProperty;for(;e&&!this.util.isWysiwygDiv(e)&&0===t.length;)1===e.nodeType&&e.style[i]&&(t=e.style[i]),e=e.parentNode;return t},isHexColor:function(e){return/^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i.test(e)},rgb2hex:function(e){const t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return t&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):""},colorName2hex:function(e){if(/^#/.test(e))return e;var t=this.util.createElement("div");t.style.display="none",t.style.color=e;var i=this._w.getComputedStyle(this._d.body.appendChild(t)).color.match(/\d+/g).map((function(e){return parseInt(e,10)}));return this.util.removeItem(t),i.length>=3&&"#"+((1<<24)+(i[0]<<16)+(i[1]<<8)+i[2]).toString(16).substr(1)}},s={name:"fontColor",display:"submenu",add:function(e,t){e.addModule([n]);const i=e.context;i.fontColor={previewEl:null,colorInput:null,colorList:null};let s=this.setSubmenu(e);i.fontColor.colorInput=s.querySelector("._se_color_picker_input"),i.fontColor.colorInput.addEventListener("keyup",this.onChangeInput.bind(e)),s.querySelector("._se_color_picker_submit").addEventListener("click",this.submit.bind(e)),s.querySelector("._se_color_picker_remove").addEventListener("click",this.remove.bind(e)),s.addEventListener("click",this.pickup.bind(e)),i.fontColor.colorList=s.querySelectorAll("li button"),e.initMenuTarget(this.name,t,s),s=null},setSubmenu:function(e){const t=e.context.colorPicker.colorListHTML,i=e.util.createElement("DIV");return i.className="se-submenu se-list-layer",i.innerHTML=t,i},on:function(){const e=this.context.colorPicker,t=this.context.fontColor;e._colorInput=t.colorInput;const i=this.wwComputedStyle.color;e._defaultColor=i?this.plugins.colorPicker.isHexColor(i)?i:this.plugins.colorPicker.rgb2hex(i):"#333333",e._styleProperty="color",e._colorList=t.colorList,this.plugins.colorPicker.init.call(this,this.getSelectionNode(),null)},onChangeInput:function(e){this.plugins.colorPicker.setCurrentColor.call(this,e.target.value)},submit:function(){this.plugins.fontColor.applyColor.call(this,this.context.colorPicker._currentColor)},pickup:function(e){e.preventDefault(),e.stopPropagation(),this.plugins.fontColor.applyColor.call(this,e.target.getAttribute("data-value"))},remove:function(){this.nodeChange(null,["color"],["span"],!0),this.submenuOff()},applyColor:function(e){if(!e)return;const t=this.util.createElement("SPAN");t.style.color=e,this.nodeChange(t,["color"],null,null),this.submenuOff()}},l={name:"hiliteColor",display:"submenu",add:function(e,t){e.addModule([n]);const i=e.context;i.hiliteColor={previewEl:null,colorInput:null,colorList:null};let s=this.setSubmenu(e);i.hiliteColor.colorInput=s.querySelector("._se_color_picker_input"),i.hiliteColor.colorInput.addEventListener("keyup",this.onChangeInput.bind(e)),s.querySelector("._se_color_picker_submit").addEventListener("click",this.submit.bind(e)),s.querySelector("._se_color_picker_remove").addEventListener("click",this.remove.bind(e)),s.addEventListener("click",this.pickup.bind(e)),i.hiliteColor.colorList=s.querySelectorAll("li button"),e.initMenuTarget(this.name,t,s),s=null},setSubmenu:function(e){const t=e.context.colorPicker.colorListHTML,i=e.util.createElement("DIV");return i.className="se-submenu se-list-layer",i.innerHTML=t,i},on:function(){const e=this.context.colorPicker,t=this.context.hiliteColor;e._colorInput=t.colorInput;const i=this.wwComputedStyle.backgroundColor;e._defaultColor=i?this.plugins.colorPicker.isHexColor(i)?i:this.plugins.colorPicker.rgb2hex(i):"#ffffff",e._styleProperty="backgroundColor",e._colorList=t.colorList,this.plugins.colorPicker.init.call(this,this.getSelectionNode(),null)},onChangeInput:function(e){this.plugins.colorPicker.setCurrentColor.call(this,e.target.value)},submit:function(){this.plugins.hiliteColor.applyColor.call(this,this.context.colorPicker._currentColor)},pickup:function(e){e.preventDefault(),e.stopPropagation(),this.plugins.hiliteColor.applyColor.call(this,e.target.getAttribute("data-value"))},remove:function(){this.nodeChange(null,["background-color"],["span"],!0),this.submenuOff()},applyColor:function(e){if(!e)return;const t=this.util.createElement("SPAN");t.style.backgroundColor=e,this.nodeChange(t,["background-color"],null,null),this.submenuOff()}},o={name:"template",display:"submenu",add:function(e,t){e.context.template={selectedIndex:-1};let i=this.setSubmenu(e);i.querySelector("ul").addEventListener("click",this.pickup.bind(e)),e.initMenuTarget(this.name,t,i),i=null},setSubmenu:function(e){const t=e.options.templates;if(!t||0===t.length)throw Error('[SUNEDITOR.plugins.template.fail] To use the "template" plugin, please define the "templates" option.');const i=e.util.createElement("DIV");i.className="se-list-layer";let n='<div class="se-submenu se-list-inner"><ul class="se-list-basic">';for(let e,i=0,s=t.length;i<s;i++)e=t[i],n+='<li><button type="button" class="se-btn-list" data-value="'+i+'" title="'+e.name+'">'+e.name+"</button></li>";return n+="</ul></div>",i.innerHTML=n,i},pickup:function(e){if(!/^BUTTON$/i.test(e.target.tagName))return!1;e.preventDefault(),e.stopPropagation(),this.context.template.selectedIndex=1*e.target.getAttribute("data-value");const t=this.options.templates[this.context.template.selectedIndex];if(!t.html)throw this.submenuOff(),Error('[SUNEDITOR.template.fail] cause : "templates[i].html not found"');this.setContents(t.html),this.submenuOff()}};var a=i(8784),r=i.n(a);const u={name:"selectMenu",add:function(e){e.context.selectMenu={caller:{},callerContext:null}},setForm:function(){return'<div class="se-select-list"></div>'},createList:function(e,t,i){e.form.innerHTML="<ul>"+i+"</ul>",e.items=t,e.menus=e.form.querySelectorAll("li")},initEvent:function(e,t){const i=t.querySelector(".se-select-list"),n=this.context.selectMenu.caller[e]={form:i,items:[],menus:[],index:-1,item:null,clickMethod:null,callerName:e};i.addEventListener("mousedown",this.plugins.selectMenu.onMousedown_list),i.addEventListener("mousemove",this.plugins.selectMenu.onMouseMove_list.bind(this,n)),i.addEventListener("click",this.plugins.selectMenu.onClick_list.bind(this,n))},onMousedown_list:function(e){e.preventDefault(),e.stopPropagation()},onMouseMove_list:function(e,t){this.util.addClass(e.form,"__se_select-menu-mouse-move");const i=t.target.getAttribute("data-index");i&&(e.index=1*i)},onClick_list:function(e,t){const i=t.target.getAttribute("data-index");i&&e.clickMethod.call(this,e.items[i])},moveItem:function(e,t){this.util.removeClass(e.form,"__se_select-menu-mouse-move"),t=e.index+t;const i=e.menus,n=i.length,s=e.index=t>=n?0:t<0?n-1:t;for(let e=0;e<n;e++)e===s?this.util.addClass(i[e],"active"):this.util.removeClass(i[e],"active");e.item=e.items[s]},getItem:function(e,t){return t=!t||t<0?e.index:t,e.items[t]},on:function(e,t){const i=this.context.selectMenu.caller[e];this.context.selectMenu.callerContext=i,i.clickMethod=t,i.callerName=e},open:function(e,t){const i=e.form;i.style.visibility="hidden",i.style.display="block",t(i),i.style.visibility=""},close:function(e){e.form.style.display="none",e.items=[],e.menus=[],e.index=-1,e.item=null},init:function(e){e&&(e.items=[],e.menus=[],e.index=-1,e.item=null,e.callerName="",this.context.selectMenu.callerContext=null)}},c={name:"anchor",add:function(e){e.addModule([u]),e.context.anchor={caller:{},forms:this.setDialogForm(e),host:(e._w.location.origin+e._w.location.pathname).replace(/\/$/,""),callerContext:null}},setDialogForm:function(e){const t=e.lang,i=e.options.linkRel,n=(e.options.linkRelDefault.default||"").split(" "),s=e.icons,l=e.util.createElement("DIV");let o='<div class="se-dialog-body"><div class="se-dialog-form"><label>'+t.dialogBox.linkBox.url+'</label><div class="se-dialog-form-files"><input class="se-input-form se-input-url" type="text" placeholder="'+(e.options.protocol||"")+'" /><button type="button" class="se-btn se-dialog-files-edge-button _se_bookmark_button" title="'+t.dialogBox.linkBox.bookmark+'">'+s.bookmark+"</button>"+e.plugins.selectMenu.setForm()+'</div><div class="se-anchor-preview-form"><span class="se-svg se-anchor-preview-icon _se_anchor_bookmark_icon">'+s.bookmark+'</span><span class="se-svg se-anchor-preview-icon _se_anchor_download_icon">'+s.download+'</span><pre class="se-link-preview"></pre></div></div><div class="se-dialog-form"><label>'+t.dialogBox.linkBox.text+'</label><input class="se-input-form _se_anchor_text" type="text" /></div><div class="se-dialog-form-footer"><label><input type="checkbox" class="se-dialog-btn-check _se_anchor_check" />&nbsp;'+t.dialogBox.linkBox.newWindowCheck+'</label><label><input type="checkbox" class="se-dialog-btn-check _se_anchor_download" />&nbsp;'+t.dialogBox.linkBox.downloadLinkCheck+"</label>";if(i.length>0){o+='<div class="se-anchor-rel"><button type="button" class="se-btn se-btn-select se-anchor-rel-btn">&lt;rel&gt;</button><div class="se-anchor-rel-wrapper"><pre class="se-link-preview se-anchor-rel-preview"></pre></div><div class="se-list-layer"><div class="se-list-inner"><ul class="se-list-basic se-list-checked">';for(let e,t=0,l=i.length;t<l;t++)e=i[t],o+='<li><button type="button" class="se-btn-list'+(n.indexOf(e)>-1?" se-checked":"")+'" data-command="'+e+'" title="'+e+'"><span class="se-svg">'+s.checked+"</span>"+e+"</button></li>";o+="</ul></div></div></div>"}return o+="</div></div>",l.innerHTML=o,l},initEvent:function(e,t){const i=this.plugins.anchor,n=this.context.anchor.caller[e]={modal:t,urlInput:null,linkDefaultRel:this.options.linkRelDefault,defaultRel:this.options.linkRelDefault.default||"",currentRel:[],linkAnchor:null,linkValue:"",_change:!1,callerName:e};"string"==typeof n.linkDefaultRel.default&&(n.linkDefaultRel.default=n.linkDefaultRel.default.trim()),"string"==typeof n.linkDefaultRel.check_new_window&&(n.linkDefaultRel.check_new_window=n.linkDefaultRel.check_new_window.trim()),"string"==typeof n.linkDefaultRel.check_bookmark&&(n.linkDefaultRel.check_bookmark=n.linkDefaultRel.check_bookmark.trim()),n.urlInput=t.querySelector(".se-input-url"),n.anchorText=t.querySelector("._se_anchor_text"),n.newWindowCheck=t.querySelector("._se_anchor_check"),n.downloadCheck=t.querySelector("._se_anchor_download"),n.download=t.querySelector("._se_anchor_download_icon"),n.preview=t.querySelector(".se-link-preview"),n.bookmark=t.querySelector("._se_anchor_bookmark_icon"),n.bookmarkButton=t.querySelector("._se_bookmark_button"),this.plugins.selectMenu.initEvent.call(this,e,t);const s=this.context.selectMenu.caller[e];this.options.linkRel.length>0&&(n.relButton=t.querySelector(".se-anchor-rel-btn"),n.relList=t.querySelector(".se-list-layer"),n.relPreview=t.querySelector(".se-anchor-rel-preview"),n.relButton.addEventListener("click",i.onClick_relButton.bind(this,n)),n.relList.addEventListener("click",i.onClick_relList.bind(this,n))),n.newWindowCheck.addEventListener("change",i.onChange_newWindowCheck.bind(this,n)),n.downloadCheck.addEventListener("change",i.onChange_downloadCheck.bind(this,n)),n.anchorText.addEventListener("input",i.onChangeAnchorText.bind(this,n)),n.urlInput.addEventListener("input",i.onChangeUrlInput.bind(this,n)),n.urlInput.addEventListener("keydown",i.onKeyDownUrlInput.bind(this,s)),n.urlInput.addEventListener("focus",i.onFocusUrlInput.bind(this,n,s)),n.urlInput.addEventListener("blur",i.onBlurUrlInput.bind(this,s)),n.bookmarkButton.addEventListener("click",i.onClick_bookmarkButton.bind(this,n))},on:function(e,t){const i=this.plugins.anchor;if(t){if(e.linkAnchor){this.context.dialog.updateModal=!0;const t=this.options.linkNoPrefix?e.linkAnchor.href.replace(e.linkAnchor.origin+"/",""):e.linkAnchor.href;e.linkValue=e.preview.textContent=e.urlInput.value=i.selfPathBookmark.call(this,t)?t.substr(t.lastIndexOf("#")):t,e.anchorText.value=e.linkAnchor.textContent||e.linkAnchor.getAttribute("alt"),e.newWindowCheck.checked=!!/_blank/i.test(e.linkAnchor.target),e.downloadCheck.checked=e.linkAnchor.download}}else i.init.call(this,e),e.anchorText.value=this.getSelection().toString().trim(),e.newWindowCheck.checked=this.options.linkTargetNewWindow;this.context.anchor.callerContext=e,i.setRel.call(this,e,t&&e.linkAnchor?e.linkAnchor.rel:e.defaultRel),i.setLinkPreview.call(this,e,e.linkValue),this.plugins.selectMenu.on.call(this,e.callerName,this.plugins.anchor.setHeaderBookmark)},selfPathBookmark:function(e){const t=this._w.location.href.replace(/\/$/,"");return 0===e.indexOf("#")||0===e.indexOf(t)&&e.indexOf("#")===(-1===t.indexOf("#")?t.length:t.substr(0,t.indexOf("#")).length)},_closeRelMenu:null,toggleRelList:function(e,t){if(t){const t=e.relButton,i=e.relList;this.util.addClass(t,"active"),i.style.visibility="hidden",i.style.display="block",this.options.rtl?i.style.left=t.offsetLeft-i.offsetWidth-1+"px":i.style.left=t.offsetLeft+t.offsetWidth+1+"px",i.style.top=t.offsetTop+t.offsetHeight/2-i.offsetHeight/2+"px",i.style.visibility="",this.plugins.anchor._closeRelMenu=function(e,t,i){i&&(e.relButton.contains(i.target)||e.relList.contains(i.target))||(this.util.removeClass(t,"active"),e.relList.style.display="none",this.modalForm.removeEventListener("click",this.plugins.anchor._closeRelMenu),this.plugins.anchor._closeRelMenu=null)}.bind(this,e,t),this.modalForm.addEventListener("click",this.plugins.anchor._closeRelMenu)}else this.plugins.anchor._closeRelMenu&&this.plugins.anchor._closeRelMenu()},onClick_relButton:function(e,t){this.plugins.anchor.toggleRelList.call(this,e,!this.util.hasClass(t.target,"active"))},onClick_relList:function(e,t){const i=t.target,n=i.getAttribute("data-command");if(!n)return;const s=e.currentRel,l=this.util.toggleClass(i,"se-checked"),o=s.indexOf(n);l?-1===o&&s.push(n):o>-1&&s.splice(o,1),e.relPreview.title=e.relPreview.textContent=s.join(" ")},setRel:function(e,t){const i=e.relList,n=e.currentRel=t?t.split(" "):[];if(!i)return;const s=i.querySelectorAll("button");for(let e,t=0,i=s.length;t<i;t++)e=s[t].getAttribute("data-command"),n.indexOf(e)>-1?this.util.addClass(s[t],"se-checked"):this.util.removeClass(s[t],"se-checked");e.relPreview.title=e.relPreview.textContent=n.join(" ")},createHeaderList:function(e,t,i){const n=this.util.getListChildren(this.context.element.wysiwyg,(function(e){return/h[1-6]/i.test(e.nodeName)}));if(0===n.length)return;const s=new this._w.RegExp("^"+i.replace(/^#/,""),"i"),l=[];let o="";for(let e,t=0,i=n.length;t<i;t++)e=n[t],s.test(e.textContent)&&(l.push(e),o+='<li class="se-select-item" data-index="'+t+'">'+e.textContent+"</li>");0===l.length?this.plugins.selectMenu.close.call(this,t):(this.plugins.selectMenu.createList(t,l,o),this.plugins.selectMenu.open.call(this,t,this.plugins.anchor._setMenuListPosition.bind(this,e)))},_setMenuListPosition:function(e,t){t.style.top=e.urlInput.offsetHeight+1+"px"},onKeyDownUrlInput:function(e,t){switch(t.keyCode){case 38:t.preventDefault(),t.stopPropagation(),this.plugins.selectMenu.moveItem.call(this,e,-1);break;case 40:t.preventDefault(),t.stopPropagation(),this.plugins.selectMenu.moveItem.call(this,e,1);break;case 13:e.index>-1&&(t.preventDefault(),t.stopPropagation(),this.plugins.anchor.setHeaderBookmark.call(this,this.plugins.selectMenu.getItem(e,null)))}},setHeaderBookmark:function(e){const t=this.context.anchor.callerContext,i=e.id||"h_"+this._w.Math.random().toString().replace(/.+\./,"");e.id=i,t.urlInput.value="#"+i,t.anchorText.value.trim()&&t._change||(t.anchorText.value=e.textContent),this.plugins.anchor.setLinkPreview.call(this,t,t.urlInput.value),this.plugins.selectMenu.close.call(this,this.context.selectMenu.callerContext),this.context.anchor.callerContext.urlInput.focus()},onChangeAnchorText:function(e,t){e._change=!!t.target.value.trim()},onChangeUrlInput:function(e,t){const i=t.target.value.trim();this.plugins.anchor.setLinkPreview.call(this,e,i),this.plugins.anchor.selfPathBookmark.call(this,i)?this.plugins.anchor.createHeaderList.call(this,e,this.context.selectMenu.callerContext,i):this.plugins.selectMenu.close.call(this,this.context.selectMenu.callerContext)},onFocusUrlInput:function(e,t){const i=e.urlInput.value;this.plugins.anchor.selfPathBookmark.call(this,i)&&this.plugins.anchor.createHeaderList.call(this,e,t,i)},onBlurUrlInput:function(e){this.plugins.selectMenu.close.call(this,e)},setLinkPreview:function(e,t){const i=e.preview,n=this.options.linkProtocol,s=this.options.linkNoPrefix,l=/^(mailto\:|tel\:|sms\:|https*\:\/\/|#)/.test(t),o=!!n&&this._w.RegExp("^"+t.substr(0,n.length)).test(n);t=e.linkValue=i.textContent=t?s?t:!n||l||o?l?t:/^www\./.test(t)?"http://"+t:this.context.anchor.host+(/^\//.test(t)?"":"/")+t:n+t:"",this.plugins.anchor.selfPathBookmark.call(this,t)?(e.bookmark.style.display="block",this.util.addClass(e.bookmarkButton,"active")):(e.bookmark.style.display="none",this.util.removeClass(e.bookmarkButton,"active")),!this.plugins.anchor.selfPathBookmark.call(this,t)&&e.downloadCheck.checked?e.download.style.display="block":e.download.style.display="none"},setCtx:function(e,t){e&&(t.linkAnchor=e,t.linkValue=e.href,t.currentRel=e.rel.split(" "))},updateAnchor:function(e,t,i,n,s){!this.plugins.anchor.selfPathBookmark.call(this,t)&&n.downloadCheck.checked?e.setAttribute("download",i||t):e.removeAttribute("download"),n.newWindowCheck.checked?e.target="_blank":e.removeAttribute("target");const l=n.currentRel.join(" ");l?e.rel=l:e.removeAttribute("rel"),e.href=t,e.setAttribute("alt",i),s?0===e.children.length&&(e.textContent=""):e.textContent=i},createAnchor:function(e,t){if(0===e.linkValue.length)return null;const i=e.linkValue,n=e.anchorText,s=0===n.value.length?i:n.value,l=e.linkAnchor||this.util.createElement("A");return this.plugins.anchor.updateAnchor.call(this,l,i,s,e,t),e.linkValue=e.preview.textContent=e.urlInput.value=e.anchorText.value="",l},onClick_bookmarkButton:function(e){let t=e.urlInput.value;this.plugins.anchor.selfPathBookmark.call(this,t)?(t=t.substr(1),e.bookmark.style.display="none",this.util.removeClass(e.bookmarkButton,"active"),this.plugins.selectMenu.close.call(this,this.context.selectMenu.callerContext)):(t="#"+t,e.bookmark.style.display="block",this.util.addClass(e.bookmarkButton,"active"),e.downloadCheck.checked=!1,e.download.style.display="none",this.plugins.anchor.createHeaderList.call(this,e,this.context.selectMenu.callerContext,t)),e.urlInput.value=t,this.plugins.anchor.setLinkPreview.call(this,e,t),e.urlInput.focus()},onChange_newWindowCheck:function(e,t){"string"==typeof e.linkDefaultRel.check_new_window&&(t.target.checked?this.plugins.anchor.setRel.call(this,e,this.plugins.anchor._relMerge.call(this,e,e.linkDefaultRel.check_new_window)):this.plugins.anchor.setRel.call(this,e,this.plugins.anchor._relDelete.call(this,e,e.linkDefaultRel.check_new_window)))},onChange_downloadCheck:function(e,t){t.target.checked?(e.download.style.display="block",e.bookmark.style.display="none",this.util.removeClass(e.bookmarkButton,"active"),e.linkValue=e.preview.textContent=e.urlInput.value=e.urlInput.value.replace(/^\#+/,""),"string"==typeof e.linkDefaultRel.check_bookmark&&this.plugins.anchor.setRel.call(this,e,this.plugins.anchor._relMerge.call(this,e,e.linkDefaultRel.check_bookmark))):(e.download.style.display="none","string"==typeof e.linkDefaultRel.check_bookmark&&this.plugins.anchor.setRel.call(this,e,this.plugins.anchor._relDelete.call(this,e,e.linkDefaultRel.check_bookmark)))},_relMerge:function(e,t){const i=e.currentRel;if(!t)return i.join(" ");if(/^only\:/.test(t))return t=t.replace(/^only\:/,"").trim(),e.currentRel=t.split(" "),t;const n=t.split(" ");for(let e,t=0,s=n.length;t<s;t++)e=i.indexOf(n[t]),-1===e&&i.push(n[t]);return i.join(" ")},_relDelete:function(e,t){if(!t)return e.currentRel.join(" ");/^only\:/.test(t)&&(t=t.replace(/^only\:/,"").trim());const i=e.currentRel.join(" ").replace(this._w.RegExp(t+"\\s*"),"");return e.currentRel=i.split(" "),i},init:function(e){e.linkAnchor=null,e.linkValue=e.preview.textContent=e.urlInput.value="",e.anchorText.value="",e.newWindowCheck.checked=!1,e.downloadCheck.checked=!1,e._change=!1,this.plugins.anchor.setRel.call(this,e,e.defaultRel),e.relList&&this.plugins.anchor.toggleRelList.call(this,e,!1),this.context.anchor.callerContext=null,this.plugins.selectMenu.init.call(this,this.context.selectMenu.callerContext)}},d={name:"link",display:"dialog",add:function(e){e.addModule([r(),c]);const t=e.context,i=t.link={focusElement:null,_linkAnchor:null,anchorCtx:null};let n=this.setDialog(e);i.modal=n;let s=this.setController_LinkButton(e);i.linkController=s,n.querySelector("form").addEventListener("submit",this.submit.bind(e)),s.addEventListener("click",this.onClick_linkController.bind(e)),t.dialog.modal.appendChild(n),t.element.relative.appendChild(s),e.plugins.anchor.initEvent.call(e,"link",n),i.focusElement=t.anchor.caller.link.urlInput,n=null,s=null},setDialog:function(e){const t=e.lang,i=e.util.createElement("DIV"),n=e.icons;i.className="se-dialog-content",i.style.display="none";let s='<form><div class="se-dialog-header"><button type="button" data-command="close" class="se-btn se-dialog-close" aria-label="Close" title="'+t.dialogBox.close+'">'+n.cancel+'</button><span class="se-modal-title">'+t.dialogBox.linkBox.title+"</span></div>"+e.context.anchor.forms.innerHTML+'<div class="se-dialog-footer"><button type="submit" class="se-btn-primary" title="'+t.dialogBox.submitButton+'"><span>'+t.dialogBox.submitButton+"</span></button></div></form>";return i.innerHTML=s,i},setController_LinkButton:function(e){const t=e.lang,i=e.icons,n=e.util.createElement("DIV");return n.className="se-controller se-controller-link",n.innerHTML='<div class="se-arrow se-arrow-up"></div><div class="link-content"><span><a target="_blank" href=""></a>&nbsp;</span><div class="se-btn-group"><button type="button" data-command="update" tabindex="-1" class="se-btn se-tooltip">'+i.edit+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.edit+'</span></span></button><button type="button" data-command="unlink" tabindex="-1" class="se-btn se-tooltip">'+i.unlink+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.unlink+'</span></span></button><button type="button" data-command="delete" tabindex="-1" class="se-btn se-tooltip">'+i.delete+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.remove+"</span></span></button></div></div>",n},open:function(){this.plugins.dialog.open.call(this,"link","link"===this.currentControllerName)},submit:function(e){this.showLoading(),e.preventDefault(),e.stopPropagation();try{const e=this.plugins.anchor.createAnchor.call(this,this.context.anchor.caller.link,!1);if(null===e)return;if(this.context.dialog.updateModal){const e=this.context.link._linkAnchor.childNodes[0];this.setRange(e,0,e,e.textContent.length)}else{const t=this.getSelectedElements();if(t.length>1){const i=this.util.createElement(t[0].nodeName);if(i.appendChild(e),!this.insertNode(i,null,!0))return}else if(!this.insertNode(e,null,!0))return;this.setRange(e.childNodes[0],0,e.childNodes[0],e.textContent.length)}}finally{this.plugins.dialog.close.call(this),this.closeLoading(),this.history.push(!1)}return!1},active:function(e){if(e){if(this.util.isAnchor(e)&&null===e.getAttribute("data-image-link"))return this.controllerArray.indexOf(this.context.link.linkController)<0&&this.plugins.link.call_controller.call(this,e),!0}else this.controllerArray.indexOf(this.context.link.linkController)>-1&&this.controllersOff();return!1},on:function(e){this.plugins.anchor.on.call(this,this.context.anchor.caller.link,e)},call_controller:function(e){this.editLink=this.context.link._linkAnchor=this.context.anchor.caller.link.linkAnchor=e;const t=this.context.link.linkController,i=t.querySelector("a");i.href=e.href,i.title=e.textContent,i.textContent=e.textContent,this.util.addClass(e,"on"),this.setControllerPosition(t,e,"bottom",{left:0,top:0}),this.controllersOn(t,e,"link",this.util.removeClass.bind(this.util,this.context.link._linkAnchor,"on"))},onClick_linkController:function(e){e.stopPropagation();const t=e.target.getAttribute("data-command")||e.target.parentNode.getAttribute("data-command");if(t){if(e.preventDefault(),/update/.test(t))this.plugins.dialog.open.call(this,"link",!0);else if(/unlink/.test(t)){const e=this.util.getChildElement(this.context.link._linkAnchor,(function(e){return 0===e.childNodes.length||3===e.nodeType}),!1),t=this.util.getChildElement(this.context.link._linkAnchor,(function(e){return 0===e.childNodes.length||3===e.nodeType}),!0);this.setRange(e,0,t,t.textContent.length),this.nodeChange(null,null,["A"],!1)}else this.util.removeItem(this.context.link._linkAnchor),this.context.anchor.caller.link.linkAnchor=null,this.focus(),this.history.push(!1);this.controllersOff()}},init:function(){this.context.link.linkController.style.display="none",this.plugins.anchor.init.call(this,this.context.anchor.caller.link)}};var h=i(1841),p=i.n(h),f=i(5076),g=i.n(f),m=i(2527),v=i.n(m);const b={name:"image",display:"dialog",add:function(e){e.addModule([r(),c,p(),g(),v()]);const t=e.options,i=e.context,n=i.image={_infoList:[],_infoIndex:0,_uploadFileLength:0,focusElement:null,sizeUnit:t._imageSizeUnit,_linkElement:"",_altText:"",_align:"none",_floatClassRegExp:"__se__float\\-[a-z]+",_v_src:{_linkValue:""},svgDefaultSize:"30%",base64RenderIndex:0,_element:null,_cover:null,_container:null,inputX:null,inputY:null,_element_w:1,_element_h:1,_element_l:0,_element_t:0,_defaultSizeX:"auto",_defaultSizeY:"auto",_origin_w:"auto"===t.imageWidth?"":t.imageWidth,_origin_h:"auto"===t.imageHeight?"":t.imageHeight,_proportionChecked:!0,_resizing:t.imageResizing,_resizeDotHide:!t.imageHeightShow,_rotation:t.imageRotation,_alignHide:!t.imageAlignShow,_onlyPercentage:t.imageSizeOnlyPercentage,_ratio:!1,_ratioX:1,_ratioY:1,_captionShow:!0,_captionChecked:!1,_caption:null,captionCheckEl:null};let s=this.setDialog(e);n.modal=s,n.imgInputFile=s.querySelector("._se_image_file"),n.imgUrlFile=s.querySelector("._se_image_url"),n.focusElement=n.imgInputFile||n.imgUrlFile,n.altText=s.querySelector("._se_image_alt"),n.captionCheckEl=s.querySelector("._se_image_check_caption"),n.previewSrc=s.querySelector("._se_tab_content_image .se-link-preview"),s.querySelector(".se-dialog-tabs").addEventListener("click",this.openTab.bind(e)),s.querySelector("form").addEventListener("submit",this.submit.bind(e)),n.imgInputFile&&s.querySelector(".se-file-remove").addEventListener("click",this._removeSelectedFiles.bind(n.imgInputFile,n.imgUrlFile,n.previewSrc)),n.imgUrlFile&&n.imgUrlFile.addEventListener("input",this._onLinkPreview.bind(n.previewSrc,n._v_src,t.linkProtocol)),n.imgInputFile&&n.imgUrlFile&&n.imgInputFile.addEventListener("change",this._fileInputChange.bind(n));const l=s.querySelector(".__se__gallery");l&&l.addEventListener("click",this._openGallery.bind(e)),n.proportion={},n.inputX={},n.inputY={},t.imageResizing&&(n.proportion=s.querySelector("._se_image_check_proportion"),n.inputX=s.querySelector("._se_image_size_x"),n.inputY=s.querySelector("._se_image_size_y"),n.inputX.value=t.imageWidth,n.inputY.value=t.imageHeight,n.inputX.addEventListener("keyup",this.setInputSize.bind(e,"x")),n.inputY.addEventListener("keyup",this.setInputSize.bind(e,"y")),n.inputX.addEventListener("change",this.setRatio.bind(e)),n.inputY.addEventListener("change",this.setRatio.bind(e)),n.proportion.addEventListener("change",this.setRatio.bind(e)),s.querySelector(".se-dialog-btn-revert").addEventListener("click",this.sizeRevert.bind(e))),i.dialog.modal.appendChild(s),e.plugins.anchor.initEvent.call(e,"image",s.querySelector("._se_tab_content_url")),n.anchorCtx=e.context.anchor.caller.image,s=null},setDialog:function(e){const t=e.options,i=e.lang,n=e.util.createElement("DIV");n.className="se-dialog-content se-dialog-image",n.style.display="none";let s='<div class="se-dialog-header"><button type="button" data-command="close" class="se-btn se-dialog-close" class="close" aria-label="Close" title="'+i.dialogBox.close+'">'+e.icons.cancel+'</button><span class="se-modal-title">'+i.dialogBox.imageBox.title+'</span></div><div class="se-dialog-tabs"><button type="button" class="_se_tab_link active" data-tab-link="image">'+i.toolbar.image+'</button><button type="button" class="_se_tab_link" data-tab-link="url">'+i.toolbar.link+'</button></div><form method="post" enctype="multipart/form-data"><div class="_se_tab_content _se_tab_content_image"><div class="se-dialog-body"><div style="border-bottom: 1px dashed #ccc;">';if(t.imageFileInput&&(s+='<div class="se-dialog-form"><label>'+i.dialogBox.imageBox.file+'</label><div class="se-dialog-form-files"><input class="se-input-form _se_image_file" type="file" accept="'+t.imageAccept+'"'+(t.imageMultipleFile?' multiple="multiple"':"")+'/><button type="button" class="se-btn se-dialog-files-edge-button se-file-remove" title="'+i.controller.remove+'">'+e.icons.cancel+"</button></div></div>"),t.imageUrlInput&&(s+='<div class="se-dialog-form"><label>'+i.dialogBox.imageBox.url+'</label><div class="se-dialog-form-files"><input class="se-input-form se-input-url _se_image_url" type="text" />'+(t.imageGalleryUrl&&e.plugins.imageGallery?'<button type="button" class="se-btn se-dialog-files-edge-button __se__gallery" title="'+i.toolbar.imageGallery+'">'+e.icons.image_gallery+"</button>":"")+'</div><pre class="se-link-preview"></pre></div>'),s+='</div><div class="se-dialog-form"><label>'+i.dialogBox.imageBox.altText+'</label><input class="se-input-form _se_image_alt" type="text" /></div>',t.imageResizing){const n=t.imageSizeOnlyPercentage,l=n?' style="display: none !important;"':"",o=t.imageHeightShow?"":' style="display: none !important;"';s+='<div class="se-dialog-form">',n||!t.imageHeightShow?s+='<div class="se-dialog-size-text"><label class="size-w">'+i.dialogBox.size+"</label></div>":s+='<div class="se-dialog-size-text"><label class="size-w">'+i.dialogBox.width+'</label><label class="se-dialog-size-x">&nbsp;</label><label class="size-h">'+i.dialogBox.height+"</label></div>",s+='<input class="se-input-control _se_image_size_x" placeholder="auto"'+(n?' type="number" min="1"':'type="text"')+(n?' max="100"':"")+' /><label class="se-dialog-size-x"'+o+">"+(n?"%":"x")+'</label><input type="text" class="se-input-control _se_image_size_y" placeholder="auto"'+l+(n?' max="100"':"")+o+"/><label"+l+o+'><input type="checkbox" class="se-dialog-btn-check _se_image_check_proportion" checked/>&nbsp;'+i.dialogBox.proportion+'</label><button type="button" title="'+i.dialogBox.revertButton+'" class="se-btn se-dialog-btn-revert" style="float: right;">'+e.icons.revert+"</button></div>"}return s+='<div class="se-dialog-form se-dialog-form-footer"><label><input type="checkbox" class="se-dialog-btn-check _se_image_check_caption" />&nbsp;'+i.dialogBox.caption+'</label></div></div></div><div class="_se_tab_content _se_tab_content_url" style="display: none">'+e.context.anchor.forms.innerHTML+'</div><div class="se-dialog-footer"><div'+(t.imageAlignShow?"":' style="display: none"')+'><label><input type="radio" name="suneditor_image_radio" class="se-dialog-btn-radio" value="none" checked>'+i.dialogBox.basic+'</label><label><input type="radio" name="suneditor_image_radio" class="se-dialog-btn-radio" value="left">'+i.dialogBox.left+'</label><label><input type="radio" name="suneditor_image_radio" class="se-dialog-btn-radio" value="center">'+i.dialogBox.center+'</label><label><input type="radio" name="suneditor_image_radio" class="se-dialog-btn-radio" value="right">'+i.dialogBox.right+'</label></div><button type="submit" class="se-btn-primary" title="'+i.dialogBox.submitButton+'"><span>'+i.dialogBox.submitButton+"</span></button></div></form>",n.innerHTML=s,n},_fileInputChange:function(){this.imgInputFile.value?(this.imgUrlFile.setAttribute("disabled",!0),this.previewSrc.style.textDecoration="line-through"):(this.imgUrlFile.removeAttribute("disabled"),this.previewSrc.style.textDecoration="")},_removeSelectedFiles:function(e,t){this.value="",e&&(e.removeAttribute("disabled"),t.style.textDecoration="")},_openGallery:function(){this.callPlugin("imageGallery",this.plugins.imageGallery.open.bind(this,this.plugins.image._setUrlInput.bind(this.context.image)),null)},_setUrlInput:function(e){this.altText.value=e.alt,this._v_src._linkValue=this.previewSrc.textContent=this.imgUrlFile.value=e.src,this.imgUrlFile.focus()},_onLinkPreview:function(e,t,i){const n=i.target.value.trim();e._linkValue=this.textContent=n?t&&-1===n.indexOf("://")&&0!==n.indexOf("#")?t+n:-1===n.indexOf("://")?"/"+n:n:""},fileTags:["img"],select:function(e){this.plugins.image.onModifyMode.call(this,e,this.plugins.resizing.call_controller_resize.call(this,e,"image"))},destroy:function(e){const t=e||this.context.image._element,i=this.util.getParentElement(t,this.util.isMediaComponent)||t,n=1*t.getAttribute("data-index");let s=i.previousElementSibling||i.nextElementSibling;const l=i.parentNode;this.util.removeItem(i),this.plugins.image.init.call(this),this.controllersOff(),l!==this.context.element.wysiwyg&&this.util.removeItemAllParents(l,(function(e){return 0===e.childNodes.length}),null),this.focusEdge(s),this.plugins.fileManager.deleteInfo.call(this,"image",n,this.functions.onImageUpload),this.history.push(!1)},on:function(e){const t=this.context.image;e?t.imgInputFile&&this.options.imageMultipleFile&&t.imgInputFile.removeAttribute("multiple"):(t.inputX.value=t._origin_w=this.options.imageWidth===t._defaultSizeX?"":this.options.imageWidth,t.inputY.value=t._origin_h=this.options.imageHeight===t._defaultSizeY?"":this.options.imageHeight,t.imgInputFile&&this.options.imageMultipleFile&&t.imgInputFile.setAttribute("multiple","multiple")),this.plugins.anchor.on.call(this,t.anchorCtx,e)},open:function(){this.plugins.dialog.open.call(this,"image","image"===this.currentControllerName)},openTab:function(e){const t=this.context.image.modal,i="init"===e?t.querySelector("._se_tab_link"):e.target;if(!/^BUTTON$/i.test(i.tagName))return!1;const n=i.getAttribute("data-tab-link"),s="_se_tab_content";let l,o,a;for(o=t.getElementsByClassName(s),l=0;l<o.length;l++)o[l].style.display="none";for(a=t.getElementsByClassName("_se_tab_link"),l=0;l<a.length;l++)this.util.removeClass(a[l],"active");return t.querySelector("._se_tab_content_"+n).style.display="block",this.util.addClass(i,"active"),"image"===n&&this.context.image.focusElement?this.context.image.focusElement.focus():"url"===n&&this.context.anchor.caller.image.urlInput.focus(),!1},submit:function(e){const t=this.context.image,i=this.plugins.image;e.preventDefault(),e.stopPropagation(),t._altText=t.altText.value,t._align=t.modal.querySelector('input[name="suneditor_image_radio"]:checked').value,t._captionChecked=t.captionCheckEl.checked,t._resizing&&(t._proportionChecked=t.proportion.checked);try{this.context.dialog.updateModal&&i.update_image.call(this,!1,!0,!1),t.imgInputFile&&t.imgInputFile.files.length>0?(this.showLoading(),i.submitAction.call(this,this.context.image.imgInputFile.files)):t.imgUrlFile&&t._v_src._linkValue.length>0&&(this.showLoading(),i.onRender_imgUrl.call(this,t._v_src._linkValue))}catch(e){throw this.closeLoading(),Error('[SUNEDITOR.image.submit.fail] cause : "'+e.message+'"')}finally{this.plugins.dialog.close.call(this)}return!1},submitAction:function(e){if(0===e.length)return;let t=0,i=[];for(let n=0,s=e.length;n<s;n++)/image/i.test(e[n].type)&&(i.push(e[n]),t+=e[n].size);const n=this.options.imageUploadSizeLimit;if(n>0){let e=0;const i=this.context.image._infoList;for(let t=0,n=i.length;t<n;t++)e+=1*i[t].size;if(t+e>n){this.closeLoading();const i="[SUNEDITOR.imageUpload.fail] Size of uploadable total images: "+n/1e3+"KB";return void(("function"!=typeof this.functions.onImageUploadError||this.functions.onImageUploadError(i,{limitSize:n,currentSize:e,uploadSize:t},this))&&this.functions.noticeOpen(i))}}const s=this.context.image;s._uploadFileLength=i.length;const l={anchor:this.plugins.anchor.createAnchor.call(this,s.anchorCtx,!0),inputWidth:s.inputX.value,inputHeight:s.inputY.value,align:s._align,isUpdate:this.context.dialog.updateModal,alt:s._altText,element:s._element};if("function"==typeof this.functions.onImageUploadBefore){const e=this.functions.onImageUploadBefore(i,l,this,function(e){e&&this._w.Array.isArray(e.result)?this.plugins.image.register.call(this,l,e):this.plugins.image.upload.call(this,l,e)}.bind(this));if(void 0===e)return;if(!e)return void this.closeLoading();this._w.Array.isArray(e)&&e.length>0&&(i=e)}this.plugins.image.upload.call(this,l,i)},error:function(e,t){if(this.closeLoading(),"function"!=typeof this.functions.onImageUploadError||this.functions.onImageUploadError(e,t,this))throw this.functions.noticeOpen(e),Error("[SUNEDITOR.plugin.image.error] response: "+e)},upload:function(e,t){if(!t)return void this.closeLoading();if("string"==typeof t)return void this.plugins.image.error.call(this,t,null);const i=this.options.imageUploadUrl,n=this.context.dialog.updateModal?1:t.length;if("string"==typeof i&&i.length>0){const s=new FormData;for(let e=0;e<n;e++)s.append("file-"+e,t[e]);this.plugins.fileManager.upload.call(this,i,this.options.imageUploadHeader,s,this.plugins.image.callBack_imgUpload.bind(this,e),this.functions.onImageUploadError)}else this.plugins.image.setup_reader.call(this,t,e.anchor,e.inputWidth,e.inputHeight,e.align,e.alt,n,e.isUpdate)},callBack_imgUpload:function(e,t){if("function"==typeof this.functions.imageUploadHandler)this.functions.imageUploadHandler(t,e,this);else{const i=JSON.parse(t.responseText);i.errorMessage?this.plugins.image.error.call(this,i.errorMessage,i):this.plugins.image.register.call(this,e,i)}},register:function(e,t){const i=t.result;for(let t,n=0,s=i.length;n<s;n++){if(t={name:i[n].name,size:i[n].size},e.isUpdate){this.plugins.image.update_src.call(this,i[n].url,e.element,t);break}this.plugins.image.create_image.call(this,i[n].url,e.anchor,e.inputWidth,e.inputHeight,e.align,t,e.alt)}this.closeLoading()},setup_reader:function(e,t,i,n,s,l,o,a){try{this.context.image.base64RenderIndex=o;const r=this._w.FileReader,u=[o];this.context.image.inputX.value=i,this.context.image.inputY.value=n;for(let c,d,h=0;h<o;h++)c=new r,d=e[h],c.onload=function(e,o,a,r,c){u[c]={result:e.result,file:r},0==--this.context.image.base64RenderIndex&&(this.plugins.image.onRender_imgBase64.call(this,o,u,a,t,i,n,s,l),this.closeLoading())}.bind(this,c,a,this.context.image._element,d,h),c.readAsDataURL(d)}catch(e){throw this.closeLoading(),Error('[SUNEDITOR.image.setup_reader.fail] cause : "'+e.message+'"')}},onRender_imgBase64:function(e,t,i,n,s,l,o,a){const r=this.plugins.image.update_src,u=this.plugins.image.create_image;for(let c=0,d=t.length;c<d;c++)e?(this.context.image._element.setAttribute("data-file-name",t[c].file.name),this.context.image._element.setAttribute("data-file-size",t[c].file.size),r.call(this,t[c].result,i,t[c].file)):u.call(this,t[c].result,n,s,l,o,t[c].file,a)},onRender_imgUrl:function(e){if(e||(e=this.context.image._v_src._linkValue),!e)return!1;const t=this.context.image;try{const i={name:e.split("/").pop(),size:0};this.context.dialog.updateModal?this.plugins.image.update_src.call(this,e,t._element,i):this.plugins.image.create_image.call(this,e,this.plugins.anchor.createAnchor.call(this,t.anchorCtx,!0),t.inputX.value,t.inputY.value,t._align,i,t._altText)}catch(e){throw Error('[SUNEDITOR.image.URLRendering.fail] cause : "'+e.message+'"')}finally{this.closeLoading()}},onRender_link:function(e,t){return t?(t.setAttribute("data-image-link","image"),e.setAttribute("data-image-link",t.href),t.appendChild(e),t):e},setInputSize:function(e,t){t&&32===t.keyCode?t.preventDefault():this.plugins.resizing._module_setInputSize.call(this,this.context.image,e)},setRatio:function(){this.plugins.resizing._module_setRatio.call(this,this.context.image)},checkFileInfo:function(){const e=this.plugins.image,t=this.context.image,i=function(i){e.onModifyMode.call(this,i,null),e.openModify.call(this,!0),t.inputX.value=t._origin_w,t.inputY.value=t._origin_h;const n=this.util.getFormatElement(i);n&&(t._align=n.style.textAlign||n.style.float);this.util.getParentElement(i,this.util.isAnchor)&&!t.anchorCtx.linkValue&&(t.anchorCtx.linkValue=" "),e.update_image.call(this,!0,!1,!0),e.init.call(this)}.bind(this);this.plugins.fileManager.checkInfo.call(this,"image",["img"],this.functions.onImageUpload,i,!0)},resetFileInfo:function(){this.plugins.fileManager.resetInfo.call(this,"image",this.functions.onImageUpload)},create_image:function(e,t,i,n,s,l,o){const a=this.plugins.image,r=this.context.image;this.context.resizing._resize_plugin="image";let u=this.util.createElement("IMG");u.src=e,u.alt=o,u.setAttribute("data-rotate","0"),t=a.onRender_link.call(this,u,t),r._resizing&&u.setAttribute("data-proportion",r._proportionChecked);const c=this.plugins.component.set_cover.call(this,t),d=this.plugins.component.set_container.call(this,c,"se-image-container");r._captionChecked&&(r._caption=this.plugins.component.create_caption.call(this),r._caption.setAttribute("contenteditable",!1),c.appendChild(r._caption)),r._element=u,r._cover=c,r._container=d,a.applySize.call(this,i,n),a.setAlign.call(this,s,u,c,d),u.onload=a._image_create_onload.bind(this,u,r.svgDefaultSize,d),this.insertComponent(d,!0,!0,!0)&&this.plugins.fileManager.setInfo.call(this,"image",u,this.functions.onImageUpload,l,!0),this.context.resizing._resize_plugin=""},_image_create_onload:function(e,t,i){if(0===e.offsetWidth&&this.plugins.image.applySize.call(this,t,""),this.options.mediaAutoSelect)this.selectComponent(e,"image");else{const e=this.appendFormatTag(i,null);e&&this.setRange(e,0,e,0)}},update_image:function(e,t,i){const n=this.context.image;let s,l=n._element,o=n._cover,a=n._container,r=!1;null===o&&(r=!0,l=n._element.cloneNode(!0),o=this.plugins.component.set_cover.call(this,l)),null===a?(o=o.cloneNode(!0),l=o.querySelector("img"),r=!0,a=this.plugins.component.set_container.call(this,o,"se-image-container")):r&&(a.innerHTML="",a.appendChild(o),n._cover=o,n._element=l,r=!1);const u=this.util.isNumber(n.inputX.value)?n.inputX.value+n.sizeUnit:n.inputX.value,c=this.util.isNumber(n.inputY.value)?n.inputY.value+n.sizeUnit:n.inputY.value;s=/%$/.test(l.style.width)?u!==a.style.width||c!==a.style.height:u!==l.style.width||c!==l.style.height,l.alt=n._altText;let d=!1;n._captionChecked?n._caption||(n._caption=this.plugins.component.create_caption.call(this),o.appendChild(n._caption),d=!0):n._caption&&(this.util.removeItem(n._caption),n._caption=null,d=!0);const h=this.plugins.anchor.createAnchor.call(this,n.anchorCtx,!0);if(h)n._linkElement!==h?(n._linkElement=h.cloneNode(!1),o.insertBefore(this.plugins.image.onRender_link.call(this,l,n._linkElement),n._caption),this.util.removeItem(h)):n._linkElement.setAttribute("data-image-link","image");else if(null!==n._linkElement){const e=l;if(e.setAttribute("data-image-link",""),o.contains(n._linkElement)){const t=e.cloneNode(!0);o.removeChild(n._linkElement),o.insertBefore(t,n._caption),n._element=l=t}}if(r){const e=this.util.isRangeFormatElement(n._element.parentNode)||this.util.isWysiwygDiv(n._element.parentNode)?n._element:/^A$/i.test(n._element.parentNode.nodeName)?n._element.parentNode:this.util.getFormatElement(n._element)||n._element;if(this.util.isListCell(e)||this.util.isFormatElement(e))n._element.parentNode.replaceChild(a,n._element);else if(this.util.isFormatElement(e)&&e.childNodes.length>0)e.parentNode.insertBefore(a,e),this.util.removeItem(n._element),this.util.removeEmptyNode(e,null),0===e.children.length&&(e.innerHTML=this.util.htmlRemoveWhiteSpace(e.innerHTML));else if(this.util.isFormatElement(e.parentNode)){const t=e.parentNode;t.parentNode.insertBefore(a,e.previousSibling?t.nextElementSibling:t),this.util.removeItem(e)}else e.parentNode.replaceChild(a,e);l=a.querySelector("img"),n._element=l,n._cover=o,n._container=a}(d||!n._onlyPercentage&&s)&&!e&&(/\d+/.test(l.style.height)||this.context.resizing._rotateVertical&&n._captionChecked)&&(/%$/.test(n.inputX.value)||/%$/.test(n.inputY.value)?this.plugins.resizing.resetTransform.call(this,l):this.plugins.resizing.setTransformSize.call(this,l,this.util.getNumber(n.inputX.value,0),this.util.getNumber(n.inputY.value,0))),n._resizing&&(l.setAttribute("data-proportion",n._proportionChecked),s&&this.plugins.image.applySize.call(this)),this.plugins.image.setAlign.call(this,null,l,null,null),e&&this.plugins.fileManager.setInfo.call(this,"image",l,this.functions.onImageUpload,null,!0),t&&this.selectComponent(l,"image"),i||this.history.push(!1)},update_src:function(e,t,i){t.src=e,this._w.setTimeout(this.plugins.fileManager.setInfo.bind(this,"image",t,this.functions.onImageUpload,i,!0)),this.selectComponent(t,"image")},onModifyMode:function(e,t){if(!e)return;const i=this.context.image;i._linkElement=i.anchorCtx.linkAnchor=/^A$/i.test(e.parentNode.nodeName)?e.parentNode:null,i._element=e,i._cover=this.util.getParentElement(e,"FIGURE"),i._container=this.util.getParentElement(e,this.util.isMediaComponent),i._caption=this.util.getChildElement(i._cover,"FIGCAPTION"),i._align=e.style.float||e.getAttribute("data-align")||"none",e.style.float="",this.plugins.anchor.setCtx(i._linkElement,i.anchorCtx),t&&(i._element_w=t.w,i._element_h=t.h,i._element_t=t.t,i._element_l=t.l);let n,s,l=i._element.getAttribute("data-size")||i._element.getAttribute("data-origin");l?(l=l.split(","),n=l[0],s=l[1]):t&&(n=t.w,s=t.h),i._origin_w=n||e.style.width||e.width||"",i._origin_h=s||e.style.height||e.height||""},openModify:function(e){const t=this.context.image;t.imgUrlFile&&(t._v_src._linkValue=t.previewSrc.textContent=t.imgUrlFile.value=t._element.src),t._altText=t.altText.value=t._element.alt,(t.modal.querySelector('input[name="suneditor_image_radio"][value="'+t._align+'"]')||t.modal.querySelector('input[name="suneditor_image_radio"][value="none"]')).checked=!0,t._align=t.modal.querySelector('input[name="suneditor_image_radio"]:checked').value,t._captionChecked=t.captionCheckEl.checked=!!t._caption,t._resizing&&this.plugins.resizing._module_setModifyInputSize.call(this,t,this.plugins.image),e||this.plugins.dialog.open.call(this,"image",!0)},applySize:function(e,t){const i=this.context.image;return e||(e=i.inputX.value||this.options.imageWidth),t||(t=i.inputY.value||this.options.imageHeight),i._onlyPercentage&&e||/%$/.test(e)?(this.plugins.image.setPercentSize.call(this,e,t),!0):(e&&"auto"!==e||t&&"auto"!==t?this.plugins.image.setSize.call(this,e,t,!1):this.plugins.image.setAutoSize.call(this),!1)},sizeRevert:function(){this.plugins.resizing._module_sizeRevert.call(this,this.context.image)},setSize:function(e,t,i,n){const s=this.context.image,l=/^(rw|lw)$/.test(n);/^(th|bh)$/.test(n)||(s._element.style.width=this.util.isNumber(e)?e+s.sizeUnit:e,this.plugins.image.cancelPercentAttr.call(this)),l||(s._element.style.height=this.util.isNumber(t)?t+s.sizeUnit:/%$/.test(t)?"":t),"center"===s._align&&this.plugins.image.setAlign.call(this,null,null,null,null),i||s._element.removeAttribute("data-percentage"),this.plugins.resizing._module_saveCurrentSize.call(this,s)},setAutoSize:function(){const e=this.context.image;this.plugins.resizing.resetTransform.call(this,e._element),this.plugins.image.cancelPercentAttr.call(this),e._element.style.maxWidth="",e._element.style.width="",e._element.style.height="",e._cover.style.width="",e._cover.style.height="",this.plugins.image.setAlign.call(this,null,null,null,null),e._element.setAttribute("data-percentage","auto,auto"),this.plugins.resizing._module_saveCurrentSize.call(this,e)},setOriginSize:function(){const e=this.context.image;e._element.removeAttribute("data-percentage"),this.plugins.resizing.resetTransform.call(this,e._element),this.plugins.image.cancelPercentAttr.call(this);const t=(e._element.getAttribute("data-origin")||"").split(","),i=t[0],n=t[1];t&&(e._onlyPercentage||/%$/.test(i)&&(/%$/.test(n)||!/\d/.test(n))?this.plugins.image.setPercentSize.call(this,i,n):this.plugins.image.setSize.call(this,i,n),this.plugins.resizing._module_saveCurrentSize.call(this,e))},setPercentSize:function(e,t){const i=this.context.image;t=!t||/%$/.test(t)||this.util.getNumber(t,0)?this.util.isNumber(t)?t+i.sizeUnit:t||"":this.util.isNumber(t)?t+"%":t;const n=/%$/.test(t);i._container.style.width=this.util.isNumber(e)?e+"%":e,i._container.style.height="",i._cover.style.width="100%",i._cover.style.height=n?t:"",i._element.style.width="100%",i._element.style.height=n?"":t,i._element.style.maxWidth="","center"===i._align&&this.plugins.image.setAlign.call(this,null,null,null,null),i._element.setAttribute("data-percentage",e+","+t),this.plugins.resizing.setCaptionPosition.call(this,i._element),this.plugins.resizing._module_saveCurrentSize.call(this,i)},cancelPercentAttr:function(){const e=this.context.image;e._cover.style.width="",e._cover.style.height="",e._container.style.width="",e._container.style.height="",this.util.removeClass(e._container,this.context.image._floatClassRegExp),this.util.addClass(e._container,"__se__float-"+e._align),"center"===e._align&&this.plugins.image.setAlign.call(this,null,null,null,null)},setAlign:function(e,t,i,n){const s=this.context.image;e||(e=s._align),t||(t=s._element),i||(i=s._cover),n||(n=s._container),i.style.margin=e&&"none"!==e?"auto":"0",/%$/.test(t.style.width)&&"center"===e?(n.style.minWidth="100%",i.style.width=n.style.width):(n.style.minWidth="",i.style.width=this.context.resizing._rotateVertical?t.style.height||t.offsetHeight:t.style.width&&"auto"!==t.style.width?t.style.width||"100%":""),this.util.hasClass(n,"__se__float-"+e)||(this.util.removeClass(n,s._floatClassRegExp),this.util.addClass(n,"__se__float-"+e)),t.setAttribute("data-align",e)},init:function(){const e=this.context.image;e.imgInputFile&&(e.imgInputFile.value=""),e.imgUrlFile&&(e._v_src._linkValue=e.previewSrc.textContent=e.imgUrlFile.value=""),e.imgInputFile&&e.imgUrlFile&&(e.imgUrlFile.removeAttribute("disabled"),e.previewSrc.style.textDecoration=""),e.altText.value="",e.modal.querySelector('input[name="suneditor_image_radio"][value="none"]').checked=!0,e.captionCheckEl.checked=!1,e._element=null,this.plugins.image.openTab.call(this,"init"),e._resizing&&(e.inputX.value=this.options.imageWidth===e._defaultSizeX?"":this.options.imageWidth,e.inputY.value=this.options.imageHeight===e._defaultSizeY?"":this.options.imageHeight,e.proportion.checked=!0,e._ratio=!1,e._ratioX=1,e._ratioY=1),this.plugins.anchor.init.call(this,e.anchorCtx)}},_={name:"video",display:"dialog",add:function(e){e.addModule([r(),p(),g(),v()]);const t=e.options,i=e.context,n=i.video={_infoList:[],_infoIndex:0,_uploadFileLength:0,focusElement:null,sizeUnit:t._videoSizeUnit,_align:"none",_floatClassRegExp:"__se__float\\-[a-z]+",_youtubeQuery:t.youtubeQuery,_videoRatio:100*t.videoRatio+"%",_defaultRatio:100*t.videoRatio+"%",_linkValue:"",_element:null,_cover:null,_container:null,inputX:null,inputY:null,_element_w:1,_element_h:1,_element_l:0,_element_t:0,_defaultSizeX:"100%",_defaultSizeY:100*t.videoRatio+"%",_origin_w:"100%"===t.videoWidth?"":t.videoWidth,_origin_h:"56.25%"===t.videoHeight?"":t.videoHeight,_proportionChecked:!0,_resizing:t.videoResizing,_resizeDotHide:!t.videoHeightShow,_rotation:t.videoRotation,_alignHide:!t.videoAlignShow,_onlyPercentage:t.videoSizeOnlyPercentage,_ratio:!1,_ratioX:1,_ratioY:1,_captionShow:!1};let s=this.setDialog(e);n.modal=s,n.videoInputFile=s.querySelector("._se_video_file"),n.videoUrlFile=s.querySelector(".se-input-url"),n.focusElement=n.videoUrlFile||n.videoInputFile,n.preview=s.querySelector(".se-link-preview"),s.querySelector("form").addEventListener("submit",this.submit.bind(e)),n.videoInputFile&&s.querySelector(".se-dialog-files-edge-button").addEventListener("click",this._removeSelectedFiles.bind(n.videoInputFile,n.videoUrlFile,n.preview)),n.videoInputFile&&n.videoUrlFile&&n.videoInputFile.addEventListener("change",this._fileInputChange.bind(n)),n.videoUrlFile&&n.videoUrlFile.addEventListener("input",this._onLinkPreview.bind(n.preview,n,t.linkProtocol)),n.proportion={},n.videoRatioOption={},n.inputX={},n.inputY={},t.videoResizing&&(n.proportion=s.querySelector("._se_video_check_proportion"),n.videoRatioOption=s.querySelector(".se-video-ratio"),n.inputX=s.querySelector("._se_video_size_x"),n.inputY=s.querySelector("._se_video_size_y"),n.inputX.value=t.videoWidth,n.inputY.value=t.videoHeight,n.inputX.addEventListener("keyup",this.setInputSize.bind(e,"x")),n.inputY.addEventListener("keyup",this.setInputSize.bind(e,"y")),n.inputX.addEventListener("change",this.setRatio.bind(e)),n.inputY.addEventListener("change",this.setRatio.bind(e)),n.proportion.addEventListener("change",this.setRatio.bind(e)),n.videoRatioOption.addEventListener("change",this.setVideoRatio.bind(e)),s.querySelector(".se-dialog-btn-revert").addEventListener("click",this.sizeRevert.bind(e))),i.dialog.modal.appendChild(s),s=null},setDialog:function(e){const t=e.options,i=e.lang,n=e.util.createElement("DIV");n.className="se-dialog-content",n.style.display="none";let s='<form method="post" enctype="multipart/form-data"><div class="se-dialog-header"><button type="button" data-command="close" class="se-btn se-dialog-close" aria-label="Close" title="'+i.dialogBox.close+'">'+e.icons.cancel+'</button><span class="se-modal-title">'+i.dialogBox.videoBox.title+'</span></div><div class="se-dialog-body">';if(t.videoFileInput&&(s+='<div class="se-dialog-form"><label>'+i.dialogBox.videoBox.file+'</label><div class="se-dialog-form-files"><input class="se-input-form _se_video_file" type="file" accept="'+t.videoAccept+'"'+(t.videoMultipleFile?' multiple="multiple"':"")+'/><button type="button" data-command="filesRemove" class="se-btn se-dialog-files-edge-button se-file-remove" title="'+i.controller.remove+'">'+e.icons.cancel+"</button></div></div>"),t.videoUrlInput&&(s+='<div class="se-dialog-form"><label>'+i.dialogBox.videoBox.url+'</label><input class="se-input-form se-input-url" type="text" /><pre class="se-link-preview"></pre></div>'),t.videoResizing){const n=t.videoRatioList||[{name:"16:9",value:.5625},{name:"4:3",value:.75},{name:"21:9",value:.4285}],l=t.videoRatio,o=t.videoSizeOnlyPercentage,a=o?' style="display: none !important;"':"",r=t.videoHeightShow?"":' style="display: none !important;"',u=t.videoRatioShow?"":' style="display: none !important;"',c=o||t.videoHeightShow||t.videoRatioShow?"":' style="display: none !important;"';s+='<div class="se-dialog-form"><div class="se-dialog-size-text"><label class="size-w">'+i.dialogBox.width+'</label><label class="se-dialog-size-x">&nbsp;</label><label class="size-h"'+r+">"+i.dialogBox.height+'</label><label class="size-h"'+u+">("+i.dialogBox.ratio+')</label></div><input class="se-input-control _se_video_size_x" placeholder="100%"'+(o?' type="number" min="1"':'type="text"')+(o?' max="100"':"")+'/><label class="se-dialog-size-x"'+c+">"+(o?"%":"x")+'</label><input class="se-input-control _se_video_size_y" placeholder="'+100*t.videoRatio+'%"'+(o?' type="number" min="1"':'type="text"')+(o?' max="100"':"")+r+'/><select class="se-input-select se-video-ratio" title="'+i.dialogBox.ratio+'"'+u+">",r||(s+='<option value=""> - </option>');for(let e=0,t=n.length;e<t;e++)s+='<option value="'+n[e].value+'"'+(l.toString()===n[e].value.toString()?" selected":"")+">"+n[e].name+"</option>";s+='</select><button type="button" title="'+i.dialogBox.revertButton+'" class="se-btn se-dialog-btn-revert" style="float: right;">'+e.icons.revert+'</button></div><div class="se-dialog-form se-dialog-form-footer"'+a+c+'><label><input type="checkbox" class="se-dialog-btn-check _se_video_check_proportion" checked/>&nbsp;'+i.dialogBox.proportion+"</label></div>"}return s+='</div><div class="se-dialog-footer"><div'+(t.videoAlignShow?"":' style="display: none"')+'><label><input type="radio" name="suneditor_video_radio" class="se-dialog-btn-radio" value="none" checked>'+i.dialogBox.basic+'</label><label><input type="radio" name="suneditor_video_radio" class="se-dialog-btn-radio" value="left">'+i.dialogBox.left+'</label><label><input type="radio" name="suneditor_video_radio" class="se-dialog-btn-radio" value="center">'+i.dialogBox.center+'</label><label><input type="radio" name="suneditor_video_radio" class="se-dialog-btn-radio" value="right">'+i.dialogBox.right+'</label></div><button type="submit" class="se-btn-primary" title="'+i.dialogBox.submitButton+'"><span>'+i.dialogBox.submitButton+"</span></button></div></form>",n.innerHTML=s,n},_fileInputChange:function(){this.videoInputFile.value?(this.videoUrlFile.setAttribute("disabled",!0),this.preview.style.textDecoration="line-through"):(this.videoUrlFile.removeAttribute("disabled"),this.preview.style.textDecoration="")},_removeSelectedFiles:function(e,t){this.value="",e&&(e.removeAttribute("disabled"),t.style.textDecoration="")},_onLinkPreview:function(e,t,i){const n=i.target.value.trim();/^<iframe.*\/iframe>$/.test(n)?(e._linkValue=n,this.textContent='<IFrame :src=".."></IFrame>'):e._linkValue=this.textContent=n?t&&-1===n.indexOf("://")&&0!==n.indexOf("#")?t+n:-1===n.indexOf("://")?"/"+n:n:""},_setTagAttrs:function(e){e.setAttribute("controls",!0);const t=this.options.videoTagAttrs;if(t)for(let i in t)this.util.hasOwn(t,i)&&e.setAttribute(i,t[i])},createVideoTag:function(){const e=this.util.createElement("VIDEO");return this.plugins.video._setTagAttrs.call(this,e),e},_setIframeAttrs:function(e){e.frameBorder="0",e.allowFullscreen=!0;const t=this.options.videoIframeAttrs;if(t)for(let i in t)this.util.hasOwn(t,i)&&e.setAttribute(i,t[i])},createIframeTag:function(){const e=this.util.createElement("IFRAME");return this.plugins.video._setIframeAttrs.call(this,e),e},fileTags:["iframe","video"],select:function(e){this.plugins.video.onModifyMode.call(this,e,this.plugins.resizing.call_controller_resize.call(this,e,"video"))},destroy:function(e){const t=e||this.context.video._element,i=this.context.video._container,n=1*t.getAttribute("data-index");let s=i.previousElementSibling||i.nextElementSibling;const l=i.parentNode;this.util.removeItem(i),this.plugins.video.init.call(this),this.controllersOff(),l!==this.context.element.wysiwyg&&this.util.removeItemAllParents(l,(function(e){return 0===e.childNodes.length}),null),this.focusEdge(s),this.plugins.fileManager.deleteInfo.call(this,"video",n,this.functions.onVideoUpload),this.history.push(!1)},on:function(e){const t=this.context.video;e?t.videoInputFile&&this.options.videoMultipleFile&&t.videoInputFile.removeAttribute("multiple"):(t.inputX.value=t._origin_w=this.options.videoWidth===t._defaultSizeX?"":this.options.videoWidth,t.inputY.value=t._origin_h=this.options.videoHeight===t._defaultSizeY?"":this.options.videoHeight,t.proportion.disabled=!0,t.videoInputFile&&this.options.videoMultipleFile&&t.videoInputFile.setAttribute("multiple","multiple")),t._resizing&&this.plugins.video.setVideoRatioSelect.call(this,t._origin_h||t._defaultRatio)},open:function(){this.plugins.dialog.open.call(this,"video","video"===this.currentControllerName)},setVideoRatio:function(e){const t=this.context.video,i=e.target.options[e.target.selectedIndex].value;t._defaultSizeY=t._videoRatio=i?100*i+"%":t._defaultSizeY,t.inputY.placeholder=i?100*i+"%":"",t.inputY.value=""},setInputSize:function(e,t){if(t&&32===t.keyCode)return void t.preventDefault();const i=this.context.video;this.plugins.resizing._module_setInputSize.call(this,i,e),"y"===e&&this.plugins.video.setVideoRatioSelect.call(this,t.target.value||i._defaultRatio)},setRatio:function(){this.plugins.resizing._module_setRatio.call(this,this.context.video)},submit:function(e){const t=this.context.video,i=this.plugins.video;e.preventDefault(),e.stopPropagation(),t._align=t.modal.querySelector('input[name="suneditor_video_radio"]:checked').value;try{t.videoInputFile&&t.videoInputFile.files.length>0?(this.showLoading(),i.submitAction.call(this,this.context.video.videoInputFile.files)):t.videoUrlFile&&t._linkValue.length>0&&(this.showLoading(),i.setup_url.call(this,t._linkValue))}catch(e){throw this.closeLoading(),Error('[SUNEDITOR.video.submit.fail] cause : "'+e.message+'"')}finally{this.plugins.dialog.close.call(this)}return!1},submitAction:function(e){if(0===e.length)return;let t=0,i=[];for(let n=0,s=e.length;n<s;n++)/video/i.test(e[n].type)&&(i.push(e[n]),t+=e[n].size);const n=this.options.videoUploadSizeLimit;if(n>0){let e=0;const i=this.context.video._infoList;for(let t=0,n=i.length;t<n;t++)e+=1*i[t].size;if(t+e>n){this.closeLoading();const i="[SUNEDITOR.videoUpload.fail] Size of uploadable total videos: "+n/1e3+"KB";return void(("function"!=typeof this.functions.onVideoUploadError||this.functions.onVideoUploadError(i,{limitSize:n,currentSize:e,uploadSize:t},this))&&this.functions.noticeOpen(i))}}const s=this.context.video;s._uploadFileLength=i.length;const l={inputWidth:s.inputX.value,inputHeight:s.inputY.value,align:s._align,isUpdate:this.context.dialog.updateModal,element:s._element};if("function"==typeof this.functions.onVideoUploadBefore){const e=this.functions.onVideoUploadBefore(i,l,this,function(e){e&&this._w.Array.isArray(e.result)?this.plugins.video.register.call(this,l,e):this.plugins.video.upload.call(this,l,e)}.bind(this));if(void 0===e)return;if(!e)return void this.closeLoading();"object"==typeof e&&e.length>0&&(i=e)}this.plugins.video.upload.call(this,l,i)},error:function(e,t){if(this.closeLoading(),"function"!=typeof this.functions.onVideoUploadError||this.functions.onVideoUploadError(e,t,this))throw this.functions.noticeOpen(e),Error("[SUNEDITOR.plugin.video.error] response: "+e)},upload:function(e,t){if(!t)return void this.closeLoading();if("string"==typeof t)return void this.plugins.video.error.call(this,t,null);const i=this.options.videoUploadUrl,n=this.context.dialog.updateModal?1:t.length;if(!("string"==typeof i&&i.length>0))throw Error('[SUNEDITOR.videoUpload.fail] cause : There is no "videoUploadUrl" option.');{const s=new FormData;for(let e=0;e<n;e++)s.append("file-"+e,t[e]);this.plugins.fileManager.upload.call(this,i,this.options.videoUploadHeader,s,this.plugins.video.callBack_videoUpload.bind(this,e),this.functions.onVideoUploadError)}},callBack_videoUpload:function(e,t){if("function"==typeof this.functions.videoUploadHandler)this.functions.videoUploadHandler(t,e,this);else{const i=JSON.parse(t.responseText);i.errorMessage?this.plugins.video.error.call(this,i.errorMessage,i):this.plugins.video.register.call(this,e,i)}},register:function(e,t){const i=t.result,n=this.plugins.video.createVideoTag.call(this);for(let t,s=0,l=i.length;s<l;s++)t={name:i[s].name,size:i[s].size},this.plugins.video.create_video.call(this,e.isUpdate?e.element:n.cloneNode(!1),i[s].url,e.inputWidth,e.inputHeight,e.align,t,e.isUpdate);this.closeLoading()},setup_url:function(e){try{const t=this.context.video;if(e||(e=t._linkValue),!e)return!1;if(/^<iframe.*\/iframe>$/.test(e)){if(0===(e=(new this._w.DOMParser).parseFromString(e,"text/html").querySelector("iframe").src).length)return!1}if(/youtu\.?be/.test(e)){if(/^http/.test(e)||(e="https://"+e),e=e.replace("watch?v=",""),/^\/\/.+\/embed\//.test(e)||(e=e.replace(e.match(/\/\/.+\//)[0],"//www.youtube.com/embed/").replace("&","?&")),t._youtubeQuery.length>0)if(/\?/.test(e)){const i=e.split("?");e=i[0]+"?"+t._youtubeQuery+"&"+i[1]}else e+="?"+t._youtubeQuery}else/vimeo\.com/.test(e)&&(e.endsWith("/")&&(e=e.slice(0,-1)),e="https://player.vimeo.com/video/"+e.slice(e.lastIndexOf("/")+1));this.plugins.video.create_video.call(this,this.plugins.video[/youtu\.?be/.test(e)||/vimeo\.com/.test(e)?"createIframeTag":"createVideoTag"].call(this),e,t.inputX.value,t.inputY.value,t._align,null,this.context.dialog.updateModal)}catch(e){throw Error('[SUNEDITOR.video.upload.fail] cause : "'+e.message+'"')}finally{this.closeLoading()}},create_video:function(e,t,i,n,s,l,o){this.context.resizing._resize_plugin="video";const a=this.context.video;let r=null,u=null,c=!1;if(o){if((e=a._element).src!==t){c=!0;const i=/youtu\.?be/.test(t),n=/vimeo\.com/.test(t);if(!i&&!n||/^iframe$/i.test(e.nodeName))if(i||n||/^videoo$/i.test(e.nodeName))e.src=t;else{const i=this.plugins.video.createVideoTag.call(this);i.src=t,e.parentNode.replaceChild(i,e),a._element=e=i}else{const i=this.plugins.video.createIframeTag.call(this);i.src=t,e.parentNode.replaceChild(i,e),a._element=e=i}}u=a._container,r=this.util.getParentElement(e,"FIGURE")}else c=!0,e.src=t,a._element=e,r=this.plugins.component.set_cover.call(this,e),u=this.plugins.component.set_container.call(this,r,"se-video-container");a._cover=r,a._container=u;const d=this.plugins.resizing._module_getSizeX.call(this,a)!==(i||a._defaultSizeX)||this.plugins.resizing._module_getSizeY.call(this,a)!==(n||a._videoRatio),h=!o||d;a._resizing&&(this.context.video._proportionChecked=a.proportion.checked,e.setAttribute("data-proportion",a._proportionChecked));let p=!1;h&&(p=this.plugins.video.applySize.call(this)),p&&"center"===s||this.plugins.video.setAlign.call(this,null,e,r,u);let f=!0;if(o)a._resizing&&this.context.resizing._rotateVertical&&h&&this.plugins.resizing.setTransformSize.call(this,e,null,null);else if(f=this.insertComponent(u,!1,!0,!this.options.mediaAutoSelect),!this.options.mediaAutoSelect){const e=this.appendFormatTag(u,null);e&&this.setRange(e,0,e,0)}f&&(c&&this.plugins.fileManager.setInfo.call(this,"video",e,this.functions.onVideoUpload,l,!0),o&&(this.selectComponent(e,"video"),this.history.push(!1))),this.context.resizing._resize_plugin=""},_update_videoCover:function(e){if(!e)return;const t=this.context.video;/^video$/i.test(e.nodeName)?this.plugins.video._setTagAttrs.call(this,e):this.plugins.video._setIframeAttrs.call(this,e);const i=this.util.isRangeFormatElement(e.parentNode)||this.util.isWysiwygDiv(e.parentNode)?e:this.util.getFormatElement(e)||e,n=e;t._element=e=e.cloneNode(!0);const s=t._cover=this.plugins.component.set_cover.call(this,e),l=t._container=this.plugins.component.set_container.call(this,s,"se-video-container");try{const o=i.querySelector("figcaption");let a=null;o&&(a=this.util.createElement("DIV"),a.innerHTML=o.innerHTML,this.util.removeItem(o));const r=(e.getAttribute("data-size")||e.getAttribute("data-origin")||"").split(",");this.plugins.video.applySize.call(this,r[0]||n.style.width||n.width||"",r[1]||n.style.height||n.height||"");const u=this.util.getFormatElement(n);u&&(t._align=u.style.textAlign||u.style.float),this.plugins.video.setAlign.call(this,null,e,s,l),this.util.isListCell(i)||this.util.isFormatElement(i)?n.parentNode.replaceChild(l,n):this.util.isFormatElement(i)&&i.childNodes.length>0?(i.parentNode.insertBefore(l,i),this.util.removeItem(n),this.util.removeEmptyNode(i,null),0===i.children.length&&(i.innerHTML=this.util.htmlRemoveWhiteSpace(i.innerHTML))):i.parentNode.replaceChild(l,i),a&&i.parentNode.insertBefore(a,l.nextElementSibling)}catch(e){console.warn("[SUNEDITOR.video.error] Maybe the video tag is nested.",e)}this.plugins.fileManager.setInfo.call(this,"video",e,this.functions.onVideoUpload,null,!0),this.plugins.video.init.call(this)},onModifyMode:function(e,t){const i=this.context.video;i._element=e,i._cover=this.util.getParentElement(e,"FIGURE"),i._container=this.util.getParentElement(e,this.util.isMediaComponent),i._align=e.style.float||e.getAttribute("data-align")||"none",e.style.float="",t&&(i._element_w=t.w,i._element_h=t.h,i._element_t=t.t,i._element_l=t.l);let n,s,l=i._element.getAttribute("data-size")||i._element.getAttribute("data-origin");l?(l=l.split(","),n=l[0],s=l[1]):t&&(n=t.w,s=t.h),i._origin_w=n||e.style.width||e.width||"",i._origin_h=s||e.style.height||e.height||""},openModify:function(e){const t=this.context.video;if(t.videoUrlFile&&(t._linkValue=t.preview.textContent=t.videoUrlFile.value=t._element.src||(t._element.querySelector("source")||"").src||""),(t.modal.querySelector('input[name="suneditor_video_radio"][value="'+t._align+'"]')||t.modal.querySelector('input[name="suneditor_video_radio"][value="none"]')).checked=!0,t._resizing){this.plugins.resizing._module_setModifyInputSize.call(this,t,this.plugins.video);const e=t._videoRatio=this.plugins.resizing._module_getSizeY.call(this,t);this.plugins.video.setVideoRatioSelect.call(this,e)||(t.inputY.value=t._onlyPercentage?this.util.getNumber(e,2):e)}e||this.plugins.dialog.open.call(this,"video",!0)},setVideoRatioSelect:function(e){let t=!1;const i=this.context.video,n=i.videoRatioOption.options;/%$/.test(e)||i._onlyPercentage?e=this.util.getNumber(e,2)/100+"":(!this.util.isNumber(e)||1*e>=1)&&(e=""),i.inputY.placeholder="";for(let s=0,l=n.length;s<l;s++)n[s].value===e?(t=n[s].selected=!0,i.inputY.placeholder=e?100*e+"%":""):n[s].selected=!1;return t},checkFileInfo:function(){this.plugins.fileManager.checkInfo.call(this,"video",["iframe","video"],this.functions.onVideoUpload,this.plugins.video._update_videoCover.bind(this),!0)},resetFileInfo:function(){this.plugins.fileManager.resetInfo.call(this,"video",this.functions.onVideoUpload)},applySize:function(e,t){const i=this.context.video;return e||(e=i.inputX.value||this.options.videoWidth),t||(t=i.inputY.value||this.options.videoHeight),i._onlyPercentage||/%$/.test(e)||!e?(this.plugins.video.setPercentSize.call(this,e||"100%",t||(/%$/.test(i._videoRatio)?i._videoRatio:i._defaultRatio)),!0):(e&&"auto"!==e||t&&"auto"!==t?this.plugins.video.setSize.call(this,e,t||i._videoRatio||i._defaultRatio,!1):this.plugins.video.setAutoSize.call(this),!1)},sizeRevert:function(){this.plugins.resizing._module_sizeRevert.call(this,this.context.video)},setSize:function(e,t,i,n){const s=this.context.video,l=/^(rw|lw)$/.test(n),o=/^(th|bh)$/.test(n);o||(e=this.util.getNumber(e,0)),l||(t=this.util.isNumber(t)?t+s.sizeUnit:t||""),e=e?e+s.sizeUnit:"",o||(s._element.style.width=e),l||(s._cover.style.paddingBottom=s._cover.style.height=t),o||/%$/.test(e)||(s._cover.style.width=e,s._container.style.width=""),l||/%$/.test(t)?s._element.style.height="":s._element.style.height=t,i||s._element.removeAttribute("data-percentage"),this.plugins.resizing._module_saveCurrentSize.call(this,s)},setAutoSize:function(){this.plugins.video.setPercentSize.call(this,100,this.context.video._defaultRatio)},setOriginSize:function(e){const t=this.context.video;t._element.removeAttribute("data-percentage"),this.plugins.resizing.resetTransform.call(this,t._element),this.plugins.video.cancelPercentAttr.call(this);const i=((e?t._element.getAttribute("data-size"):"")||t._element.getAttribute("data-origin")||"").split(",");if(i){const e=i[0],n=i[1];t._onlyPercentage||/%$/.test(e)&&(/%$/.test(n)||!/\d/.test(n))?this.plugins.video.setPercentSize.call(this,e,n):this.plugins.video.setSize.call(this,e,n),this.plugins.resizing._module_saveCurrentSize.call(this,t)}},setPercentSize:function(e,t){const i=this.context.video;t=!t||/%$/.test(t)||this.util.getNumber(t,0)?this.util.isNumber(t)?t+i.sizeUnit:t||i._defaultRatio:this.util.isNumber(t)?t+"%":t,i._container.style.width=this.util.isNumber(e)?e+"%":e,i._container.style.height="",i._cover.style.width="100%",i._cover.style.height=t,i._cover.style.paddingBottom=t,i._element.style.width="100%",i._element.style.height="100%",i._element.style.maxWidth="","center"===i._align&&this.plugins.video.setAlign.call(this,null,null,null,null),i._element.setAttribute("data-percentage",e+","+t),this.plugins.resizing._module_saveCurrentSize.call(this,i)},cancelPercentAttr:function(){const e=this.context.video;e._cover.style.width="",e._cover.style.height="",e._cover.style.paddingBottom="",e._container.style.width="",e._container.style.height="",this.util.removeClass(e._container,this.context.video._floatClassRegExp),this.util.addClass(e._container,"__se__float-"+e._align),"center"===e._align&&this.plugins.video.setAlign.call(this,null,null,null,null)},setAlign:function(e,t,i,n){const s=this.context.video;e||(e=s._align),t||(t=s._element),i||(i=s._cover),n||(n=s._container),i.style.margin=e&&"none"!==e?"auto":"0",/%$/.test(t.style.width)&&"center"===e?(n.style.minWidth="100%",i.style.width=n.style.width,i.style.height=i.style.height,i.style.paddingBottom=/%$/.test(i.style.height)?this.util.getNumber(this.util.getNumber(i.style.height,2)/100*this.util.getNumber(i.style.width,2),2)+"%":i.style.height):(n.style.minWidth="",i.style.width=this.context.resizing._rotateVertical?t.style.height||t.offsetHeight:t.style.width||"100%",i.style.paddingBottom=i.style.height),this.util.hasClass(n,"__se__float-"+e)||(this.util.removeClass(n,s._floatClassRegExp),this.util.addClass(n,"__se__float-"+e)),t.setAttribute("data-align",e)},init:function(){const e=this.context.video;e.videoInputFile&&(e.videoInputFile.value=""),e.videoUrlFile&&(e._linkValue=e.preview.textContent=e.videoUrlFile.value=""),e.videoInputFile&&e.videoUrlFile&&(e.videoUrlFile.removeAttribute("disabled"),e.preview.style.textDecoration=""),e._origin_w=this.options.videoWidth,e._origin_h=this.options.videoHeight,e.modal.querySelector('input[name="suneditor_video_radio"][value="none"]').checked=!0,e._resizing&&(e.inputX.value=this.options.videoWidth===e._defaultSizeX?"":this.options.videoWidth,e.inputY.value=this.options.videoHeight===e._defaultSizeY?"":this.options.videoHeight,e.proportion.checked=!0,e.proportion.disabled=!0,this.plugins.video.setVideoRatioSelect.call(this,e._defaultRatio))}},y={name:"audio",display:"dialog",add:function(e){e.addModule([r(),p(),v()]);const t=e.context,i=t.audio={_infoList:[],_infoIndex:0,_uploadFileLength:0,focusElement:null,targetSelect:null,_origin_w:e.options.audioWidth,_origin_h:e.options.audioHeight,_linkValue:"",_element:null,_cover:null,_container:null};let n=this.setDialog(e);i.modal=n,i.audioInputFile=n.querySelector("._se_audio_files"),i.audioUrlFile=n.querySelector(".se-input-url"),i.focusElement=i.audioInputFile||i.audioUrlFile,i.preview=n.querySelector(".se-link-preview");let s=this.setController(e);i.controller=s,n.querySelector("form").addEventListener("submit",this.submit.bind(e)),i.audioInputFile&&n.querySelector(".se-dialog-files-edge-button").addEventListener("click",this._removeSelectedFiles.bind(i.audioInputFile,i.audioUrlFile,i.preview)),i.audioInputFile&&i.audioUrlFile&&i.audioInputFile.addEventListener("change",this._fileInputChange.bind(i)),s.addEventListener("click",this.onClick_controller.bind(e)),i.audioUrlFile&&i.audioUrlFile.addEventListener("input",this._onLinkPreview.bind(i.preview,i,e.options.linkProtocol)),t.dialog.modal.appendChild(n),t.element.relative.appendChild(s),n=null,s=null},setDialog:function(e){const t=e.options,i=e.lang,n=e.util.createElement("DIV");n.className="se-dialog-content",n.style.display="none";let s='<form method="post" enctype="multipart/form-data"><div class="se-dialog-header"><button type="button" data-command="close" class="se-btn se-dialog-close" aria-label="Close" title="'+i.dialogBox.close+'">'+e.icons.cancel+'</button><span class="se-modal-title">'+i.dialogBox.audioBox.title+'</span></div><div class="se-dialog-body">';return t.audioFileInput&&(s+='<div class="se-dialog-form"><label>'+i.dialogBox.audioBox.file+'</label><div class="se-dialog-form-files"><input class="se-input-form _se_audio_files" type="file" accept="'+t.audioAccept+'"'+(t.audioMultipleFile?' multiple="multiple"':"")+'/><button type="button" data-command="filesRemove" class="se-btn se-dialog-files-edge-button se-file-remove" title="'+i.controller.remove+'">'+e.icons.cancel+"</button></div></div>"),t.audioUrlInput&&(s+='<div class="se-dialog-form"><label>'+i.dialogBox.audioBox.url+'</label><input class="se-input-form se-input-url" type="text" /><pre class="se-link-preview"></pre></div>'),s+='</div><div class="se-dialog-footer"><button type="submit" class="se-btn-primary" title="'+i.dialogBox.submitButton+'"><span>'+i.dialogBox.submitButton+"</span></button></div></form>",n.innerHTML=s,n},setController:function(e){const t=e.lang,i=e.icons,n=e.util.createElement("DIV");return n.className="se-controller se-controller-link",n.innerHTML='<div class="se-arrow se-arrow-up"></div><div class="link-content"><div class="se-btn-group"><button type="button" data-command="update" tabindex="-1" class="se-tooltip">'+i.edit+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.edit+'</span></span></button><button type="button" data-command="delete" tabindex="-1" class="se-tooltip">'+i.delete+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.remove+"</span></span></button></div></div>",n},_fileInputChange:function(){this.audioInputFile.value?(this.audioUrlFile.setAttribute("disabled",!0),this.preview.style.textDecoration="line-through"):(this.audioUrlFile.removeAttribute("disabled"),this.preview.style.textDecoration="")},_removeSelectedFiles:function(e,t){this.value="",e&&(e.removeAttribute("disabled"),t.style.textDecoration="")},_createAudioTag:function(){const e=this.util.createElement("AUDIO");this.plugins.audio._setTagAttrs.call(this,e);const t=this.context.audio._origin_w,i=this.context.audio._origin_h;return e.setAttribute("origin-size",t+","+i),e.style.cssText=(t?"width:"+t+"; ":"")+(i?"height:"+i+";":""),e},_setTagAttrs:function(e){e.setAttribute("controls",!0);const t=this.options.audioTagAttrs;if(t)for(let i in t)this.util.hasOwn(t,i)&&e.setAttribute(i,t[i])},_onLinkPreview:function(e,t,i){const n=i.target.value.trim();e._linkValue=this.textContent=n?t&&-1===n.indexOf("://")&&0!==n.indexOf("#")?t+n:-1===n.indexOf("://")?"/"+n:n:""},fileTags:["audio"],select:function(e){this.plugins.audio.onModifyMode.call(this,e)},destroy:function(e){e=e||this.context.audio._element;const t=this.util.getParentElement(e,this.util.isComponent)||e,i=1*e.getAttribute("data-index"),n=t.previousElementSibling||t.nextElementSibling,s=t.parentNode;this.util.removeItem(t),this.plugins.audio.init.call(this),this.controllersOff(),s!==this.context.element.wysiwyg&&this.util.removeItemAllParents(s,(function(e){return 0===e.childNodes.length}),null),this.focusEdge(n),this.plugins.fileManager.deleteInfo.call(this,"audio",i,this.functions.onAudioUpload),this.history.push(!1)},checkFileInfo:function(){this.plugins.fileManager.checkInfo.call(this,"audio",["audio"],this.functions.onAudioUpload,this.plugins.audio.updateCover.bind(this),!1)},resetFileInfo:function(){this.plugins.fileManager.resetInfo.call(this,"audio",this.functions.onAudioUpload)},on:function(e){const t=this.context.audio;e?t._element?(this.context.dialog.updateModal=!0,t._linkValue=t.preview.textContent=t.audioUrlFile.value=t._element.src,t.audioInputFile&&this.options.audioMultipleFile&&t.audioInputFile.removeAttribute("multiple")):t.audioInputFile&&this.options.audioMultipleFile&&t.audioInputFile.removeAttribute("multiple"):(this.plugins.audio.init.call(this),t.audioInputFile&&this.options.audioMultipleFile&&t.audioInputFile.setAttribute("multiple","multiple"))},open:function(){this.plugins.dialog.open.call(this,"audio","audio"===this.currentControllerName)},submit:function(e){const t=this.context.audio;e.preventDefault(),e.stopPropagation();try{t.audioInputFile&&t.audioInputFile.files.length>0?(this.showLoading(),this.plugins.audio.submitAction.call(this,t.audioInputFile.files)):t.audioUrlFile&&t._linkValue.length>0&&(this.showLoading(),this.plugins.audio.setupUrl.call(this,t._linkValue))}catch(e){throw this.closeLoading(),Error('[SUNEDITOR.audio.submit.fail] cause : "'+e.message+'"')}finally{this.plugins.dialog.close.call(this)}return!1},submitAction:function(e){if(0===e.length)return;let t=0,i=[];for(let n=0,s=e.length;n<s;n++)/audio/i.test(e[n].type)&&(i.push(e[n]),t+=e[n].size);const n=this.options.audioUploadSizeLimit;if(n>0){let e=0;const i=this.context.audio._infoList;for(let t=0,n=i.length;t<n;t++)e+=1*i[t].size;if(t+e>n){this.closeLoading();const i="[SUNEDITOR.audioUpload.fail] Size of uploadable total audios: "+n/1e3+"KB";return void(("function"!=typeof this.functions.onAudioUploadError||this.functions.onAudioUploadError(i,{limitSize:n,currentSize:e,uploadSize:t},this))&&this.functions.noticeOpen(i))}}const s=this.context.audio;s._uploadFileLength=i.length;const l={isUpdate:this.context.dialog.updateModal,element:s._element};if("function"==typeof this.functions.onAudioUploadBefore){const e=this.functions.onAudioUploadBefore(i,l,this,function(e){e&&this._w.Array.isArray(e.result)?this.plugins.audio.register.call(this,l,e):this.plugins.audio.upload.call(this,l,e)}.bind(this));if(void 0===e)return;if(!e)return void this.closeLoading();"object"==typeof e&&e.length>0&&(i=e)}this.plugins.audio.upload.call(this,l,i)},error:function(e,t){if(this.closeLoading(),"function"!=typeof this.functions.onAudioUploadError||this.functions.onAudioUploadError(e,t,this))throw this.functions.noticeOpen(e),Error("[SUNEDITOR.plugin.audio.exception] response: "+e)},upload:function(e,t){if(!t)return void this.closeLoading();if("string"==typeof t)return void this.plugins.audio.error.call(this,t,null);const i=this.options.audioUploadUrl,n=this.context.dialog.updateModal?1:t.length,s=new FormData;for(let e=0;e<n;e++)s.append("file-"+e,t[e]);this.plugins.fileManager.upload.call(this,i,this.options.audioUploadHeader,s,this.plugins.audio.callBack_upload.bind(this,e),this.functions.onAudioUploadError)},callBack_upload:function(e,t){if("function"==typeof this.functions.audioUploadHandler)this.functions.audioUploadHandler(t,e,this);else{const i=JSON.parse(t.responseText);i.errorMessage?this.plugins.audio.error.call(this,i.errorMessage,i):this.plugins.audio.register.call(this,e,i)}},register:function(e,t){const i=t.result;for(let t,n,s=0,l=i.length;s<l;s++)n=e.isUpdate?e.element:this.plugins.audio._createAudioTag.call(this),t={name:i[s].name,size:i[s].size},this.plugins.audio.create_audio.call(this,n,i[s].url,t,e.isUpdate);this.closeLoading()},setupUrl:function(e){try{if(0===e.length)return!1;this.plugins.audio.create_audio.call(this,this.plugins.audio._createAudioTag.call(this),e,null,this.context.dialog.updateModal)}catch(e){throw Error('[SUNEDITOR.audio.audio.fail] cause : "'+e.message+'"')}finally{this.closeLoading()}},create_audio:function(e,t,i,n){const s=this.context.audio;if(n){if(s._element&&(e=s._element),!e||e.src===t)return void this.selectComponent(e,"audio");e.src=t,this.selectComponent(e,"audio")}else{e.src=t;const i=this.plugins.component.set_cover.call(this,e),n=this.plugins.component.set_container.call(this,i,"");if(!this.insertComponent(n,!1,!0,!this.options.mediaAutoSelect))return void this.focus();if(!this.options.mediaAutoSelect){const e=this.appendFormatTag(n,null);e&&this.setRange(e,0,e,0)}}this.plugins.fileManager.setInfo.call(this,"audio",e,this.functions.onAudioUpload,i,!1),n&&this.history.push(!1)},updateCover:function(e){const t=this.context.audio;this.plugins.audio._setTagAttrs.call(this,e);const i=this.util.isRangeFormatElement(e.parentNode)||this.util.isWysiwygDiv(e.parentNode)?e:this.util.getFormatElement(e)||e,n=e;t._element=e=e.cloneNode(!1);const s=this.plugins.component.set_cover.call(this,e),l=this.plugins.component.set_container.call(this,s,"se-audio-container");try{this.util.isListCell(i)||this.util.isFormatElement(i)?n.parentNode.replaceChild(l,n):this.util.isFormatElement(i)&&i.childNodes.length>0?(i.parentNode.insertBefore(l,i),this.util.removeItem(n),this.util.removeEmptyNode(i,null),0===i.children.length&&(i.innerHTML=this.util.htmlRemoveWhiteSpace(i.innerHTML))):i.parentNode.replaceChild(l,i)}catch(e){console.warn("[SUNEDITOR.audio.error] Maybe the audio tag is nested.",e)}this.plugins.fileManager.setInfo.call(this,"audio",e,this.functions.onAudioUpload,null,!1),this.plugins.audio.init.call(this)},onModifyMode:function(e){const t=this.context.audio;this.setControllerPosition(t.controller,e,"bottom",{left:0,top:0}),this.controllersOn(t.controller,e,this.plugins.audio.onControllerOff.bind(this,e),"audio"),this.util.addClass(e,"active"),t._element=e,t._cover=this.util.getParentElement(e,"FIGURE"),t._container=this.util.getParentElement(e,this.util.isComponent)},openModify:function(e){if(this.context.audio.audioUrlFile){const e=this.context.audio;e._linkValue=e.preview.textContent=e.audioUrlFile.value=e._element.src}e||this.plugins.dialog.open.call(this,"audio",!0)},onClick_controller:function(e){e.stopPropagation();const t=e.target.getAttribute("data-command");t&&(e.preventDefault(),/update/.test(t)?this.plugins.audio.openModify.call(this,!1):this.plugins.audio.destroy.call(this,this.context.audio._element),this.controllersOff())},onControllerOff:function(e){this.util.removeClass(e,"active"),this.context.audio.controller.style.display="none"},init:function(){if(this.context.dialog.updateModal)return;const e=this.context.audio;e.audioInputFile&&(e.audioInputFile.value=""),e.audioUrlFile&&(e._linkValue=e.preview.textContent=e.audioUrlFile.value=""),e.audioInputFile&&e.audioUrlFile&&(e.audioUrlFile.removeAttribute("disabled"),e.preview.style.textDecoration=""),e._element=null}},x={name:"math",display:"dialog",add:function(e){e.addModule([r()]);const t=e.context;t.math={focusElement:null,previewElement:null,fontSizeElement:null,defaultFontSize:"",_mathExp:null};let i=this.setDialog(e);t.math.modal=i,t.math.focusElement=i.querySelector(".se-math-exp"),t.math.previewElement=i.querySelector(".se-math-preview"),t.math.fontSizeElement=i.querySelector(".se-math-size"),t.math.focusElement.addEventListener(e.util.isIE?"textinput":"input",this._renderMathExp.bind(e,t.math),!1),t.math.fontSizeElement.addEventListener("change",function(e){this.fontSize=e.target.value}.bind(t.math.previewElement.style),!1);let n=this.setController_MathButton(e);t.math.mathController=n,t.math._mathExp=null,i.querySelector("form").addEventListener("submit",this.submit.bind(e),!1),n.addEventListener("click",this.onClick_mathController.bind(e)),t.math.previewElement.style.fontSize=t.math.defaultFontSize,t.dialog.modal.appendChild(i),t.element.relative.appendChild(n),i=null,n=null},setDialog:function(e){const t=e.lang,i=e.util.createElement("DIV"),n=e.options.mathFontSize;let s=n[0].value;i.className="se-dialog-content",i.style.display="none";let l='<form><div class="se-dialog-header"><button type="button" data-command="close" class="se-btn se-dialog-close" aria-label="Close" title="'+t.dialogBox.close+'">'+e.icons.cancel+'</button><span class="se-modal-title">'+t.dialogBox.mathBox.title+'</span></div><div class="se-dialog-body"><div class="se-dialog-form"><label>'+t.dialogBox.mathBox.inputLabel+' (<a href="https://katex.org/docs/supported.html" target="_blank">KaTeX</a>)</label><textarea class="se-input-form se-math-exp" type="text"></textarea></div><div class="se-dialog-form"><label>'+t.dialogBox.mathBox.fontSizeLabel+'</label><select class="se-input-select se-math-size">';for(let e,t=0,i=n.length;t<i;t++)e=n[t],e.default&&(s=e.value),l+='<option value="'+e.value+'"'+(e.default?" selected":"")+">"+e.text+"</option>";return l+='</select></div><div class="se-dialog-form"><label>'+t.dialogBox.mathBox.previewLabel+'</label><p class="se-math-preview"></p></div></div><div class="se-dialog-footer"><button type="submit" class="se-btn-primary" title="'+t.dialogBox.submitButton+'"><span>'+t.dialogBox.submitButton+"</span></button></div></form>",e.context.math.defaultFontSize=s,i.innerHTML=l,i},setController_MathButton:function(e){const t=e.lang,i=e.util.createElement("DIV");return i.className="se-controller se-controller-link",i.innerHTML='<div class="se-arrow se-arrow-up"></div><div class="link-content"><div class="se-btn-group"><button type="button" data-command="update" tabindex="-1" class="se-btn se-tooltip">'+e.icons.edit+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.edit+'</span></span></button><button type="button" data-command="delete" tabindex="-1" class="se-btn se-tooltip">'+e.icons.delete+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.remove+"</span></span></button></div></div>",i},open:function(){this.plugins.dialog.open.call(this,"math","math"===this.currentControllerName)},managedTags:function(){return{className:"katex",method:function(e){if(!e.getAttribute("data-exp")||!this.options.katex)return;const t=this._d.createRange().createContextualFragment(this.plugins.math._renderer.call(this,this.util.HTMLDecoder(e.getAttribute("data-exp"))));e.innerHTML=t.querySelector(".katex").innerHTML}}},_renderer:function(e){return this.options.katex.src.renderToString(e,{throwOnError:!0,displayMode:!0})},_renderMathExp:function(e,t){e.previewElement.innerHTML=this.plugins.math._renderer.call(this,t.target.value)},submit:function(e){this.showLoading(),e.preventDefault(),e.stopPropagation();const t=function(){if(0===this.context.math.focusElement.value.trim().length)return!1;const e=this.context.math,t=e.focusElement.value,i=e.previewElement.querySelector(".katex");if(!i)return!1;if(i.className="__se__katex "+i.className,i.setAttribute("contenteditable",!1),i.setAttribute("data-exp",this.util.HTMLEncoder(t)),i.setAttribute("data-font-size",e.fontSizeElement.value),i.style.fontSize=e.fontSizeElement.value,this.context.dialog.updateModal){const t=this.util.getParentElement(e._mathExp,".katex");t.parentNode.replaceChild(i,t),this.setRange(i,0,i,1)}else{const e=this.getSelectedElements();if(e.length>1){const t=this.util.createElement(e[0].nodeName);if(t.appendChild(i),!this.insertNode(t,null,!0))return!1}else if(!this.insertNode(i,null,!0))return!1;const t=this.util.createTextNode(this.util.zeroWidthSpace);i.parentNode.insertBefore(t,i.nextSibling),this.setRange(i,0,i,1)}return e.focusElement.value="",e.fontSizeElement.value="1em",e.previewElement.style.fontSize="1em",e.previewElement.innerHTML="",!0}.bind(this);try{t()&&(this.plugins.dialog.close.call(this),this.history.push(!1))}catch(e){this.plugins.dialog.close.call(this)}finally{this.closeLoading()}return!1},active:function(e){if(e){if(e.getAttribute("data-exp"))return this.controllerArray.indexOf(this.context.math.mathController)<0&&(this.setRange(e,0,e,1),this.plugins.math.call_controller.call(this,e)),!0}else this.controllerArray.indexOf(this.context.math.mathController)>-1&&this.controllersOff();return!1},on:function(e){if(e){const e=this.context.math;if(e._mathExp){const t=this.util.HTMLDecoder(e._mathExp.getAttribute("data-exp")),i=e._mathExp.getAttribute("data-font-size")||"1em";this.context.dialog.updateModal=!0,e.focusElement.value=t,e.fontSizeElement.value=i,e.previewElement.innerHTML=this.plugins.math._renderer.call(this,t),e.previewElement.style.fontSize=i}}else this.plugins.math.init.call(this)},call_controller:function(e){this.context.math._mathExp=e;const t=this.context.math.mathController;this.setControllerPosition(t,e,"bottom",{left:0,top:0}),this.controllersOn(t,e,"math")},onClick_mathController:function(e){e.stopPropagation();const t=e.target.getAttribute("data-command")||e.target.parentNode.getAttribute("data-command");t&&(e.preventDefault(),/update/.test(t)?(this.context.math.focusElement.value=this.util.HTMLDecoder(this.context.math._mathExp.getAttribute("data-exp")),this.plugins.dialog.open.call(this,"math",!0)):(this.util.removeItem(this.context.math._mathExp),this.context.math._mathExp=null,this.focus(),this.history.push(!1)),this.controllersOff())},init:function(){const e=this.context.math;e.mathController.style.display="none",e._mathExp=null,e.focusElement.value="",e.previewElement.innerHTML=""}};var w=i(1665),k=i.n(w);const C={blockquote:{name:"blockquote",display:"command",add:function(e,t){e.context.blockquote={targetButton:t,tag:e.util.createElement("BLOCKQUOTE")}},active:function(e){if(e){if(/blockquote/i.test(e.nodeName))return this.util.addClass(this.context.blockquote.targetButton,"active"),!0}else this.util.removeClass(this.context.blockquote.targetButton,"active");return!1},action:function(){const e=this.util.getParentElement(this.getSelectionNode(),"blockquote");e?this.detachRangeFormatElement(e,null,null,!1,!1):this.applyRangeFormatElement(this.context.blockquote.tag.cloneNode(!1))}},align:{name:"align",display:"submenu",add:function(e,t){const i=e.icons,n=e.context;n.align={targetButton:t,_itemMenu:null,_alignList:null,currentAlign:"",defaultDir:e.options.rtl?"right":"left",icons:{justify:i.align_justify,left:i.align_left,right:i.align_right,center:i.align_center}};let s=this.setSubmenu(e),l=n.align._itemMenu=s.querySelector("ul");l.addEventListener("click",this.pickup.bind(e)),n.align._alignList=l.querySelectorAll("li button"),e.initMenuTarget(this.name,t,s),s=null,l=null},setSubmenu:function(e){const t=e.lang,i=e.icons,n=e.util.createElement("DIV"),s=e.options.alignItems;let l="";for(let e,n,o=0;o<s.length;o++)e=s[o],n=t.toolbar["align"+e.charAt(0).toUpperCase()+e.slice(1)],l+='<li><button type="button" class="se-btn-list se-btn-align" data-value="'+e+'" title="'+n+'"><span class="se-list-icon">'+i["align_"+e]+"</span>"+n+"</button></li>";return n.className="se-submenu se-list-layer se-list-align",n.innerHTML='<div class="se-list-inner"><ul class="se-list-basic">'+l+"</ul></div>",n},active:function(e){const t=this.context.align,i=t.targetButton,n=i.firstElementChild;if(e){if(this.util.isFormatElement(e)){const s=e.style.textAlign;if(s)return this.util.changeElement(n,t.icons[s]||t.icons[t.defaultDir]),i.setAttribute("data-focus",s),!0}}else this.util.changeElement(n,t.icons[t.defaultDir]),i.removeAttribute("data-focus");return!1},on:function(){const e=this.context.align,t=e._alignList,i=e.targetButton.getAttribute("data-focus")||e.defaultDir;if(i!==e.currentAlign){for(let e=0,n=t.length;e<n;e++)i===t[e].getAttribute("data-value")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentAlign=i}},exchangeDir:function(){const e=this.options.rtl?"right":"left";if(!this.context.align||this.context.align.defaultDir===e)return;this.context.align.defaultDir=e;let t=this.context.align._itemMenu,i=t.querySelector('[data-value="left"]'),n=t.querySelector('[data-value="right"]');if(i&&n){const e=i.parentElement,t=n.parentElement;e.appendChild(n),t.appendChild(i)}},pickup:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,i=null;for(;!i&&!/UL/i.test(t.tagName);)i=t.getAttribute("data-value"),t=t.parentNode;if(!i)return;const n=this.context.align.defaultDir,s=this.getSelectedElements();for(let e=0,t=s.length;e<t;e++)this.util.setStyle(s[e],"textAlign",i===n?"":i);this.effectNode=null,this.submenuOff(),this.focus(),this.history.push(!1)}},font:{name:"font",display:"submenu",add:function(e,t){const i=e.context;i.font={targetText:t.querySelector(".txt"),targetTooltip:t.parentNode.querySelector(".se-tooltip-text"),_fontList:null,currentFont:""};let n=this.setSubmenu(e);n.querySelector(".se-list-inner").addEventListener("click",this.pickup.bind(e)),i.font._fontList=n.querySelectorAll("ul li button"),e.initMenuTarget(this.name,t,n),n=null},setSubmenu:function(e){const t=e.options,i=e.lang,n=e.util.createElement("DIV");let s,l,o,a;n.className="se-submenu se-list-layer se-list-font-family";let r=t.font?t.font:["Arial","Comic Sans MS","Courier New","Impact","Georgia","tahoma","Trebuchet MS","Verdana"],u='<div class="se-list-inner"><ul class="se-list-basic"><li><button type="button" class="default_value se-btn-list" title="'+i.toolbar.default+'">('+i.toolbar.default+")</button></li>";for(o=0,a=r.length;o<a;o++)s=r[o],l=s.split(",")[0],u+='<li><button type="button" class="se-btn-list" data-value="'+s+'" data-txt="'+l+'" title="'+l+'" style="font-family:'+s+';">'+l+"</button></li>";return u+="</ul></div>",n.innerHTML=u,n},active:function(e){const t=this.context.font.targetText,i=this.context.font.targetTooltip;if(e){if(e.style&&e.style.fontFamily.length>0){const n=e.style.fontFamily.replace(/["']/g,"");return this.util.changeTxt(t,n),this.util.changeTxt(i,this.lang.toolbar.font+" ("+n+")"),!0}}else{const e=this.hasFocus?this.wwComputedStyle.fontFamily:this.lang.toolbar.font;this.util.changeTxt(t,e),this.util.changeTxt(i,this.hasFocus?this.lang.toolbar.font+(e?" ("+e+")":""):e)}return!1},on:function(){const e=this.context.font,t=e._fontList,i=e.targetText.textContent;if(i!==e.currentFont){for(let e=0,n=t.length;e<n;e++)i===t[e].getAttribute("data-value")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentFont=i}},pickup:function(e){if(!/^BUTTON$/i.test(e.target.tagName))return!1;e.preventDefault(),e.stopPropagation();const t=e.target.getAttribute("data-value");if(t){const e=this.util.createElement("SPAN");e.style.fontFamily=t,this.nodeChange(e,["font-family"],null,null)}else this.nodeChange(null,["font-family"],["span"],!0);this.submenuOff()}},fontSize:{name:"fontSize",display:"submenu",add:function(e,t){const i=e.context;i.fontSize={targetText:t.querySelector(".txt"),_sizeList:null,currentSize:""};let n=this.setSubmenu(e),s=n.querySelector("ul");s.addEventListener("click",this.pickup.bind(e)),i.fontSize._sizeList=s.querySelectorAll("li button"),e.initMenuTarget(this.name,t,n),n=null,s=null},setSubmenu:function(e){const t=e.options,i=e.lang,n=e.util.createElement("DIV");n.className="se-submenu se-list-layer se-list-font-size";const s=t.fontSize?t.fontSize:[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];let l='<div class="se-list-inner"><ul class="se-list-basic"><li><button type="button" class="default_value se-btn-list" title="'+i.toolbar.default+'">('+i.toolbar.default+")</button></li>";for(let e,i=0,n=t.fontSizeUnit,o=s.length;i<o;i++)e=s[i],l+='<li><button type="button" class="se-btn-list" data-value="'+e+n+'" title="'+e+n+'" style="font-size:'+e+n+';">'+e+"</button></li>";return l+="</ul></div>",n.innerHTML=l,n},active:function(e){if(e){if(e.style&&e.style.fontSize.length>0)return this.util.changeTxt(this.context.fontSize.targetText,e.style.fontSize),!0}else this.util.changeTxt(this.context.fontSize.targetText,this.hasFocus?this.options.__defaultFontSize||this.wwComputedStyle.fontSize:this.lang.toolbar.fontSize);return!1},on:function(){const e=this.context.fontSize,t=e._sizeList,i=e.targetText.textContent;if(i!==e.currentSize){for(let e=0,n=t.length;e<n;e++)i===t[e].getAttribute("data-value")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentSize=i}},pickup:function(e){if(!/^BUTTON$/i.test(e.target.tagName))return!1;e.preventDefault(),e.stopPropagation();const t=e.target.getAttribute("data-value");if(t){const e=this.util.createElement("SPAN");e.style.fontSize=t,this.nodeChange(e,["font-size"],null,null)}else this.nodeChange(null,["font-size"],["span"],!0);this.submenuOff()}},fontColor:s,hiliteColor:l,horizontalRule:{name:"horizontalRule",display:"submenu",add:function(e,t){e.context.horizontalRule={currentHR:null};let i=this.setSubmenu(e);i.querySelector("ul").addEventListener("click",this.horizontalRulePick.bind(e)),e.initMenuTarget(this.name,t,i),i=null},setSubmenu:function(e){const t=e.lang,i=e.util.createElement("DIV"),n=e.options.hrItems||[{name:t.toolbar.hr_solid,class:"__se__solid"},{name:t.toolbar.hr_dashed,class:"__se__dashed"},{name:t.toolbar.hr_dotted,class:"__se__dotted"}];let s="";for(let e=0,t=n.length;e<t;e++)s+='<li><button type="button" class="se-btn-list btn_line" data-command="horizontalRule" data-value="'+n[e].class+'" title="'+n[e].name+'"><hr'+(n[e].class?' class="'+n[e].class+'"':"")+(n[e].style?' style="'+n[e].style+'"':"")+"/></button></li>";return i.className="se-submenu se-list-layer se-list-line",i.innerHTML='<div class="se-list-inner"><ul class="se-list-basic">'+s+"</ul></div>",i},active:function(e){if(e){if(/HR/i.test(e.nodeName))return this.context.horizontalRule.currentHR=e,this.util.hasClass(e,"on")||(this.util.addClass(e,"on"),this.controllersOn("hr",this.util.removeClass.bind(this.util,e,"on"))),!0}else this.util.hasClass(this.context.horizontalRule.currentHR,"on")&&this.controllersOff();return!1},appendHr:function(e){return this.focus(),this.insertComponent(e.cloneNode(!1),!1,!0,!1)},horizontalRulePick:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,i=t.getAttribute("data-command");for(;!i&&!/UL/i.test(t.tagName);)t=t.parentNode,i=t.getAttribute("data-command");if(!i)return;const n=this.plugins.horizontalRule.appendHr.call(this,t.firstElementChild);n&&(this.setRange(n,0,n,0),this.submenuOff())}},list:{name:"list",display:"submenu",add:function(e,t){const i=e.context;i.list={targetButton:t,_list:null,currentList:"",icons:{bullets:e.icons.list_bullets,number:e.icons.list_number}};let n=this.setSubmenu(e),s=n.querySelector("ul");s.addEventListener("click",this.pickup.bind(e)),i.list._list=s.querySelectorAll("li button"),e.initMenuTarget(this.name,t,n),n=null,s=null},setSubmenu:function(e){const t=e.lang,i=e.util.createElement("DIV");return i.className="se-submenu se-list-layer",i.innerHTML='<div class="se-list-inner"><ul class="se-list-basic"><li><button type="button" class="se-btn-list se-tooltip" data-command="OL" title="'+t.toolbar.orderList+'">'+e.icons.list_number+'</button></li><li><button type="button" class="se-btn-list se-tooltip" data-command="UL" title="'+t.toolbar.unorderList+'">'+e.icons.list_bullets+"</button></li></ul></div>",i},active:function(e){const t=this.context.list.targetButton,i=t.firstElementChild,n=this.util;if(n.isList(e)){const s=e.nodeName;return t.setAttribute("data-focus",s),n.addClass(t,"active"),/UL/i.test(s)?n.changeElement(i,this.context.list.icons.bullets):n.changeElement(i,this.context.list.icons.number),!0}return t.removeAttribute("data-focus"),n.changeElement(i,this.context.list.icons.number),n.removeClass(t,"active"),!1},on:function(){const e=this.context.list,t=e._list,i=e.targetButton.getAttribute("data-focus")||"";if(i!==e.currentList){for(let e=0,n=t.length;e<n;e++)i===t[e].getAttribute("data-command")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentList=i}},editList:function(e,t,i){let n=this.getRange(),s=t||this.getSelectedElementsAndComponents(!1);if(0===s.length){if(t)return;if(n=this.getRange_addLine(n,null),s=this.getSelectedElementsAndComponents(!1),0===s.length)return}const l=this.util;l.sortByDepth(s,!0);let o=s[0],a=s[s.length-1],r=!l.isListCell(o)&&!l.isComponent(o)||o.previousElementSibling?o.previousElementSibling:o.parentNode.previousElementSibling,u=!l.isListCell(a)&&!l.isComponent(a)||a.nextElementSibling?a.nextElementSibling:a.parentNode.nextElementSibling;const c={sc:n.startContainer,so:n.startContainer===n.endContainer&&l.onlyZeroWidthSpace(n.startContainer)&&0===n.startOffset&&1===n.endOffset?n.endOffset:n.startOffset,ec:n.endContainer,eo:n.endOffset};let d=!0;for(let e=0,t=s.length;e<t;e++)if(!l.isList(l.getRangeFormatElement(s[e],function(t){return this.getRangeFormatElement(t)&&t!==s[e]}.bind(l)))){d=!1;break}if(!d||r&&o.tagName===r.tagName&&e===r.tagName.toUpperCase()||u&&a.tagName===u.tagName&&e===u.tagName.toUpperCase()){const t=r?r.parentNode:r,i=u?u.parentNode:u;r=t&&!l.isWysiwygDiv(t)&&t.nodeName===e?t:r,u=i&&!l.isWysiwygDiv(i)&&i.nodeName===e?i:u;const n=r&&r.tagName===e,o=u&&u.tagName===e;let a=n?r:l.createElement(e),d=null,h=null,p=null,f=null;const g=function(e){return!this.isComponent(e)&&!this.isList(e)}.bind(l);for(let t,i,o,r,u,f,m,v,b,_=0,y=s.length;_<y;_++)if(i=s[_],0!==i.childNodes.length||l._isIgnoreNodeChange(i)){if(r=s[_+1],u=i.parentNode,f=r?r.parentNode:null,o=l.isListCell(i),b=l.isRangeFormatElement(u)?u:null,m=o&&!l.isWysiwygDiv(u)?u.parentNode:u,v=o&&!l.isWysiwygDiv(u)?!r||l.isListCell(m)?u:u.nextSibling:i.nextSibling,t=l.createElement("LI"),l.copyFormatAttributes(t,i),0===_&&c.sc===i&&(c.sc=t),_===y-1&&c.ec===i&&(c.ec=t),l.isComponent(i)){const e=/^HR$/i.test(i.nodeName);e||(t.innerHTML="<br>"),t.innerHTML+=i.outerHTML,e&&(t.innerHTML+="<br>")}else{const e=i.childNodes;for(;e[0];)t.appendChild(e[0])}a.appendChild(t),r||(h=a),r&&m===f&&!l.isRangeFormatElement(v)||(d||(d=a),n&&r&&m===f||r&&l.isList(f)&&f===u||a.parentNode!==m&&m.insertBefore(a,v)),l.removeItem(i),n&&null===p&&(p=a.children.length-1),r&&(l.getRangeFormatElement(f,g)!==l.getRangeFormatElement(u,g)||l.isList(f)&&l.isList(u)&&l.getElementDepth(f)!==l.getElementDepth(u))&&(a=l.createElement(e)),b&&0===b.children.length&&l.removeItem(b)}else l.removeItem(i);p&&(d=d.children[p]),o&&(f=a.children.length-1,a.innerHTML+=u.innerHTML,h=a.children[f],l.removeItem(u))}else{if(i)for(let e=0,t=s.length;e<t;e++)for(let i=e-1;i>=0;i--)if(s[i].contains(s[e])){s.splice(e,1),e--,t--;break}const t=l.getRangeFormatElement(o),n=t&&t.tagName===e;let a,r;const u=function(e){return!this.isComponent(e)}.bind(l);n||(r=l.createElement(e));for(let t,o,c=0,d=s.length;c<d;c++)o=l.getRangeFormatElement(s[c],u),o&&l.isList(o)&&(t?t!==o?(i&&l.isListCell(o.parentNode)?this.plugins.list._detachNested.call(this,a.f):this.detachRangeFormatElement(a.f[0].parentNode,a.f,r,!1,!0),o=s[c].parentNode,n||(r=l.createElement(e)),t=o,a={r:t,f:[l.getParentElement(s[c],"LI")]}):a.f.push(l.getParentElement(s[c],"LI")):(t=o,a={r:t,f:[l.getParentElement(s[c],"LI")]}),c===d-1&&(i&&l.isListCell(o.parentNode)?this.plugins.list._detachNested.call(this,a.f):this.detachRangeFormatElement(a.f[0].parentNode,a.f,r,!1,!0)))}return this.effectNode=null,c},_detachNested:function(e){const t=e[0],i=e[e.length-1],n=i.nextElementSibling,s=t.parentNode,l=s.parentNode.nextElementSibling,o=s.parentNode.parentNode;for(let t=0,i=e.length;t<i;t++)o.insertBefore(e[t],l);if(n&&s.children.length>0){const e=s.cloneNode(!1),t=s.childNodes,l=this.util.getPositionIndex(n);for(;t[l];)e.appendChild(t[l]);i.appendChild(e)}0===s.children.length&&this.util.removeItem(s),this.util.mergeSameTags(o);const a=this.util.getEdgeChildNodes(t,i);return{cc:t.parentNode,sc:a.sc,ec:a.ec}},editInsideList:function(e,t){const i=(t=t||this.getSelectedElements().filter(function(e){return this.isListCell(e)}.bind(this.util))).length;if(0===i||!e&&!this.util.isListCell(t[0].previousElementSibling)&&!this.util.isListCell(t[i-1].nextElementSibling))return{sc:t[0],so:0,ec:t[i-1],eo:1};let n=t[0].parentNode,s=t[i-1],l=null;if(e){if(n!==s.parentNode&&this.util.isList(s.parentNode.parentNode)&&s.nextElementSibling)for(s=s.nextElementSibling;s;)t.push(s),s=s.nextElementSibling;l=this.plugins.list.editList.call(this,n.nodeName.toUpperCase(),t,!0)}else{let e=this.util.createElement(n.nodeName),o=t[0].previousElementSibling,a=s.nextElementSibling;const r={s:null,e:null,sl:n,el:n};for(let s,l=0,u=i;l<u;l++)s=t[l],s.parentNode!==n&&(this.plugins.list._insiedList.call(this,n,e,o,a,r),n=s.parentNode,e=this.util.createElement(n.nodeName)),o=s.previousElementSibling,a=s.nextElementSibling,e.appendChild(s);this.plugins.list._insiedList.call(this,n,e,o,a,r);const u=this.util.getNodeFromPath(r.s,r.sl),c=this.util.getNodeFromPath(r.e,r.el);l={sc:u,so:0,ec:c,eo:c.textContent.length}}return l},_insiedList:function(e,t,i,n,s){let l=!1;if(i&&t.tagName===i.tagName){const e=t.children;for(;e[0];)i.appendChild(e[0]);t=i,l=!0}if(n&&t.tagName===n.tagName){const e=n.children;for(;e[0];)t.appendChild(e[0]);const i=n.nextElementSibling;n.parentNode.removeChild(n),n=i}if(!l){this.util.isListCell(i)&&(e=i,n=null),e.insertBefore(t,n),s.s||(s.s=this.util.getNodePath(t.firstElementChild.firstChild,e,null),s.sl=e);const l=e.contains(s.sl)?this.util.getNodePath(s.sl,e):null;s.e=this.util.getNodePath(t.lastElementChild.firstChild,e,null),s.el=e,this.util.mergeSameTags(e,[s.s,s.e,l],!1),this.util.mergeNestedTags(e),l&&(s.sl=this.util.getNodeFromPath(l,e))}return t},pickup:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,i="";for(;!i&&!/^UL$/i.test(t.tagName);)i=t.getAttribute("data-command"),t=t.parentNode;if(!i)return;const n=this.plugins.list.editList.call(this,i,null,!1);n&&this.setRange(n.sc,n.so,n.ec,n.eo),this.submenuOff(),this.history.push(!1)}},table:{name:"table",display:"submenu",add:function(e,t){const i=e.context;let n=i.table={_element:null,_tdElement:null,_trElement:null,_trElements:null,_tableXY:[],_maxWidth:!0,_fixedColumn:!1,_rtl:e.options.rtl,cellControllerTop:"top"===e.options.tableCellControllerPosition,resizeText:null,headerButton:null,mergeButton:null,splitButton:null,splitMenu:null,maxText:e.lang.controller.maxSize,minText:e.lang.controller.minSize,_physical_cellCnt:0,_logical_cellCnt:0,_rowCnt:0,_rowIndex:0,_physical_cellIndex:0,_logical_cellIndex:0,_current_colSpan:0,_current_rowSpan:0,icons:{expansion:e.icons.expansion,reduction:e.icons.reduction}},s=this.setSubmenu(e),l=s.querySelector(".se-controller-table-picker");n.tableHighlight=s.querySelector(".se-table-size-highlighted"),n.tableUnHighlight=s.querySelector(".se-table-size-unhighlighted"),n.tableDisplay=s.querySelector(".se-table-size-display"),e.options.rtl&&(n.tableHighlight.style.left="167px");let o=this.setController_table(e);n.tableController=o,n.resizeButton=o.querySelector("._se_table_resize"),n.resizeText=o.querySelector("._se_table_resize > span > span"),n.columnFixedButton=o.querySelector("._se_table_fixed_column"),n.headerButton=o.querySelector("._se_table_header");let a=this.setController_tableEditor(e,n.cellControllerTop);n.resizeDiv=a,n.splitMenu=a.querySelector(".se-btn-group-sub"),n.mergeButton=a.querySelector("._se_table_merge_button"),n.splitButton=a.querySelector("._se_table_split_button"),n.insertRowAboveButton=a.querySelector("._se_table_insert_row_a"),n.insertRowBelowButton=a.querySelector("._se_table_insert_row_b"),l.addEventListener("mousemove",this.onMouseMove_tablePicker.bind(e,n)),l.addEventListener("click",this.appendTable.bind(e)),a.addEventListener("click",this.onClick_tableController.bind(e)),o.addEventListener("click",this.onClick_tableController.bind(e)),e.initMenuTarget(this.name,t,s),i.element.relative.appendChild(a),i.element.relative.appendChild(o),s=null,l=null,a=null,o=null,n=null},setSubmenu:function(e){const t=e.util.createElement("DIV");return t.className="se-submenu se-selector-table",t.innerHTML='<div class="se-table-size"><div class="se-table-size-picker se-controller-table-picker"></div><div class="se-table-size-highlighted"></div><div class="se-table-size-unhighlighted"></div></div><div class="se-table-size-display">1 x 1</div>',t},setController_table:function(e){const t=e.lang,i=e.icons,n=e.util.createElement("DIV");return n.className="se-controller se-controller-table",n.innerHTML='<div><div class="se-btn-group"><button type="button" data-command="resize" class="se-btn se-tooltip _se_table_resize">'+i.expansion+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.maxSize+'</span></span></button><button type="button" data-command="layout" class="se-btn se-tooltip _se_table_fixed_column">'+i.fixed_column_width+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.fixedColumnWidth+'</span></span></button><button type="button" data-command="header" class="se-btn se-tooltip _se_table_header">'+i.table_header+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.tableHeader+'</span></span></button><button type="button" data-command="remove" class="se-btn se-tooltip">'+i.delete+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.remove+"</span></span></button></div></div>",n},setController_tableEditor:function(e,t){const i=e.lang,n=e.icons,s=e.util.createElement("DIV");return s.className="se-controller se-controller-table-cell",s.innerHTML=(t?"":'<div class="se-arrow se-arrow-up"></div>')+'<div class="se-btn-group"><button type="button" data-command="insert" data-value="row" data-option="up" class="se-btn se-tooltip _se_table_insert_row_a">'+n.insert_row_above+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+i.controller.insertRowAbove+'</span></span></button><button type="button" data-command="insert" data-value="row" data-option="down" class="se-btn se-tooltip _se_table_insert_row_b">'+n.insert_row_below+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+i.controller.insertRowBelow+'</span></span></button><button type="button" data-command="delete" data-value="row" class="se-btn se-tooltip">'+n.delete_row+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+i.controller.deleteRow+'</span></span></button><button type="button" data-command="merge" class="_se_table_merge_button se-btn se-tooltip" disabled>'+n.merge_cell+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+i.controller.mergeCells+'</span></span></button></div><div class="se-btn-group" style="padding-top: 0;"><button type="button" data-command="insert" data-value="cell" data-option="left" class="se-btn se-tooltip">'+n.insert_column_left+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+i.controller.insertColumnBefore+'</span></span></button><button type="button" data-command="insert" data-value="cell" data-option="right" class="se-btn se-tooltip">'+n.insert_column_right+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+i.controller.insertColumnAfter+'</span></span></button><button type="button" data-command="delete" data-value="cell" class="se-btn se-tooltip">'+n.delete_column+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+i.controller.deleteColumn+'</span></span></button><button type="button" data-command="onsplit" class="_se_table_split_button se-btn se-tooltip">'+n.split_cell+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+i.controller.splitCells+'</span></span></button><div class="se-btn-group-sub sun-editor-common se-list-layer se-table-split"><div class="se-list-inner"><ul class="se-list-basic"><li class="se-btn-list" data-command="split" data-value="vertical" style="line-height:32px;" title="'+i.controller.VerticalSplit+'">'+i.controller.VerticalSplit+'</li><li class="se-btn-list" data-command="split" data-value="horizontal" style="line-height:32px;" title="'+i.controller.HorizontalSplit+'">'+i.controller.HorizontalSplit+"</li></ul></div></div></div>",s},appendTable:function(){const e=this.util.createElement("TABLE"),t=this.plugins.table.createCells,i=this.context.table._tableXY[0];let n=this.context.table._tableXY[1],s="<tbody>";for(;n>0;)s+="<tr>"+t.call(this,"td",i)+"</tr>",--n;s+="</tbody>",e.innerHTML=s;if(this.insertComponent(e,!1,!0,!1)){const t=e.querySelector("td div");this.setRange(t,0,t,0),this.plugins.table.reset_table_picker.call(this)}},createCells:function(e,t,i){if(e=e.toLowerCase(),i){const t=this.util.createElement(e);return t.innerHTML="<div><br></div>",t}{let i="";for(;t>0;)i+="<"+e+"><div><br></div></"+e+">",t--;return i}},onMouseMove_tablePicker:function(e,t){t.stopPropagation();let i=this._w.Math.ceil(t.offsetX/18),n=this._w.Math.ceil(t.offsetY/18);i=i<1?1:i,n=n<1?1:n,e._rtl&&(e.tableHighlight.style.left=18*i-13+"px",i=11-i),e.tableHighlight.style.width=i+"em",e.tableHighlight.style.height=n+"em",this.util.changeTxt(e.tableDisplay,i+" x "+n),e._tableXY=[i,n]},reset_table_picker:function(){if(!this.context.table.tableHighlight)return;const e=this.context.table.tableHighlight.style,t=this.context.table.tableUnHighlight.style;e.width="1em",e.height="1em",t.width="10em",t.height="10em",this.util.changeTxt(this.context.table.tableDisplay,"1 x 1"),this.submenuOff()},init:function(){const e=this.context.table,t=this.plugins.table;if(t._removeEvents.call(this),t._selectedTable){const e=t._selectedTable.querySelectorAll(".se-table-selected-cell");for(let t=0,i=e.length;t<i;t++)this.util.removeClass(e[t],"se-table-selected-cell")}t._toggleEditor.call(this,!0),e._element=null,e._tdElement=null,e._trElement=null,e._trElements=null,e._tableXY=[],e._maxWidth=!0,e._fixedColumn=!1,e._physical_cellCnt=0,e._logical_cellCnt=0,e._rowCnt=0,e._rowIndex=0,e._physical_cellIndex=0,e._logical_cellIndex=0,e._current_colSpan=0,e._current_rowSpan=0,t._shift=!1,t._selectedCells=null,t._selectedTable=null,t._ref=null,t._fixedCell=null,t._selectedCell=null,t._fixedCellName=null},call_controller_tableEdit:function(e){const t=this.plugins.table,i=this.context.table;if(!this.getSelection().isCollapsed&&!t._selectedCell)return this.controllersOff(),void this.util.removeClass(e,"se-table-selected-cell");const n=i._element||this.plugins.table._selectedTable||this.util.getParentElement(e,"TABLE");i._maxWidth=this.util.hasClass(n,"se-table-size-100")||"100%"===n.style.width||!n.style.width&&!this.util.hasClass(n,"se-table-size-auto"),i._fixedColumn=this.util.hasClass(n,"se-table-layout-fixed")||"fixed"===n.style.tableLayout,t.setTableStyle.call(this,i._maxWidth?"width|column":"width"),t.setPositionControllerTop.call(this,n),t.setPositionControllerDiv.call(this,e,t._shift),t._shift||this.controllersOn(i.resizeDiv,i.tableController,t.init.bind(this),e,"table")},setPositionControllerTop:function(e){this.setControllerPosition(this.context.table.tableController,e,"top",{left:0,top:0})},setPositionControllerDiv:function(e,t){const i=this.context.table,n=i.resizeDiv;this.plugins.table.setCellInfo.call(this,e,t),i.cellControllerTop?this.setControllerPosition(n,i._element,"top",{left:i.tableController.offsetWidth,top:0}):this.setControllerPosition(n,e,"bottom",{left:0,top:0})},setCellInfo:function(e,t){const i=this.context.table,n=i._element=this.plugins.table._selectedTable||this.util.getParentElement(e,"TABLE");if(/THEAD/i.test(n.firstElementChild.nodeName)?this.util.addClass(i.headerButton,"active"):this.util.removeClass(i.headerButton,"active"),t||0===i._physical_cellCnt){i._tdElement!==e&&(i._tdElement=e,i._trElement=e.parentNode);const t=i._trElements=n.rows,s=e.cellIndex;let l=0;for(let e=0,i=t[0].cells,n=t[0].cells.length;e<n;e++)l+=i[e].colSpan;const o=i._rowIndex=i._trElement.rowIndex;i._rowCnt=t.length,i._physical_cellCnt=i._trElement.cells.length,i._logical_cellCnt=l,i._physical_cellIndex=s,i._current_colSpan=i._tdElement.colSpan-1,i._current_rowSpan,i._trElement.cells[s].rowSpan;let a=[],r=[];for(let e,n,l=0;l<=o;l++){e=t[l].cells,n=0;for(let t,u,c,d,h=0,p=e.length;h<p;h++){if(t=e[h],u=t.colSpan-1,c=t.rowSpan-1,d=h+n,r.length>0)for(let e,t=0;t<r.length;t++)e=r[t],e.row>l||(d>=e.index?(n+=e.cs,d+=e.cs,e.rs-=1,e.row=l+1,e.rs<1&&(r.splice(t,1),t--)):h===p-1&&(e.rs-=1,e.row=l+1,e.rs<1&&(r.splice(t,1),t--)));if(l===o&&h===s){i._logical_cellIndex=d;break}c>0&&a.push({index:d,cs:u+1,rs:c,row:-1}),n+=u}r=r.concat(a).sort((function(e,t){return e.index-t.index})),a=[]}a=null,r=null}},editTable:function(e,t){const i=this.plugins.table,n=this.context.table,s=n._element,l="row"===e;if(l){const e=n._trElement.parentNode;if(/^THEAD$/i.test(e.nodeName)){if("up"===t)return;if(!e.nextElementSibling||!/^TBODY$/i.test(e.nextElementSibling.nodeName))return void(s.innerHTML+="<tbody><tr>"+i.createCells.call(this,"td",n._logical_cellCnt,!1)+"</tr></tbody>")}}if(i._ref){const e=n._tdElement,s=i._selectedCells;if(l)if(t)i.setCellInfo.call(this,"up"===t?s[0]:s[s.length-1],!0),i.editRow.call(this,t,e);else{let e=s[0].parentNode;const n=[s[0]];for(let t,i=1,l=s.length;i<l;i++)t=s[i],e!==t.parentNode&&(n.push(t),e=t.parentNode);for(let e=0,s=n.length;e<s;e++)i.setCellInfo.call(this,n[e],!0),i.editRow.call(this,t)}else{const n=s[0].parentNode;if(t){let l=null;for(let e=0,t=s.length-1;e<t;e++)if(n!==s[e+1].parentNode){l=s[e];break}i.setCellInfo.call(this,"left"===t?s[0]:l||s[0],!0),i.editCell.call(this,t,e)}else{const e=[s[0]];for(let t,i=1,l=s.length;i<l&&(t=s[i],n===t.parentNode);i++)e.push(t);for(let n=0,s=e.length;n<s;n++)i.setCellInfo.call(this,e[n],!0),i.editCell.call(this,t)}}t||i.init.call(this)}else i[l?"editRow":"editCell"].call(this,t);if(!t){const e=s.children;for(let t=0;t<e.length;t++)0===e[t].children.length&&(this.util.removeItem(e[t]),t--);0===s.children.length&&this.util.removeItem(s)}},editRow:function(e,t){const i=this.context.table,n=!e,s="up"===e,l=i._rowIndex,o=n||s?l:l+i._current_rowSpan+1,a=n?-1:1,r=i._trElements;let u=i._logical_cellCnt;for(let e,t=0,i=l+(n?-1:0);t<=i;t++){if(e=r[t].cells,0===e.length)return;for(let i,n,s=0,l=e.length;s<l;s++)i=e[s].rowSpan,n=e[s].colSpan,i<2&&n<2||i+t>o&&o>t&&(e[s].rowSpan=i+a,u-=n)}if(n){const e=r[l+1];if(e){const t=[];let i=r[l].cells,n=0;for(let e,s,l=0,o=i.length;l<o;l++)e=i[l],s=l+n,n+=e.colSpan-1,e.rowSpan>1&&(e.rowSpan-=1,t.push({cell:e.cloneNode(!1),index:s}));if(t.length>0){let s=t.shift();i=e.cells,n=0;for(let l,o,a=0,r=i.length;a<r&&(l=i[a],o=a+n,n+=l.colSpan-1,!(o>=s.index)||(a--,n--,n+=s.cell.colSpan-1,e.insertBefore(s.cell,l),s=t.shift(),s));a++);if(s){e.appendChild(s.cell);for(let i=0,n=t.length;i<n;i++)e.appendChild(t[i].cell)}}}i._element.deleteRow(o)}else{i._element.insertRow(o).innerHTML=this.plugins.table.createCells.call(this,"td",u,!1)}n?this.controllersOff():this.plugins.table.setPositionControllerDiv.call(this,t||i._tdElement,!0)},editCell:function(e,t){const i=this.context.table,n=this.util,s=!e,l="left"===e,o=i._current_colSpan,a=s||l?i._logical_cellIndex:i._logical_cellIndex+o+1,r=i._trElements;let u=[],c=[],d=0;const h=[],p=[];for(let e,t,l,f,g,m,v=0,b=i._rowCnt;v<b;v++){e=r[v],t=a,g=!1,l=e.cells,m=0;for(let e,i,r,f,b=0,_=l.length;b<_&&(e=l[b],e);b++)if(i=e.rowSpan-1,r=e.colSpan-1,s){if(f=b+m,c.length>0){const e=!l[b+1];for(let t,i=0;i<c.length;i++)t=c[i],t.row>v||(f>=t.index?(m+=t.cs,f=b+m,t.rs-=1,t.row=v+1,t.rs<1&&(c.splice(i,1),i--)):e&&(t.rs-=1,t.row=v+1,t.rs<1&&(c.splice(i,1),i--)))}i>0&&u.push({rs:i,cs:r+1,index:f,row:-1}),f>=t&&f+r<=t+o?h.push(e):f<=t+o&&f+r>=t?e.colSpan-=n.getOverlapRangeAtIndex(a,a+o,f,f+r):i>0&&(f<t||f+r>t+o)&&p.push({cell:e,i:v,rs:v+i}),m+=r}else{if(b>=t)break;if(r>0){if(d<1&&r+b>=t){e.colSpan+=1,t=null,d=i+1;break}t-=r}if(!g){for(let e,i=0;i<c.length;i++)e=c[i],t-=e.cs,e.rs-=1,e.rs<1&&(c.splice(i,1),i--);g=!0}}if(c=c.concat(u).sort((function(e,t){return e.index-t.index})),u=[],!s){if(d>0){d-=1;continue}null!==t&&l.length>0&&(f=this.plugins.table.createCells.call(this,l[0].nodeName,0,!0),f=e.insertBefore(f,l[t]))}}if(s){let e,t;for(let i,s=0,l=h.length;s<l;s++)i=h[s].parentNode,n.removeItem(h[s]),0===i.cells.length&&(e||(e=n.getArrayIndex(r,i)),t=n.getArrayIndex(r,i),n.removeItem(i));for(let i,s=0,l=p.length;s<l;s++)i=p[s],i.cell.rowSpan=n.getOverlapRangeAtIndex(e,t,i.i,i.rs);this.controllersOff()}else this.plugins.table.setPositionControllerDiv.call(this,t||i._tdElement,!0)},_closeSplitMenu:null,openSplitMenu:function(){this.util.addClass(this.context.table.splitButton,"on"),this.context.table.splitMenu.style.display="inline-table",this.plugins.table._closeSplitMenu=function(){this.util.removeClass(this.context.table.splitButton,"on"),this.context.table.splitMenu.style.display="none",this.removeDocEvent("click",this.plugins.table._closeSplitMenu),this.plugins.table._closeSplitMenu=null}.bind(this),this.addDocEvent("click",this.plugins.table._closeSplitMenu)},splitCells:function(e){const t=this.util,i="vertical"===e,n=this.context.table,s=n._tdElement,l=n._trElements,o=n._trElement,a=n._logical_cellIndex,r=n._rowIndex,u=this.plugins.table.createCells.call(this,s.nodeName,0,!0);if(i){const e=s.colSpan;if(u.rowSpan=s.rowSpan,e>1)u.colSpan=this._w.Math.floor(e/2),s.colSpan=e-u.colSpan,o.insertBefore(u,s.nextElementSibling);else{let t=[],i=[];for(let o,r,u=0,c=n._rowCnt;u<c;u++){o=l[u].cells,r=0;for(let n,l,c,d,h=0,p=o.length;h<p;h++){if(n=o[h],l=n.colSpan-1,c=n.rowSpan-1,d=h+r,i.length>0)for(let e,t=0;t<i.length;t++)e=i[t],e.row>u||(d>=e.index?(r+=e.cs,d+=e.cs,e.rs-=1,e.row=u+1,e.rs<1&&(i.splice(t,1),t--)):h===p-1&&(e.rs-=1,e.row=u+1,e.rs<1&&(i.splice(t,1),t--)));if(d<=a&&c>0&&t.push({index:d,cs:l+1,rs:c,row:-1}),n!==s&&d<=a&&d+l>=a+e-1){n.colSpan+=1;break}if(d>a)break;r+=l}i=i.concat(t).sort((function(e,t){return e.index-t.index})),t=[]}o.insertBefore(u,s.nextElementSibling)}}else{const e=s.rowSpan;if(u.colSpan=s.colSpan,e>1){u.rowSpan=this._w.Math.floor(e/2);const i=e-u.rowSpan,n=[],r=t.getArrayIndex(l,o)+i;for(let e,t,i=0;i<r;i++){e=l[i].cells,t=0;for(let s,l,o,u=0,c=e.length;u<c&&(o=u+t,!(o>=a));u++)s=e[u],l=s.rowSpan-1,l>0&&l+i>=r&&o<a&&n.push({index:o,cs:s.colSpan}),t+=s.colSpan-1}const c=l[r],d=c.cells;let h=n.shift();for(let e,t,i,s,l=0,o=d.length,r=0;l<o;l++){if(i=l+r,e=d[l],t=e.colSpan-1,s=i+t+1,h&&s>=h.index&&(r+=h.cs,s+=h.cs,h=n.shift()),s>=a||l===o-1){c.insertBefore(u,e.nextElementSibling);break}r+=t}s.rowSpan=i}else{u.rowSpan=s.rowSpan;const e=t.createElement("TR");e.appendChild(u);for(let e,t=0;t<r;t++){if(e=l[t].cells,0===e.length)return;for(let i=0,n=e.length;i<n;i++)t+e[i].rowSpan-1>=r&&(e[i].rowSpan+=1)}const i=n._physical_cellIndex,a=o.cells;for(let e=0,t=a.length;e<t;e++)e!==i&&(a[e].rowSpan+=1);o.parentNode.insertBefore(e,o.nextElementSibling)}}this.focusEdge(s),this.plugins.table.setPositionControllerDiv.call(this,s,!0)},mergeCells:function(){const e=this.plugins.table,t=this.context.table,i=this.util,n=e._ref,s=e._selectedCells,l=s[0];let o=null,a=null,r=n.ce-n.cs+1,u=n.re-n.rs+1,c="",d=null;for(let e,t,n=1,l=s.length;n<l;n++){e=s[n],d!==e.parentNode&&(d=e.parentNode),t=e.children;for(let e=0,n=t.length;e<n;e++)i.isFormatElement(t[e])&&i.onlyZeroWidthSpace(t[e].textContent)&&i.removeItem(t[e]);c+=e.innerHTML,i.removeItem(e),0===d.cells.length&&(o?a=d:o=d,u-=1)}if(o){const e=t._trElements,n=i.getArrayIndex(e,o),s=i.getArrayIndex(e,a||o),l=[];for(let t,o=0;o<=s;o++)if(t=e[o].cells,0!==t.length)for(let e,l,a=0,r=t.length;a<r;a++)e=t[a],l=e.rowSpan-1,l>0&&o+l>=n&&(e.rowSpan-=i.getOverlapRangeAtIndex(n,s,o,o+l));else l.push(e[o]);for(let e=0,t=l.length;e<t;e++)i.removeItem(l[e])}l.innerHTML+=c,l.colSpan=r,l.rowSpan=u,this.controllersOff(),e.setActiveButton.call(this,!0,!1),e.call_controller_tableEdit.call(this,l),i.addClass(l,"se-table-selected-cell"),this.focusEdge(l)},toggleHeader:function(){const e=this.util,t=this.context.table.headerButton,i=e.hasClass(t,"active"),n=this.context.table._element;if(i)e.removeItem(n.querySelector("thead"));else{const t=e.createElement("THEAD");t.innerHTML="<tr>"+this.plugins.table.createCells.call(this,"th",this.context.table._logical_cellCnt,!1)+"</tr>",n.insertBefore(t,n.firstElementChild)}e.toggleClass(t,"active"),/TH/i.test(this.context.table._tdElement.nodeName)?this.controllersOff():this.plugins.table.setPositionControllerDiv.call(this,this.context.table._tdElement,!1)},setTableStyle:function(e){const t=this.context.table,i=t._element;let n,s,l,o;e.indexOf("width")>-1&&(n=t.resizeButton.firstElementChild,s=t.resizeText,t._maxWidth?(l=t.icons.reduction,o=t.minText,t.columnFixedButton.style.display="block",this.util.removeClass(i,"se-table-size-auto"),this.util.addClass(i,"se-table-size-100")):(l=t.icons.expansion,o=t.maxText,t.columnFixedButton.style.display="none",this.util.removeClass(i,"se-table-size-100"),this.util.addClass(i,"se-table-size-auto")),this.util.changeElement(n,l),this.util.changeTxt(s,o)),e.indexOf("column")>-1&&(t._fixedColumn?(this.util.removeClass(i,"se-table-layout-auto"),this.util.addClass(i,"se-table-layout-fixed"),this.util.addClass(t.columnFixedButton,"active")):(this.util.removeClass(i,"se-table-layout-fixed"),this.util.addClass(i,"se-table-layout-auto"),this.util.removeClass(t.columnFixedButton,"active")))},setActiveButton:function(e,t){const i=this.context.table;/^TH$/i.test(e.nodeName)?(i.insertRowAboveButton.setAttribute("disabled",!0),i.insertRowBelowButton.setAttribute("disabled",!0)):(i.insertRowAboveButton.removeAttribute("disabled"),i.insertRowBelowButton.removeAttribute("disabled")),t&&e!==t?(i.splitButton.setAttribute("disabled",!0),i.mergeButton.removeAttribute("disabled")):(i.splitButton.removeAttribute("disabled"),i.mergeButton.setAttribute("disabled",!0))},_bindOnSelect:null,_bindOffSelect:null,_bindOffShift:null,_selectedCells:null,_shift:!1,_fixedCell:null,_fixedCellName:null,_selectedCell:null,_selectedTable:null,_ref:null,_toggleEditor:function(e){this.context.element.wysiwyg.setAttribute("contenteditable",e),e?this.util.removeClass(this.context.element.wysiwyg,"se-disabled"):this.util.addClass(this.context.element.wysiwyg,"se-disabled")},_offCellMultiSelect:function(e){e.stopPropagation();const t=this.plugins.table;t._shift?t._initBind&&(this._wd.removeEventListener("touchmove",t._initBind),t._initBind=null):(t._removeEvents.call(this),t._toggleEditor.call(this,!0)),t._fixedCell&&t._selectedTable&&(t.setActiveButton.call(this,t._fixedCell,t._selectedCell),t.call_controller_tableEdit.call(this,t._selectedCell||t._fixedCell),t._selectedCells=t._selectedTable.querySelectorAll(".se-table-selected-cell"),t._selectedCell&&t._fixedCell&&this.focusEdge(t._selectedCell),t._shift||(t._fixedCell=null,t._selectedCell=null,t._fixedCellName=null))},_onCellMultiSelect:function(e){this._antiBlur=!0;const t=this.plugins.table,i=this.util.getParentElement(e.target,this.util.isCell);if(t._shift)i===t._fixedCell?t._toggleEditor.call(this,!0):t._toggleEditor.call(this,!1);else if(!t._ref){if(i===t._fixedCell)return;t._toggleEditor.call(this,!1)}i&&i!==t._selectedCell&&t._fixedCellName===i.nodeName&&t._selectedTable===this.util.getParentElement(i,"TABLE")&&(t._selectedCell=i,t._setMultiCells.call(this,t._fixedCell,i))},_setMultiCells:function(e,t){const i=this.plugins.table,n=i._selectedTable.rows,s=this.util,l=i._selectedTable.querySelectorAll(".se-table-selected-cell");for(let e=0,t=l.length;e<t;e++)s.removeClass(l[e],"se-table-selected-cell");if(e===t&&(s.addClass(e,"se-table-selected-cell"),!i._shift))return;let o=!0,a=[],r=[];const u=i._ref={_i:0,cs:null,ce:null,rs:null,re:null};for(let i,l,c=0,d=n.length;c<d;c++){i=n[c].cells,l=0;for(let n,d,h,p,f=0,g=i.length;f<g;f++){if(n=i[f],h=n.colSpan-1,p=n.rowSpan-1,d=f+l,a.length>0)for(let e,t=0;t<a.length;t++)e=a[t],e.row>c||(d>=e.index?(l+=e.cs,d+=e.cs,e.rs-=1,e.row=c+1,e.rs<1&&(a.splice(t,1),t--)):f===g-1&&(e.rs-=1,e.row=c+1,e.rs<1&&(a.splice(t,1),t--)));if(o){if(n!==e&&n!==t||(u.cs=null!==u.cs&&u.cs<d?u.cs:d,u.ce=null!==u.ce&&u.ce>d+h?u.ce:d+h,u.rs=null!==u.rs&&u.rs<c?u.rs:c,u.re=null!==u.re&&u.re>c+p?u.re:c+p,u._i+=1),2===u._i){o=!1,a=[],r=[],c=-1;break}}else if(s.getOverlapRangeAtIndex(u.cs,u.ce,d,d+h)&&s.getOverlapRangeAtIndex(u.rs,u.re,c,c+p)){const e=u.cs<d?u.cs:d,t=u.ce>d+h?u.ce:d+h,i=u.rs<c?u.rs:c,l=u.re>c+p?u.re:c+p;if(u.cs!==e||u.ce!==t||u.rs!==i||u.re!==l){u.cs=e,u.ce=t,u.rs=i,u.re=l,c=-1,a=[],r=[];break}s.addClass(n,"se-table-selected-cell")}p>0&&r.push({index:d,cs:h+1,rs:p,row:-1}),l+=n.colSpan-1}a=a.concat(r).sort((function(e,t){return e.index-t.index})),r=[]}},_removeEvents:function(){const e=this.plugins.table;e._initBind&&(this._wd.removeEventListener("touchmove",e._initBind),e._initBind=null),e._bindOnSelect&&(this._wd.removeEventListener("mousedown",e._bindOnSelect),this._wd.removeEventListener("mousemove",e._bindOnSelect),e._bindOnSelect=null),e._bindOffSelect&&(this._wd.removeEventListener("mouseup",e._bindOffSelect),e._bindOffSelect=null),e._bindOffShift&&(this._wd.removeEventListener("keyup",e._bindOffShift),e._bindOffShift=null)},_initBind:null,onTableCellMultiSelect:function(e,t){const i=this.plugins.table;i._removeEvents.call(this),this.controllersOff(),i._shift=t,i._fixedCell=e,i._fixedCellName=e.nodeName,i._selectedTable=this.util.getParentElement(e,"TABLE");const n=i._selectedTable.querySelectorAll(".se-table-selected-cell");for(let e=0,t=n.length;e<t;e++)this.util.removeClass(n[e],"se-table-selected-cell");this.util.addClass(e,"se-table-selected-cell"),i._bindOnSelect=i._onCellMultiSelect.bind(this),i._bindOffSelect=i._offCellMultiSelect.bind(this),t?(i._bindOffShift=function(){this.controllersOn(this.context.table.resizeDiv,this.context.table.tableController,this.plugins.table.init.bind(this),e,"table"),i._ref||this.controllersOff()}.bind(this),this._wd.addEventListener("keyup",i._bindOffShift,!1),this._wd.addEventListener("mousedown",i._bindOnSelect,!1)):this._wd.addEventListener("mousemove",i._bindOnSelect,!1),this._wd.addEventListener("mouseup",i._bindOffSelect,!1),i._initBind=i.init.bind(this),this._wd.addEventListener("touchmove",i._initBind,!1)},onClick_tableController:function(e){e.stopPropagation();const t=e.target.getAttribute("data-command")?e.target:e.target.parentNode;if(t.getAttribute("disabled"))return;const i=t.getAttribute("data-command"),n=t.getAttribute("data-value"),s=t.getAttribute("data-option"),l=this.plugins.table;if("function"==typeof l._closeSplitMenu&&(l._closeSplitMenu(),"onsplit"===i))return;if(!i)return;e.preventDefault();const o=this.context.table;switch(i){case"insert":case"delete":l.editTable.call(this,n,s);break;case"header":l.toggleHeader.call(this);break;case"onsplit":l.openSplitMenu.call(this);break;case"split":l.splitCells.call(this,n);break;case"merge":l.mergeCells.call(this);break;case"resize":o._maxWidth=!o._maxWidth,l.setTableStyle.call(this,"width"),l.setPositionControllerTop.call(this,o._element),l.setPositionControllerDiv.call(this,o._tdElement,l._shift);break;case"layout":o._fixedColumn=!o._fixedColumn,l.setTableStyle.call(this,"column"),l.setPositionControllerTop.call(this,o._element),l.setPositionControllerDiv.call(this,o._tdElement,l._shift);break;case"remove":const e=o._element.parentNode;this.util.removeItem(o._element),this.controllersOff(),e!==this.context.element.wysiwyg&&this.util.removeItemAllParents(e,(function(e){return 0===e.childNodes.length}),null),this.focus()}this.history.push(!1)}},formatBlock:{name:"formatBlock",display:"submenu",add:function(e,t){const i=e.context;i.formatBlock={targetText:t.querySelector(".txt"),targetTooltip:t.parentNode.querySelector(".se-tooltip-text"),_formatList:null,currentFormat:""};let n=this.setSubmenu(e);n.querySelector("ul").addEventListener("click",this.pickUp.bind(e)),i.formatBlock._formatList=n.querySelectorAll("li button"),e.initMenuTarget(this.name,t,n),n=null},setSubmenu:function(e){const t=e.options,i=e.lang.toolbar,n=e.util.createElement("DIV");n.className="se-submenu se-list-layer se-list-format";const s=["p","div","blockquote","pre","h1","h2","h3","h4","h5","h6"],l=t.formats&&0!==t.formats.length?t.formats:s;let o='<div class="se-list-inner"><ul class="se-list-basic">';for(let e,t,n,a,r,u,c,d=0,h=l.length;d<h;d++)e=l[d],"string"==typeof e&&s.indexOf(e)>-1?(t=e.toLowerCase(),n="blockquote"===t?"range":"pre"===t?"free":"replace",r=/^h/.test(t)?t.match(/\d+/)[0]:"",a=i["tag_"+(r?"h":t)]+r,c="",u=""):(t=e.tag.toLowerCase(),n=e.command,a=e.name||t,c=e.class,u=c?' class="'+c+'"':""),o+='<li><button type="button" class="se-btn-list" data-command="'+n+'" data-value="'+t+'" data-class="'+c+'" title="'+a+'"><'+t+u+">"+a+"</"+t+"></button></li>";return o+="</ul></div>",n.innerHTML=o,n},active:function(e){let t=this.lang.toolbar.formats;const i=this.context.formatBlock.targetText;if(e){if(this.util.isFormatElement(e)){const n=this.context.formatBlock._formatList,s=e.nodeName.toLowerCase(),l=(e.className.match(/(\s|^)__se__format__[^\s]+/)||[""])[0].trim();for(let e,i=0,o=n.length;i<o;i++)if(e=n[i],s===e.getAttribute("data-value")&&l===e.getAttribute("data-class")){t=e.title;break}return this.util.changeTxt(i,t),i.setAttribute("data-value",s),i.setAttribute("data-class",l),!0}}else this.util.changeTxt(i,t);return!1},on:function(){const e=this.context.formatBlock,t=e._formatList,i=e.targetText,n=(i.getAttribute("data-value")||"")+(i.getAttribute("data-class")||"");if(n!==e.currentFormat){for(let e,i=0,s=t.length;i<s;i++)e=t[i],n===e.getAttribute("data-value")+e.getAttribute("data-class")?this.util.addClass(e,"active"):this.util.removeClass(e,"active");e.currentFormat=n}},pickUp:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,i=null,n=null,s=null,l="";for(;!i&&!/UL/i.test(t.tagName);){if(i=t.getAttribute("data-command"),n=t.getAttribute("data-value"),l=t.getAttribute("data-class"),i){s=t.firstChild;break}t=t.parentNode}if(i){if("range"===i){const e=s.cloneNode(!1);this.applyRangeFormatElement(e)}else{let e=this.getRange(),t=this.getSelectedElementsAndComponents(!1);if(0===t.length&&(e=this.getRange_addLine(e,null),t=this.getSelectedElementsAndComponents(!1),0===t.length))return;const o=e.startOffset,a=e.endOffset,r=this.util;let u=t[0],c=t[t.length-1];const d=r.getNodePath(e.startContainer,u,null,null),h=r.getNodePath(e.endContainer,c,null,null),p=this.detachList(t,!1);p.sc&&(u=p.sc),p.ec&&(c=p.ec),this.setRange(r.getNodeFromPath(d,u),o,r.getNodeFromPath(h,c),a);const f=this.getSelectedElementsAndComponents(!1);if("free"===i){const e=f.length-1;let t=f[e].parentNode,i=s.cloneNode(!1);const n=i;for(let n,l,o,a,u,c,d=e,h=!0;d>=0;d--)if(n=f[d],n!==(f[d+1]?f[d+1].parentNode:null)){if(c=r.isComponent(n),l=c?"":n.innerHTML.replace(/(?!>)\s+(?=<)|\n/g," "),o=r.getParentElement(n,(function(e){return e.parentNode===t})),(t!==n.parentNode||c)&&(r.isFormatElement(t)?(t.parentNode.insertBefore(i,t.nextSibling),t=t.parentNode):(t.insertBefore(i,o?o.nextSibling:null),t=n.parentNode),a=i.nextSibling,a&&i.nodeName===a.nodeName&&r.isSameAttributes(i,a)&&(i.innerHTML+="<BR>"+a.innerHTML,r.removeItem(a)),i=s.cloneNode(!1),h=!0),u=i.innerHTML,i.innerHTML=(h||!l||!u||/<br>$/i.test(l)?l:l+"<BR>")+u,0===d){t.insertBefore(i,n),a=n.nextSibling,a&&i.nodeName===a.nodeName&&r.isSameAttributes(i,a)&&(i.innerHTML+="<BR>"+a.innerHTML,r.removeItem(a));const e=i.previousSibling;e&&i.nodeName===e.nodeName&&r.isSameAttributes(i,e)&&(e.innerHTML+="<BR>"+i.innerHTML,r.removeItem(i))}c||r.removeItem(n),l&&(h=!1)}this.setRange(n,0,n,0)}else{for(let e,t,i=0,o=f.length;i<o;i++)e=f[i],e.nodeName.toLowerCase()===n.toLowerCase()&&(e.className.match(/(\s|^)__se__format__[^\s]+/)||[""])[0].trim()===l||r.isComponent(e)||(t=s.cloneNode(!1),r.copyFormatAttributes(t,e),t.innerHTML=e.innerHTML,e.parentNode.replaceChild(t,e)),0===i&&(u=t||e),i===o-1&&(c=t||e),t=null;this.setRange(r.getNodeFromPath(d,u),o,r.getNodeFromPath(h,c),a)}this.history.push(!1)}this.submenuOff()}}},lineHeight:{name:"lineHeight",display:"submenu",add:function(e,t){const i=e.context;i.lineHeight={_sizeList:null,currentSize:-1};let n=this.setSubmenu(e),s=n.querySelector("ul");s.addEventListener("click",this.pickup.bind(e)),i.lineHeight._sizeList=s.querySelectorAll("li button"),e.initMenuTarget(this.name,t,n),n=null,s=null},setSubmenu:function(e){const t=e.options,i=e.lang,n=e.util.createElement("DIV");n.className="se-submenu se-list-layer";const s=t.lineHeights?t.lineHeights:[{text:"1",value:1},{text:"1.15",value:1.15},{text:"1.5",value:1.5},{text:"2",value:2}];let l='<div class="se-list-inner"><ul class="se-list-basic"><li><button type="button" class="default_value se-btn-list" title="'+i.toolbar.default+'">('+i.toolbar.default+")</button></li>";for(let e,t=0,i=s.length;t<i;t++)e=s[t],l+='<li><button type="button" class="se-btn-list" data-value="'+e.value+'" title="'+e.text+'">'+e.text+"</button></li>";return l+="</ul></div>",n.innerHTML=l,n},on:function(){const e=this.context.lineHeight,t=e._sizeList,i=this.util.getFormatElement(this.getSelectionNode()),n=i?i.style.lineHeight+"":"";if(n!==e.currentSize){for(let e=0,i=t.length;e<i;e++)n===t[e].getAttribute("data-value")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentSize=n}},pickup:function(e){if(!/^BUTTON$/i.test(e.target.tagName))return!1;e.preventDefault(),e.stopPropagation();const t=e.target.getAttribute("data-value")||"",i=this.getSelectedElements();for(let e=0,n=i.length;e<n;e++)i[e].style.lineHeight=t;this.submenuOff(),this.history.push(!1)}},template:o,paragraphStyle:{name:"paragraphStyle",display:"submenu",add:function(e,t){const i=e.context;i.paragraphStyle={_classList:null};let n=this.setSubmenu(e);n.querySelector("ul").addEventListener("click",this.pickUp.bind(e)),i.paragraphStyle._classList=n.querySelectorAll("li button"),e.initMenuTarget(this.name,t,n),n=null},setSubmenu:function(e){const t=e.options,i=e.util.createElement("DIV");i.className="se-submenu se-list-layer se-list-format";const n=e.lang.menu,s={spaced:{name:n.spaced,class:"__se__p-spaced",_class:""},bordered:{name:n.bordered,class:"__se__p-bordered",_class:""},neon:{name:n.neon,class:"__se__p-neon",_class:""}},l=t.paragraphStyles&&0!==t.paragraphStyles.length?t.paragraphStyles:["spaced","bordered","neon"];let o='<div class="se-list-inner"><ul class="se-list-basic">';for(let e,t,i,n,a=0,r=l.length;a<r;a++){if(e=l[a],"string"==typeof e){const t=s[e.toLowerCase()];if(!t)continue;e=t}t=e.name,i=e.class?' class="'+e.class+'"':"",n=e._class,o+='<li><button type="button" class="se-btn-list'+(n?" "+n:"")+'" data-value="'+e.class+'" title="'+t+'"><div'+i+">"+t+"</div></button></li>"}return o+="</ul></div>",i.innerHTML=o,i},on:function(){const e=this.context.paragraphStyle._classList,t=this.util.getFormatElement(this.getSelectionNode());for(let i=0,n=e.length;i<n;i++)this.util.hasClass(t,e[i].getAttribute("data-value"))?this.util.addClass(e[i],"active"):this.util.removeClass(e[i],"active")},pickUp:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,i=null;for(;!/^UL$/i.test(t.tagName)&&(i=t.getAttribute("data-value"),!i);)t=t.parentNode;if(!i)return;let n=this.getSelectedElements();if(0===n.length&&(this.getRange_addLine(this.getRange(),null),n=this.getSelectedElements(),0===n.length))return;const s=this.util.hasClass(t,"active")?this.util.removeClass.bind(this.util):this.util.addClass.bind(this.util);for(let e=0,t=n.length;e<t;e++)s(n[e],i);this.submenuOff(),this.history.push(!1)}},textStyle:{name:"textStyle",display:"submenu",add:function(e,t){const i=e.context;i.textStyle={_styleList:null};let n=this.setSubmenu(e),s=n.querySelector("ul");s.addEventListener("click",this.pickup.bind(e)),i.textStyle._styleList=n.querySelectorAll("li button"),e.initMenuTarget(this.name,t,n),n=null,s=null},setSubmenu:function(e){const t=e.options,i=e.util.createElement("DIV");i.className="se-submenu se-list-layer se-list-format";const n={code:{name:e.lang.menu.code,class:"__se__t-code",tag:"code"},translucent:{name:e.lang.menu.translucent,style:"opacity: 0.5;",tag:"span"},shadow:{name:e.lang.menu.shadow,class:"__se__t-shadow",tag:"span"}},s=t.textStyles?t.textStyles:e._w.Object.keys(n);let l='<div class="se-list-inner"><ul class="se-list-basic">';for(let e,t,i,o,a,r,u,c=0,d=s.length;c<d;c++){if(e=s[c],o="",r="",a=[],"string"==typeof e){const t=n[e.toLowerCase()];if(!t)continue;e=t}i=e.name,t=e.tag||"span",u=e._class,e.style&&(o+=' style="'+e.style+'"',r+=e.style.replace(/:[^;]+(;|$)\s*/g,","),a.push("style")),e.class&&(o+=' class="'+e.class+'"',r+="."+e.class.trim().replace(/\s+/g,",."),a.push("class")),r=r.replace(/,$/,""),l+='<li><button type="button" class="se-btn-list'+(u?" "+u:"")+'" data-command="'+t+'" data-value="'+r+'" title="'+i+'"><'+t+o+">"+i+"</"+t+"></button></li>"}return l+="</ul></div>",i.innerHTML=l,i},on:function(){const e=this.util,t=this.context.textStyle._styleList,i=this.getSelectionNode();for(let n,s,l,o=0,a=t.length;o<a;o++){n=t[o],s=n.getAttribute("data-value").split(",");for(let t,o,a=0;a<s.length;a++){for(t=i,l=!1;t&&!e.isFormatElement(t)&&!e.isComponent(t);){if(t.nodeName.toLowerCase()===n.getAttribute("data-command").toLowerCase()&&(o=s[a],/^\./.test(o)?e.hasClass(t,o.replace(/^\./,"")):t.style[o])){l=!0;break}t=t.parentNode}if(!l)break}l?e.addClass(n,"active"):e.removeClass(n,"active")}},pickup:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,i=null,n=null;for(;!i&&!/UL/i.test(t.tagName);){if(i=t.getAttribute("data-command"),i){n=t.firstChild;break}t=t.parentNode}if(!i)return;const s=n.style.cssText.replace(/:.+(;|$)/g,",").split(",");s.pop();const l=n.classList;for(let e=0,t=l.length;e<t;e++)s.push("."+l[e]);const o=this.util.hasClass(t,"active")?null:n.cloneNode(!1),a=o?null:[n.nodeName];this.nodeChange(o,s,a,!0),this.submenuOff()}},link:d,image:b,video:_,audio:y,math:x,imageGallery:{name:"imageGallery",add:function(e){e.addModule([k()]);e.context.imageGallery={title:e.lang.toolbar.imageGallery,url:e.options.imageGalleryUrl,header:e.options.imageGalleryHeader,listClass:"se-image-list",itemTemplateHandler:this.drawItems,selectorHandler:this.setImage.bind(e),columnSize:4}},open:function(e){this.plugins.fileBrowser.open.call(this,"imageGallery",e)},drawItems:function(e){const t=e.src.split("/").pop();return'<div class="se-file-item-img"><img src="'+(e.thumbnail||e.src)+'" alt="'+(e.alt||t)+'" data-command="pick" data-value="'+(e.src||e.thumbnail)+'"><div class="se-file-img-name se-file-name-back"></div><div class="se-file-img-name __se__img_name">'+(e.name||t)+"</div></div>"},setImage:function(e){this.callPlugin("image",function(){const t={name:e.parentNode.querySelector(".__se__img_name").textContent,size:0};this.plugins.image.create_image.call(this,e.getAttribute("data-value"),null,this.context.image._origin_w,this.context.image._origin_h,"none",t,e.alt)}.bind(this),null)}}}},1841:function(e){"use strict";var t,i;t="undefined"!=typeof window?window:this,i=function(e,t){const i={name:"component",set_container:function(e,t){const i=this.util.createElement("DIV");return i.className="se-component "+t,i.setAttribute("contenteditable",!1),i.appendChild(e),i},set_cover:function(e){const t=this.util.createElement("FIGURE");return t.appendChild(e),t},create_caption:function(){const e=this.util.createElement("FIGCAPTION");return e.setAttribute("contenteditable",!0),e.innerHTML="<div>"+this.lang.dialogBox.caption+"</div>",e}};return void 0===t&&(e.SUNEDITOR_MODULES||Object.defineProperty(e,"SUNEDITOR_MODULES",{enumerable:!0,writable:!1,configurable:!1,value:{}}),Object.defineProperty(e.SUNEDITOR_MODULES,"component",{enumerable:!0,writable:!1,configurable:!1,value:i})),i},"object"==typeof e.exports?e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("SUNEDITOR_MODULES a window with a document");return i(e)}:i(t)},8784:function(e){"use strict";var t,i;t="undefined"!=typeof window?window:this,i=function(e,t){const i={name:"dialog",add:function(e){const t=e.context;t.dialog={kind:"",updateModal:!1,_closeSignal:!1};let i=e.util.createElement("DIV");i.className="se-dialog sun-editor-common";let n=e.util.createElement("DIV");n.className="se-dialog-back",n.style.display="none";let s=e.util.createElement("DIV");s.className="se-dialog-inner",s.style.display="none",i.appendChild(n),i.appendChild(s),t.dialog.modalArea=i,t.dialog.back=n,t.dialog.modal=s,t.dialog.modal.addEventListener("mousedown",this._onMouseDown_dialog.bind(e)),t.dialog.modal.addEventListener("click",this._onClick_dialog.bind(e)),t.element.relative.appendChild(i),i=null,n=null,s=null},_onMouseDown_dialog:function(e){/se-dialog-inner/.test(e.target.className)?this.context.dialog._closeSignal=!0:this.context.dialog._closeSignal=!1},_onClick_dialog:function(e){(/close/.test(e.target.getAttribute("data-command"))||this.context.dialog._closeSignal)&&this.plugins.dialog.close.call(this)},open:function(e,t){if(this.modalForm)return!1;this.plugins.dialog._bindClose&&(this._d.removeEventListener("keydown",this.plugins.dialog._bindClose),this.plugins.dialog._bindClose=null),this.plugins.dialog._bindClose=function(e){/27/.test(e.keyCode)&&this.plugins.dialog.close.call(this)}.bind(this),this._d.addEventListener("keydown",this.plugins.dialog._bindClose),this.context.dialog.updateModal=t,"full"===this.options.popupDisplay?this.context.dialog.modalArea.style.position="fixed":this.context.dialog.modalArea.style.position="absolute",this.context.dialog.kind=e,this.modalForm=this.context[e].modal;const i=this.context[e].focusElement;"function"==typeof this.plugins[e].on&&this.plugins[e].on.call(this,t),this.context.dialog.modalArea.style.display="block",this.context.dialog.back.style.display="block",this.context.dialog.modal.style.display="block",this.modalForm.style.display="block",i&&i.focus()},_bindClose:null,close:function(){this.plugins.dialog._bindClose&&(this._d.removeEventListener("keydown",this.plugins.dialog._bindClose),this.plugins.dialog._bindClose=null);const e=this.context.dialog.kind;this.modalForm.style.display="none",this.context.dialog.back.style.display="none",this.context.dialog.modalArea.style.display="none",this.context.dialog.updateModal=!1,"function"==typeof this.plugins[e].init&&this.plugins[e].init.call(this),this.context.dialog.kind="",this.modalForm=null,this.focus()}};return void 0===t&&(e.SUNEDITOR_MODULES||Object.defineProperty(e,"SUNEDITOR_MODULES",{enumerable:!0,writable:!1,configurable:!1,value:{}}),Object.defineProperty(e.SUNEDITOR_MODULES,"dialog",{enumerable:!0,writable:!1,configurable:!1,value:i})),i},"object"==typeof e.exports?e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("SUNEDITOR_MODULES a window with a document");return i(e)}:i(t)},1665:function(e){"use strict";var t,i;t="undefined"!=typeof window?window:this,i=function(e,t){const i={name:"fileBrowser",_xmlHttp:null,_loading:null,add:function(e){const t=e.context;t.fileBrowser={_closeSignal:!1,area:null,header:null,tagArea:null,body:null,list:null,tagElements:null,items:[],selectedTags:[],selectorHandler:null,contextPlugin:"",columnSize:4};let i=e.util.createElement("DIV");i.className="se-file-browser sun-editor-common";let n=e.util.createElement("DIV");n.className="se-file-browser-back";let s=e.util.createElement("DIV");s.className="se-file-browser-inner",s.innerHTML=this.set_browser(e),i.appendChild(n),i.appendChild(s),this._loading=i.querySelector(".se-loading-box"),t.fileBrowser.area=i,t.fileBrowser.header=s.querySelector(".se-file-browser-header"),t.fileBrowser.titleArea=s.querySelector(".se-file-browser-title"),t.fileBrowser.tagArea=s.querySelector(".se-file-browser-tags"),t.fileBrowser.body=s.querySelector(".se-file-browser-body"),t.fileBrowser.list=s.querySelector(".se-file-browser-list"),t.fileBrowser.tagArea.addEventListener("click",this.onClickTag.bind(e)),t.fileBrowser.list.addEventListener("click",this.onClickFile.bind(e)),s.addEventListener("mousedown",this._onMouseDown_browser.bind(e)),s.addEventListener("click",this._onClick_browser.bind(e)),t.element.relative.appendChild(i),i=null,n=null,s=null},set_browser:function(e){return'<div class="se-file-browser-content"><div class="se-file-browser-header"><button type="button" data-command="close" class="se-btn se-file-browser-close" class="close" aria-label="Close" title="'+e.lang.dialogBox.close+'">'+e.icons.cancel+'</button><span class="se-file-browser-title"></span><div class="se-file-browser-tags"></div></div><div class="se-file-browser-body"><div class="se-loading-box sun-editor-common"><div class="se-loading-effect"></div></div><div class="se-file-browser-list"></div></div></div>'},_onMouseDown_browser:function(e){/se-file-browser-inner/.test(e.target.className)?this.context.fileBrowser._closeSignal=!0:this.context.fileBrowser._closeSignal=!1},_onClick_browser:function(e){e.stopPropagation(),(/close/.test(e.target.getAttribute("data-command"))||this.context.fileBrowser._closeSignal)&&this.plugins.fileBrowser.close.call(this)},open:function(e,t){this.plugins.fileBrowser._bindClose&&(this._d.removeEventListener("keydown",this.plugins.fileBrowser._bindClose),this.plugins.fileBrowser._bindClose=null),this.plugins.fileBrowser._bindClose=function(e){/27/.test(e.keyCode)&&this.plugins.fileBrowser.close.call(this)}.bind(this),this._d.addEventListener("keydown",this.plugins.fileBrowser._bindClose);const i=this.context.fileBrowser;i.contextPlugin=e,i.selectorHandler=t;const n=this.context[e],s=n.listClass;this.util.hasClass(i.list,s)||(i.list.className="se-file-browser-list "+s),"full"===this.options.popupDisplay?i.area.style.position="fixed":i.area.style.position="absolute",i.titleArea.textContent=n.title,i.area.style.display="block",this.plugins.fileBrowser._drawFileList.call(this,this.context[e].url,this.context[e].header)},_bindClose:null,close:function(){const e=this.plugins.fileBrowser;e._xmlHttp&&e._xmlHttp.abort(),e._bindClose&&(this._d.removeEventListener("keydown",e._bindClose),e._bindClose=null);const t=this.context.fileBrowser;t.area.style.display="none",t.selectorHandler=null,t.selectedTags=[],t.items=[],t.list.innerHTML=t.tagArea.innerHTML=t.titleArea.textContent="","function"==typeof this.plugins[t.contextPlugin].init&&this.plugins[t.contextPlugin].init.call(this),t.contextPlugin=""},showBrowserLoading:function(){this._loading.style.display="block"},closeBrowserLoading:function(){this._loading.style.display="none"},_drawFileList:function(e,t){const i=this.plugins.fileBrowser,n=i._xmlHttp=this.util.getXMLHttpRequest();if(n.onreadystatechange=i._callBackGet.bind(this,n),n.open("get",e,!0),null!==t&&"object"==typeof t&&this._w.Object.keys(t).length>0)for(let e in t)n.setRequestHeader(e,t[e]);n.send(null),this.plugins.fileBrowser.showBrowserLoading()},_callBackGet:function(e){if(4===e.readyState)if(this.plugins.fileBrowser._xmlHttp=null,200===e.status)try{const t=JSON.parse(e.responseText);t.result.length>0?this.plugins.fileBrowser._drawListItem.call(this,t.result,!0):t.nullMessage&&(this.context.fileBrowser.list.innerHTML=t.nullMessage)}catch(e){throw Error('[SUNEDITOR.fileBrowser.drawList.fail] cause : "'+e.message+'"')}finally{this.plugins.fileBrowser.closeBrowserLoading(),this.context.fileBrowser.body.style.maxHeight=this._w.innerHeight-this.context.fileBrowser.header.offsetHeight-50+"px"}else if(this.plugins.fileBrowser.closeBrowserLoading(),0!==e.status){const t=e.responseText?JSON.parse(e.responseText):e,i="[SUNEDITOR.fileBrowser.get.serverException] status: "+e.status+", response: "+(t.errorMessage||e.responseText);throw Error(i)}},_drawListItem:function(e,t){const i=this.context.fileBrowser,n=this.context[i.contextPlugin],s=[],l=e.length,o=n.columnSize||i.columnSize,a=o<=1?1:Math.round(l/o)||1,r=n.itemTemplateHandler;let u="",c='<div class="se-file-item-column">',d=1;for(let i,n,h=0;h<l;h++)if(i=e[h],n=i.tag?"string"==typeof i.tag?i.tag.split(","):i.tag:[],n=i.tag=n.map((function(e){return e.trim()})),c+=r(i),(h+1)%a==0&&d<o&&h+1<l&&(d++,c+='</div><div class="se-file-item-column">'),t&&n.length>0)for(let e,t=0,i=n.length;t<i;t++)e=n[t],e&&-1===s.indexOf(e)&&(s.push(e),u+='<a title="'+e+'">'+e+"</a>");c+="</div>",i.list.innerHTML=c,t&&(i.items=e,i.tagArea.innerHTML=u,i.tagElements=i.tagArea.querySelectorAll("A"))},onClickTag:function(e){const t=e.target;if(!this.util.isAnchor(t))return;const i=t.textContent,n=this.plugins.fileBrowser,s=this.context.fileBrowser,l=s.tagArea.querySelector('a[title="'+i+'"]'),o=s.selectedTags,a=o.indexOf(i);a>-1?(o.splice(a,1),this.util.removeClass(l,"on")):(o.push(i),this.util.addClass(l,"on")),n._drawListItem.call(this,0===o.length?s.items:s.items.filter((function(e){return e.tag.some((function(e){return o.indexOf(e)>-1}))})),!1)},onClickFile:function(e){e.preventDefault(),e.stopPropagation();const t=this.context.fileBrowser,i=t.list;let n=e.target,s=null;if(n===i)return;for(;i!==n.parentNode&&(s=n.getAttribute("data-command"),!s);)n=n.parentNode;if(!s)return;const l=t.selectorHandler||this.context[t.contextPlugin].selectorHandler;this.plugins.fileBrowser.close.call(this),l(n)}};return void 0===t&&(e.SUNEDITOR_MODULES||Object.defineProperty(e,"SUNEDITOR_MODULES",{enumerable:!0,writable:!1,configurable:!1,value:{}}),Object.defineProperty(e.SUNEDITOR_MODULES,"fileBrowser",{enumerable:!0,writable:!1,configurable:!1,value:i})),i},"object"==typeof e.exports?e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("SUNEDITOR_MODULES a window with a document");return i(e)}:i(t)},2527:function(e){"use strict";var t,i;t="undefined"!=typeof window?window:this,i=function(e,t){const i={name:"fileManager",_xmlHttp:null,_checkMediaComponent:function(e){return!/IMG/i.test(e)||!/FIGURE/i.test(e.parentElement.nodeName)||!/FIGURE/i.test(e.parentElement.parentElement.nodeName)},upload:function(e,t,i,n,s){this.showLoading();const l=this.plugins.fileManager,o=l._xmlHttp=this.util.getXMLHttpRequest();if(o.onreadystatechange=l._callBackUpload.bind(this,o,n,s),o.open("post",e,!0),null!==t&&"object"==typeof t&&this._w.Object.keys(t).length>0)for(let e in t)o.setRequestHeader(e,t[e]);o.send(i)},_callBackUpload:function(e,t,i){if(4===e.readyState)if(200===e.status)try{t(e)}catch(e){throw Error('[SUNEDITOR.fileManager.upload.callBack.fail] cause : "'+e.message+'"')}finally{this.closeLoading()}else{this.closeLoading();const t=e.responseText?JSON.parse(e.responseText):e;if("function"!=typeof i||i("",t,this)){const i="[SUNEDITOR.fileManager.upload.serverException] status: "+e.status+", response: "+(t.errorMessage||e.responseText);throw this.functions.noticeOpen(i),Error(i)}}},checkInfo:function(e,t,i,n,s){let l=[];for(let e=0,i=t.length;e<i;e++)l=l.concat([].slice.call(this.context.element.wysiwyg.querySelectorAll(t[e]+':not([data-se-embed="true"])')));const o=this.plugins.fileManager,a=this.context[e],r=a._infoList,u=o.setInfo.bind(this);if(l.length===r.length){if(this._componentsInfoReset){for(let t=0,n=l.length;t<n;t++)u(e,l[t],i,null,s);return}{let e=!1;for(let t,i=0,n=r.length;i<n;i++)if(t=r[i],0===l.filter((function(e){return t.src===e.src&&t.index.toString()===e.getAttribute("data-index")})).length){e=!0;break}if(!e)return}}const c=s?this.context.resizing._resize_plugin:"";s&&(this.context.resizing._resize_plugin=e);const d=[],h=[];for(let e=0,t=r.length;e<t;e++)h[e]=r[e].index;for(let t,r=0,c=l.length;r<c;r++)t=l[r],this.util.getParentElement(t,this.util.isMediaComponent)&&o._checkMediaComponent(t)?!t.getAttribute("data-index")||h.indexOf(1*t.getAttribute("data-index"))<0?(d.push(a._infoIndex),t.removeAttribute("data-index"),u(e,t,i,null,s)):d.push(1*t.getAttribute("data-index")):(d.push(a._infoIndex),n(t));for(let e,t=0;t<r.length;t++)e=r[t].index,d.indexOf(e)>-1||(r.splice(t,1),"function"==typeof i&&i(null,e,"delete",null,0,this),t--);s&&(this.context.resizing._resize_plugin=c)},setInfo:function(e,t,i,n,s){const l=s?this.context.resizing._resize_plugin:"";s&&(this.context.resizing._resize_plugin=e);const o=this.plugins[e],a=this.context[e],r=a._infoList;let u=t.getAttribute("data-index"),c=null,d="";if(n||(n={name:t.getAttribute("data-file-name")||("string"==typeof t.src?t.src.split("/").pop():""),size:t.getAttribute("data-file-size")||0}),!u||this._componentsInfoInit)d="create",u=a._infoIndex++,t.setAttribute("data-index",u),t.setAttribute("data-file-name",n.name),t.setAttribute("data-file-size",n.size),c={src:t.src,index:1*u,name:n.name,size:n.size},r.push(c);else{d="update",u*=1;for(let e=0,t=r.length;e<t;e++)if(u===r[e].index){c=r[e];break}c||(u=a._infoIndex++,c={index:u},r.push(c)),c.src=t.src,c.name=t.getAttribute("data-file-name"),c.size=1*t.getAttribute("data-file-size")}if(c.element=t,c.delete=o.destroy.bind(this,t),c.select=function(e){e.scrollIntoView(!0),this._w.setTimeout(o.select.bind(this,e))}.bind(this,t),s){if(!t.getAttribute("origin-size")&&t.naturalWidth&&t.setAttribute("origin-size",t.naturalWidth+","+t.naturalHeight),!t.getAttribute("data-origin")){const e=this.util.getParentElement(t,this.util.isMediaComponent),i=this.util.getParentElement(t,"FIGURE"),n=this.plugins.resizing._module_getSizeX.call(this,a,t,i,e),s=this.plugins.resizing._module_getSizeY.call(this,a,t,i,e);t.setAttribute("data-origin",n+","+s),t.setAttribute("data-size",n+","+s)}if(!t.style.width){const e=(t.getAttribute("data-size")||t.getAttribute("data-origin")||"").split(",");o.onModifyMode.call(this,t,null),o.applySize.call(this,e[0],e[1])}this.context.resizing._resize_plugin=l}"function"==typeof i&&i(t,u,d,c,--a._uploadFileLength<0?0:a._uploadFileLength,this)},deleteInfo:function(e,t,i){if(t>=0){const n=this.context[e]._infoList;for(let e=0,s=n.length;e<s;e++)if(t===n[e].index)return n.splice(e,1),void("function"==typeof i&&i(null,t,"delete",null,0,this))}},resetInfo:function(e,t){const i=this.context[e];if("function"==typeof t){const e=i._infoList;for(let i=0,n=e.length;i<n;i++)t(null,e[i].index,"delete",null,0,this)}i._infoList=[],i._infoIndex=0}};return void 0===t&&(e.SUNEDITOR_MODULES||Object.defineProperty(e,"SUNEDITOR_MODULES",{enumerable:!0,writable:!1,configurable:!1,value:{}}),Object.defineProperty(e.SUNEDITOR_MODULES,"fileManager",{enumerable:!0,writable:!1,configurable:!1,value:i})),i},"object"==typeof e.exports?e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("SUNEDITOR_MODULES a window with a document");return i(e)}:i(t)},5076:function(e){"use strict";var t,i;t="undefined"!=typeof window?window:this,i=function(e,t){const i={name:"resizing",add:function(e){const t=e.icons,i=e.context;i.resizing={_resizeClientX:0,_resizeClientY:0,_resize_plugin:"",_resize_w:0,_resize_h:0,_origin_w:0,_origin_h:0,_rotateVertical:!1,_resize_direction:"",_move_path:null,_isChange:!1,alignIcons:{basic:t.align_justify,left:t.align_left,right:t.align_right,center:t.align_center}};let n=this.setController_resize(e);i.resizing.resizeContainer=n,i.resizing.resizeDiv=n.querySelector(".se-modal-resize"),i.resizing.resizeDot=n.querySelector(".se-resize-dot"),i.resizing.resizeDisplay=n.querySelector(".se-resize-display");let s=this.setController_button(e);i.resizing.resizeButton=s;let l=i.resizing.resizeHandles=i.resizing.resizeDot.querySelectorAll("span");i.resizing.resizeButtonGroup=s.querySelector("._se_resizing_btn_group"),i.resizing.rotationButtons=s.querySelectorAll("._se_resizing_btn_group ._se_rotation"),i.resizing.percentageButtons=s.querySelectorAll("._se_resizing_btn_group ._se_percentage"),i.resizing.alignMenu=s.querySelector(".se-resizing-align-list"),i.resizing.alignMenuList=i.resizing.alignMenu.querySelectorAll("button"),i.resizing.alignButton=s.querySelector("._se_resizing_align_button"),i.resizing.autoSizeButton=s.querySelector("._se_resizing_btn_group ._se_auto_size"),i.resizing.captionButton=s.querySelector("._se_resizing_caption_button"),n.addEventListener("mousedown",(function(e){e.preventDefault()})),l[0].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[1].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[2].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[3].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[4].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[5].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[6].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[7].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),s.addEventListener("click",this.onClick_resizeButton.bind(e)),i.element.relative.appendChild(n),i.element.relative.appendChild(s),n=null,s=null,l=null},setController_resize:function(e){const t=e.util.createElement("DIV");return t.className="se-controller se-resizing-container",t.style.display="none",t.innerHTML='<div class="se-modal-resize"></div><div class="se-resize-dot"><span class="tl"></span><span class="tr"></span><span class="bl"></span><span class="br"></span><span class="lw"></span><span class="th"></span><span class="rw"></span><span class="bh"></span><div class="se-resize-display"></div></div>',t},setController_button:function(e){const t=e.lang,i=e.icons,n=e.util.createElement("DIV");return n.className="se-controller se-controller-resizing",n.innerHTML='<div class="se-arrow se-arrow-up"></div><div class="se-btn-group _se_resizing_btn_group"><button type="button" data-command="percent" data-value="1" class="se-tooltip _se_percentage"><span>100%</span><span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.resize100+'</span></span></button><button type="button" data-command="percent" data-value="0.75" class="se-tooltip _se_percentage"><span>75%</span><span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.resize75+'</span></span></button><button type="button" data-command="percent" data-value="0.5" class="se-tooltip _se_percentage"><span>50%</span><span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.resize50+'</span></span></button><button type="button" data-command="auto" class="se-btn se-tooltip _se_auto_size">'+i.auto_size+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.autoSize+'</span></span></button><button type="button" data-command="rotate" data-value="-90" class="se-btn se-tooltip _se_rotation">'+i.rotate_left+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.rotateLeft+'</span></span></button><button type="button" data-command="rotate" data-value="90" class="se-btn se-tooltip _se_rotation">'+i.rotate_right+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.rotateRight+'</span></span></button></div><div class="se-btn-group" style="padding-top: 0;"><button type="button" data-command="mirror" data-value="h" class="se-btn se-tooltip">'+i.mirror_horizontal+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.mirrorHorizontal+'</span></span></button><button type="button" data-command="mirror" data-value="v" class="se-btn se-tooltip">'+i.mirror_vertical+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.mirrorVertical+'</span></span></button><button type="button" data-command="onalign" class="se-btn se-tooltip _se_resizing_align_button">'+i.align_justify+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.toolbar.align+'</span></span></button><div class="se-btn-group-sub sun-editor-common se-list-layer se-resizing-align-list"><div class="se-list-inner"><ul class="se-list-basic"><li><button type="button" class="se-btn-list se-tooltip" data-command="align" data-value="basic">'+i.align_justify+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.dialogBox.basic+'</span></span></button></li><li><button type="button" class="se-btn-list se-tooltip" data-command="align" data-value="left">'+i.align_left+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.dialogBox.left+'</span></span></button></li><li><button type="button" class="se-btn-list se-tooltip" data-command="align" data-value="center">'+i.align_center+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.dialogBox.center+'</span></span></button></li><li><button type="button" class="se-btn-list se-tooltip" data-command="align" data-value="right">'+i.align_right+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.dialogBox.right+'</span></span></button></li></ul></div></div><button type="button" data-command="caption" class="se-btn se-tooltip _se_resizing_caption_button">'+i.caption+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.dialogBox.caption+'</span></span></button><button type="button" data-command="revert" class="se-btn se-tooltip">'+i.revert+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.dialogBox.revertButton+'</span></span></button><button type="button" data-command="update" class="se-btn se-tooltip">'+i.modify+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.edit+'</span></span></button><button type="button" data-command="delete" class="se-btn se-tooltip">'+i.delete+'<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.controller.remove+"</span></span></button></div>",n},_module_getSizeX:function(e,t,i,n){return t||(t=e._element),i||(i=e._cover),n||(n=e._container),t?/%$/.test(t.style.width)?(n&&this.util.getNumber(n.style.width,2)||100)+"%":t.style.width:""},_module_getSizeY:function(e,t,i,n){return t||(t=e._element),i||(i=e._cover),n||(n=e._container),n&&i?this.util.getNumber(i.style.paddingBottom,0)>0&&!this.context.resizing._rotateVertical?i.style.height:/%$/.test(t.style.height)&&/%$/.test(t.style.width)?(n&&this.util.getNumber(n.style.height,2)||100)+"%":t.style.height:t&&t.style.height||""},_module_setModifyInputSize:function(e,t){const i=e._onlyPercentage&&this.context.resizing._rotateVertical;e.proportion.checked=e._proportionChecked="false"!==e._element.getAttribute("data-proportion");let n=i?"":this.plugins.resizing._module_getSizeX.call(this,e);if(n===e._defaultSizeX&&(n=""),e._onlyPercentage&&(n=this.util.getNumber(n,2)),e.inputX.value=n,t.setInputSize.call(this,"x"),!e._onlyPercentage){let t=i?"":this.plugins.resizing._module_getSizeY.call(this,e);t===e._defaultSizeY&&(t=""),e._onlyPercentage&&(t=this.util.getNumber(t,2)),e.inputY.value=t}e.inputX.disabled=!!i,e.inputY.disabled=!!i,e.proportion.disabled=!!i,t.setRatio.call(this)},_module_setInputSize:function(e,t){if(e._onlyPercentage)"x"===t&&e.inputX.value>100&&(e.inputX.value=100);else if(e.proportion.checked&&e._ratio&&/\d/.test(e.inputX.value)&&/\d/.test(e.inputY.value)){const i=e.inputX.value.replace(/\d+|\./g,"")||e.sizeUnit,n=e.inputY.value.replace(/\d+|\./g,"")||e.sizeUnit;if(i!==n)return;const s="%"===i?2:0;"x"===t?e.inputY.value=this.util.getNumber(e._ratioY*this.util.getNumber(e.inputX.value,s),s)+n:e.inputX.value=this.util.getNumber(e._ratioX*this.util.getNumber(e.inputY.value,s),s)+i}},_module_setRatio:function(e){const t=e.inputX.value,i=e.inputY.value;if(e.proportion.checked&&/\d+/.test(t)&&/\d+/.test(i)){if((t.replace(/\d+|\./g,"")||e.sizeUnit)!==(i.replace(/\d+|\./g,"")||e.sizeUnit))e._ratio=!1;else if(!e._ratio){const n=this.util.getNumber(t,0),s=this.util.getNumber(i,0);e._ratio=!0,e._ratioX=n/s,e._ratioY=s/n}}else e._ratio=!1},_module_sizeRevert:function(e){e._onlyPercentage?e.inputX.value=e._origin_w>100?100:e._origin_w:(e.inputX.value=e._origin_w,e.inputY.value=e._origin_h)},_module_saveCurrentSize:function(e){const t=this.plugins.resizing._module_getSizeX.call(this,e),i=this.plugins.resizing._module_getSizeY.call(this,e);e._element.setAttribute("data-size",t+","+i),e._videoRatio&&(e._videoRatio=i)},call_controller_resize:function(e,t){const i=this.context.resizing,n=this.context[t];i._resize_plugin=t;const s=i.resizeContainer,l=i.resizeDiv,o=this.util.getOffset(e,this.context.element.wysiwygFrame),a=i._rotateVertical=/^(90|270)$/.test(Math.abs(e.getAttribute("data-rotate")).toString()),r=a?e.offsetHeight:e.offsetWidth,u=a?e.offsetWidth:e.offsetHeight,c=o.top,d=o.left-this.context.element.wysiwygFrame.scrollLeft;s.style.top=c+"px",s.style.left=d+"px",s.style.width=r+"px",s.style.height=u+"px",l.style.top="0px",l.style.left="0px",l.style.width=r+"px",l.style.height=u+"px";let h=e.getAttribute("data-align")||"basic";h="none"===h?"basic":h;const p=this.util.getParentElement(e,this.util.isComponent),f=this.util.getParentElement(e,"FIGURE"),g=this.plugins.resizing._module_getSizeX.call(this,n,e,f,p)||"auto",m=n._onlyPercentage&&"image"===t?"":", "+(this.plugins.resizing._module_getSizeY.call(this,n,e,f,p)||"auto");this.util.changeTxt(i.resizeDisplay,this.lang.dialogBox[h]+" ("+g+m+")"),i.resizeButtonGroup.style.display=n._resizing?"":"none";const v=!n._resizing||n._resizeDotHide||n._onlyPercentage?"none":"flex",b=i.resizeHandles;for(let e=0,t=b.length;e<t;e++)b[e].style.display=v;if(n._resizing){const e=i.rotationButtons;e[0].style.display=e[1].style.display=n._rotation?"":"none"}if(n._alignHide)i.alignButton.style.display="none";else{i.alignButton.style.display="";const e=i.alignMenuList;this.util.changeElement(i.alignButton.firstElementChild,i.alignIcons[h]);for(let t=0,i=e.length;t<i;t++)e[t].getAttribute("data-value")===h?this.util.addClass(e[t],"on"):this.util.removeClass(e[t],"on")}const _=i.percentageButtons,y=/%$/.test(e.style.width)&&/%$/.test(p.style.width)?this.util.getNumber(p.style.width,0)/100+"":"";for(let e=0,t=_.length;e<t;e++)_[e].getAttribute("data-value")===y?this.util.addClass(_[e],"active"):this.util.removeClass(_[e],"active");n._captionShow?(i.captionButton.style.display="",this.util.getChildElement(e.parentNode,"figcaption")?(this.util.addClass(i.captionButton,"active"),n._captionChecked=!0):(this.util.removeClass(i.captionButton,"active"),n._captionChecked=!1)):i.captionButton.style.display="none",s.style.display="block";const x={left:0,top:50};this.options.iframe&&(x.left-=this.context.element.wysiwygFrame.parentElement.offsetLeft,x.top-=this.context.element.wysiwygFrame.parentElement.offsetTop),this.setControllerPosition(i.resizeButton,s,"bottom",x),this.controllersOn(s,i.resizeButton,this.util.setDisabledButtons.bind(this.util,!1,this.resizingDisabledButtons),e,t),this.util.setDisabledButtons(!0,this.resizingDisabledButtons),i._resize_w=r,i._resize_h=u;const w=(e.getAttribute("origin-size")||"").split(",");return i._origin_w=w[0]||e.naturalWidth,i._origin_h=w[1]||e.naturalHeight,{w:r,h:u,t:c,l:d}},_closeAlignMenu:null,openAlignMenu:function(){const e=this.context.resizing.alignButton;this.util.addClass(e,"on"),this.context.resizing.alignMenu.style.top=e.offsetTop+e.offsetHeight+"px",this.context.resizing.alignMenu.style.left=e.offsetLeft-e.offsetWidth/2+"px",this.context.resizing.alignMenu.style.display="block",this.plugins.resizing._closeAlignMenu=function(){this.util.removeClass(this.context.resizing.alignButton,"on"),this.context.resizing.alignMenu.style.display="none",this.removeDocEvent("click",this.plugins.resizing._closeAlignMenu),this.plugins.resizing._closeAlignMenu=null}.bind(this),this.addDocEvent("click",this.plugins.resizing._closeAlignMenu)},onClick_resizeButton:function(e){e.stopPropagation();const t=e.target,i=t.getAttribute("data-command")||t.parentNode.getAttribute("data-command");if(!i)return;const n=t.getAttribute("data-value")||t.parentNode.getAttribute("data-value"),s=this.context.resizing._resize_plugin,l=this.context[s],o=l._element,a=this.plugins[s];if(e.preventDefault(),"function"!=typeof this.plugins.resizing._closeAlignMenu||(this.plugins.resizing._closeAlignMenu(),"onalign"!==i)){switch(i){case"auto":this.plugins.resizing.resetTransform.call(this,o),a.setAutoSize.call(this),this.selectComponent(o,s);break;case"percent":let e=this.plugins.resizing._module_getSizeY.call(this,l);if(this.context.resizing._rotateVertical){const t=o.getAttribute("data-percentage");t&&(e=t.split(",")[1])}this.plugins.resizing.resetTransform.call(this,o),a.setPercentSize.call(this,100*n,null!==this.util.getNumber(e,0)&&/%$/.test(e)?e:""),this.selectComponent(o,s);break;case"mirror":const t=o.getAttribute("data-rotate")||"0";let i=o.getAttribute("data-rotateX")||"",r=o.getAttribute("data-rotateY")||"";"h"===n&&!this.context.resizing._rotateVertical||"v"===n&&this.context.resizing._rotateVertical?r=r?"":"180":i=i?"":"180",o.setAttribute("data-rotateX",i),o.setAttribute("data-rotateY",r),this.plugins.resizing._setTransForm(o,t,i,r);break;case"rotate":const u=this.context.resizing,c=1*o.getAttribute("data-rotate")+1*n,d=this._w.Math.abs(c)>=360?0:c;o.setAttribute("data-rotate",d),u._rotateVertical=/^(90|270)$/.test(this._w.Math.abs(d).toString()),this.plugins.resizing.setTransformSize.call(this,o,null,null),this.selectComponent(o,s);break;case"onalign":return void this.plugins.resizing.openAlignMenu.call(this);case"align":const h="basic"===n?"none":n;a.setAlign.call(this,h,null,null,null),this.selectComponent(o,s);break;case"caption":const p=!l._captionChecked;if(a.openModify.call(this,!0),l._captionChecked=l.captionCheckEl.checked=p,a.update_image.call(this,!1,!1,!1),p){const e=this.util.getChildElement(l._caption,(function(e){return 3===e.nodeType}));e?this.setRange(e,0,e,e.textContent.length):l._caption.focus(),this.controllersOff()}else this.selectComponent(o,s),a.openModify.call(this,!0);break;case"revert":a.setOriginSize.call(this),this.selectComponent(o,s);break;case"update":a.openModify.call(this),this.controllersOff();break;case"delete":a.destroy.call(this)}this.history.push(!1)}},resetTransform:function(e){const t=(e.getAttribute("data-size")||e.getAttribute("data-origin")||"").split(",");this.context.resizing._rotateVertical=!1,e.style.maxWidth="",e.style.transform="",e.style.transformOrigin="",e.setAttribute("data-rotate",""),e.setAttribute("data-rotateX",""),e.setAttribute("data-rotateY",""),this.plugins[this.context.resizing._resize_plugin].setSize.call(this,t[0]?t[0]:"auto",t[1]?t[1]:"",!0)},setTransformSize:function(e,t,i){let n=e.getAttribute("data-percentage");const s=this.context.resizing._rotateVertical,l=1*e.getAttribute("data-rotate");let o="";if(n&&!s)n=n.split(","),"auto"===n[0]&&"auto"===n[1]?this.plugins[this.context.resizing._resize_plugin].setAutoSize.call(this):this.plugins[this.context.resizing._resize_plugin].setPercentSize.call(this,n[0],n[1]);else{const n=this.util.getParentElement(e,"FIGURE"),a=t||e.offsetWidth,r=i||e.offsetHeight,u=(s?r:a)+"px",c=(s?a:r)+"px";if(this.plugins[this.context.resizing._resize_plugin].cancelPercentAttr.call(this),this.plugins[this.context.resizing._resize_plugin].setSize.call(this,a+"px",r+"px",!0),n.style.width=u,n.style.height=this.context[this.context.resizing._resize_plugin]._caption?"":c,s){let e=a/2+"px "+a/2+"px 0",t=r/2+"px "+r/2+"px 0";o=90===l||-270===l?t:e}}e.style.transformOrigin=o,this.plugins.resizing._setTransForm(e,l.toString(),e.getAttribute("data-rotateX")||"",e.getAttribute("data-rotateY")||""),e.style.maxWidth=s?"none":"",this.plugins.resizing.setCaptionPosition.call(this,e)},_setTransForm:function(e,t,i,n){let s=(e.offsetWidth-e.offsetHeight)*(/-/.test(t)?1:-1),l="";if(/[1-9]/.test(t)&&(i||n))switch(l=i?"Y":"X",t){case"90":l=i&&n?"X":n?l:"";break;case"270":s*=-1,l=i&&n?"Y":i?l:"";break;case"-90":l=i&&n?"Y":i?l:"";break;case"-270":s*=-1,l=i&&n?"X":n?l:"";break;default:l=""}t%180==0&&(e.style.maxWidth=""),e.style.transform="rotate("+t+"deg)"+(i?" rotateX("+i+"deg)":"")+(n?" rotateY("+n+"deg)":"")+(l?" translate"+l+"("+s+"px)":"")},setCaptionPosition:function(e){const t=this.util.getChildElement(this.util.getParentElement(e,"FIGURE"),"FIGCAPTION");t&&(t.style.marginTop=(this.context.resizing._rotateVertical?e.offsetWidth-e.offsetHeight:0)+"px")},onMouseDown_resize_handle:function(e){e.stopPropagation(),e.preventDefault();const t=this.context.resizing,i=t._resize_direction=e.target.classList[0];t._resizeClientX=e.clientX,t._resizeClientY=e.clientY,this.context.element.resizeBackground.style.display="block",t.resizeButton.style.display="none",t.resizeDiv.style.float=/l/.test(i)?"right":/r/.test(i)?"left":"none";const n=function(e){if("keydown"===e.type&&27!==e.keyCode)return;const l=t._isChange;t._isChange=!1,this.removeDocEvent("mousemove",s),this.removeDocEvent("mouseup",n),this.removeDocEvent("keydown",n),"keydown"===e.type?(this.controllersOff(),this.context.element.resizeBackground.style.display="none",this.plugins[this.context.resizing._resize_plugin].init.call(this)):(this.plugins.resizing.cancel_controller_resize.call(this,i),l&&this.history.push(!1))}.bind(this),s=this.plugins.resizing.resizing_element.bind(this,t,i,this.context[t._resize_plugin]);this.addDocEvent("mousemove",s),this.addDocEvent("mouseup",n),this.addDocEvent("keydown",n)},resizing_element:function(e,t,i,n){const s=n.clientX,l=n.clientY;let o=i._element_w,a=i._element_h;const r=i._element_w+(/r/.test(t)?s-e._resizeClientX:e._resizeClientX-s),u=i._element_h+(/b/.test(t)?l-e._resizeClientY:e._resizeClientY-l),c=i._element_h/i._element_w*r;/t/.test(t)&&(e.resizeDiv.style.top=i._element_h-(/h/.test(t)?u:c)+"px"),/l/.test(t)&&(e.resizeDiv.style.left=i._element_w-r+"px"),/r|l/.test(t)&&(e.resizeDiv.style.width=r+"px",o=r),/^(t|b)[^h]$/.test(t)?(e.resizeDiv.style.height=c+"px",a=c):/^(t|b)h$/.test(t)&&(e.resizeDiv.style.height=u+"px",a=u),e._resize_w=o,e._resize_h=a,this.util.changeTxt(e.resizeDisplay,this._w.Math.round(o)+" x "+this._w.Math.round(a)),e._isChange=!0},cancel_controller_resize:function(e){const t=this.context.resizing._rotateVertical;this.controllersOff(),this.context.element.resizeBackground.style.display="none";let i=this._w.Math.round(t?this.context.resizing._resize_h:this.context.resizing._resize_w),n=this._w.Math.round(t?this.context.resizing._resize_w:this.context.resizing._resize_h);if(!t&&!/%$/.test(i)){const e=16,t=this.context.element.wysiwygFrame.clientWidth-2*e-2;this.util.getNumber(i,0)>t&&(n=this._w.Math.round(n/i*t),i=t)}const s=this.context.resizing._resize_plugin;this.plugins[s].setSize.call(this,i,n,!1,e),t&&this.plugins.resizing.setTransformSize.call(this,this.context[this.context.resizing._resize_plugin]._element,i,n),this.selectComponent(this.context[s]._element,s)}};return void 0===t&&(e.SUNEDITOR_MODULES||Object.defineProperty(e,"SUNEDITOR_MODULES",{enumerable:!0,writable:!1,configurable:!1,value:{}}),Object.defineProperty(e.SUNEDITOR_MODULES,"resizing",{enumerable:!0,writable:!1,configurable:!1,value:i})),i},"object"==typeof e.exports?e.exports=t.document?i(t,!0):function(e){if(!e.document)throw new Error("SUNEDITOR_MODULES a window with a document");return i(e)}:i(t)},6800:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var n=i(821),s={class:"v-listing"},l=[(0,n.uE)('<div class="listing row row-cols-5 w-100 align-items-center"><div class="col"><button class="listing__to-first-page"><span class="material-icons">first_page</span></button></div><div class="col"><button class="listing__to-perv-page"><span class="material-icons">navigate_before</span></button></div><div class="col"><p class="listing__page-number">1</p></div><div class="col"><button class="listing__to-next-page"><span class="material-icons">navigate_next</span></button></div><div class="col"><button class="listing__to-last-page"><span class="material-icons">last_page</span></button></div></div>',1)];const o={name:"v-listing"};var a=i(3379),r=i.n(a),u=i(5278),c={insert:"head",singleton:!1};r()(u.Z,c);u.Z.locals;const d=(0,i(3744).Z)(o,[["render",function(e,t,i,o,a,r){return(0,n.wg)(),(0,n.iD)("div",s,l)}]])},8560:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>xe});var n=i(821),s={class:"container"},l=["action"],o=["value"],a={class:"row"},r={class:"main_info d-flex justify-content-between"},u={class:"card__img-content col-3"},c=["src"],d=(0,n._)("input",{type:"file",style:{"font-size":"10px","margin-top":"20px"},id:"img",name:"img",accept:"image/png"},null,-1),h={class:"col-5 card__text"},p=(0,n.Uk)("Краткое описание"),f={class:"w-100",id:"short_text",name:"short_text",rows:"2"},g=(0,n._)("br",null,null,-1),m={class:"card__price-and-buy-button d-flex flex-column col-4 align-items-end"},v={class:"row mb-5"},b=(0,n._)("label",{for:"price",class:"col-3"},"Цена:",-1),_={class:"col-6"},y=["value"],x=(0,n._)("label",{for:"price",class:"col-2"},"руб",-1),w={class:"row"},k=(0,n._)("label",{for:"count",class:"col-4",style:{}},"Количество:",-1),C={class:"col-5"},A=["value"],E=(0,n._)("label",{for:"count",class:"col-1"},"шт",-1),S=(0,n._)("button",{type:"submit",class:"card__edit-button btn"},"Редактировать",-1),P={class:"mt-2"},z=(0,n.Uk)("Полное описание"),L={class:"w-100",id:"full_text",name:"full_text"},M={class:"card__specs row"},O={class:"card__name-specs col-6 d-flex flex-column"},R=(0,n._)("strong",{class:"mb-2"},[(0,n._)("label",{for:"brand"},"Бренд")],-1),T=(0,n._)("strong",{class:"mb-2"},[(0,n._)("label",{for:"type"},"Тип")],-1),I=["for"],N=(0,n._)("strong",{class:"mb-2"},[(0,n._)("label",{for:"made_in"},"Страна производитель")],-1),B={class:"card__name-specs col-6 d-flex flex-column"},D={class:"mb-2 input"},F=["value"],U={class:"mb-2 input"},j=["value"],H=["id","name","onUpdate:modelValue"],V={class:"mb-2 input"},W=(0,n._)("input",{type:"file",style:{"font-size":"10px","margin-bottom":"20px"},id:"audio",name:"audio",accept:".mp3"},null,-1),q={key:0},Y={class:"row align-items-center"},X=[(0,n._)("span",{class:"material-icons",id:"playButton"},"play_arrow",-1)],$={class:"col-11"};var G=i(7757),Z=i.n(G),Q=i(9669),K=i.n(Q),J=(i(1796),i(9518)),ee=i(6012),te=i(4170),ie={class:"v-review"},ne={class:"review row"},se={class:"review__name d-flex"},le={class:"material-icons review__stars"},oe={class:"review__date"},ae={class:"review__comment"},re=(0,n._)("div",{class:"horizontal-line"},null,-1);const ue={name:"v-review",props:["name","score","text","date","data"],methods:{deleteReview:function(){K().delete("/api/delete_review/"+this.data.id).then((function(){$router.redirect(window.location.pathname)}))}}};var ce=i(3379),de=i.n(ce),he=i(1804),pe={insert:"head",singleton:!1};de()(he.Z,pe);he.Z.locals;var fe=i(3744);const ge=(0,fe.Z)(ue,[["render",function(e,t,i,s,l,o){return(0,n.wg)(),(0,n.iD)("div",ie,[(0,n._)("div",ne,[(0,n._)("div",se,[(0,n.Uk)((0,n.zw)(i.name)+" ",1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Number(i.score),(function(e){return(0,n.wg)(),(0,n.iD)("span",le,"star")})),256)),(0,n._)("a",{onClick:t[0]||(t[0]=function(){return o.deleteReview&&o.deleteReview.apply(o,arguments)})},"Удалить"),(0,n._)("div",oe,(0,n.zw)(i.date),1)]),(0,n._)("p",ae,(0,n.zw)(i.text),1)]),re])}]]);var me=i(6800);function ve(e,t,i,n,s,l,o){try{var a=e[l](o),r=a.value}catch(e){return void i(e)}a.done?t(r):Promise.resolve(r).then(n,s)}const be={name:"EditProduct",components:{vSeparation:i(6409).Z,vListing:me.Z,VueWaveSurfer:te.Z,vReview:ge},data:function(){return{csrf:document.querySelector('meta[name="csrf-token"]').getAttribute("content"),info:{},brands:[],types:[],specs:[],reviewData:[],specs_name:[],isPlayed:!1,isMounted:!1,waveSurfer:{},waveOptions:{backgroundColor:"#FFF",mediaControls:!0,waveColor:"rgba(255,153,0,0.4)",progressColor:"#FF9900FF",height:"60",fillParent:!0,scrollParent:!1}}},methods:{playCall:function(){this.$refs.wavsur.waveSurfer.setVolume(.2),this.$refs.wavsur.waveSurfer.playPause()},changeButton:function(){var e=document.getElementById("playButton");!1===this.isPlayed?(this.isPlayed=!0,e.textContent="pause"):(this.isPlayed=!1,e.textContent="play_arrow")},onClick:function(){this.playCall(),this.changeButton()}},beforeMount:function(){var e,t=this;return(e=Z().mark((function e(){var i,n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t,e.next=3,K().get("/api"+window.location.pathname.replace("/admin","")).then((function(e){i.info=e.data[0],i.specs_name=e.data[1],i.specs=e.data[2]}));case 3:K().get("/api"+window.location.pathname.replace("/admin","")+"/get_reviews").then((function(e){i.reviewData=e.data,console.log(i.reviewData[0].date)})),t.isMounted=!0,K().get("/api"+window.location.pathname+"/get-types").then((function(e){i.types=e.data})),K().get("/api"+window.location.pathname+"/get-brands").then((function(e){i.brands=e.data})),(n=J.Z.create("full_text",{plugins:ee.ZP,buttonList:[["undo","redo"],["font","fontSize","formatBlock"],["paragraphStyle","blockquote"],["bold","underline","italic","strike","subscript","superscript"],["removeFormat"],"/",["outdent","indent"],["align","horizontalRule","list","lineHeight"],["link","image","video"]]})).onChange=function(){n.save()};case 9:case"end":return e.stop()}}),e)})),function(){var t=this,i=arguments;return new Promise((function(n,s){var l=e.apply(t,i);function o(e){ve(l,n,s,o,a,"next",e)}function a(e){ve(l,n,s,o,a,"throw",e)}o(void 0)}))})()}};var _e=i(6445),ye={insert:"head",singleton:!1};de()(_e.Z,ye);_e.Z.locals;const xe=(0,fe.Z)(be,[["render",function(e,t,i,G,Z,Q){var K=(0,n.up)("v-separation"),J=(0,n.up)("lable"),ee=(0,n.up)("vue-wave-surfer"),te=(0,n.up)("v-review");return(0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("form",{method:"post",action:"/api/edit-product/"+encodeURIComponent(Z.info.name),enctype:"multipart/form-data"},[(0,n._)("input",{type:"hidden",name:"_token",value:Z.csrf},null,8,o),(0,n.Wm)(K,{title:"Редактировать "+Z.info.name},null,8,["title"]),(0,n._)("div",null,[(0,n._)("div",a,[(0,n._)("div",r,[(0,n._)("div",u,[(0,n._)("img",{class:"card__img",src:"/uploads/img/"+Z.info.img_file},null,8,c),d]),(0,n._)("div",h,[(0,n.Wm)(J,{for:"short_text"},{default:(0,n.w5)((function(){return[p]})),_:1}),(0,n._)("textarea",f,(0,n.zw)(Z.info.short_text),1),g]),(0,n._)("div",m,[(0,n._)("div",v,[b,(0,n._)("div",_,[(0,n._)("input",{type:"number",id:"price",name:"price",value:Z.info.price,size:"9"},null,8,y)]),x]),(0,n._)("div",w,[k,(0,n._)("div",C,[(0,n._)("input",{type:"number",id:"count",name:"count",value:Z.info.is_available,size:"9"},null,8,A)]),E]),S])])]),(0,n._)("div",P,[(0,n.Wm)(J,{for:"full_text"},{default:(0,n.w5)((function(){return[z]})),_:1}),(0,n._)("textarea",L,(0,n.zw)(Z.info.full_text),1)])]),(0,n.Wm)(K,{title:"Характеристики"}),(0,n._)("div",M,[(0,n._)("div",O,[R,T,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Z.specs_name,(function(e){return(0,n.wg)(),(0,n.iD)("strong",{class:"mb-2",key:e.id},[(0,n._)("label",{for:e.count_spec},(0,n.zw)(e.name),9,I)])})),128)),N]),(0,n._)("div",B,[(0,n._)("div",D,[(0,n.wy)((0,n._)("select",{id:"brand",name:"brand","onUpdate:modelValue":t[0]||(t[0]=function(e){return Z.specs.brand=e})},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Z.brands,(function(e){return(0,n.wg)(),(0,n.iD)("option",{value:e},(0,n.zw)(e),9,F)})),256))],512),[[n.bM,Z.specs.brand]])]),(0,n._)("div",U,[(0,n.wy)((0,n._)("select",{id:"type",name:"type","onUpdate:modelValue":t[1]||(t[1]=function(e){return Z.specs.type=e})},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Z.types,(function(e){return(0,n.wg)(),(0,n.iD)("option",{value:e.text},(0,n.zw)(e.text),9,j)})),256))],512),[[n.bM,Z.specs.type]])]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Z.specs_name,(function(e){return(0,n.wg)(),(0,n.iD)("div",{class:"mb-2 input",key:e.id},[(0,n.wy)((0,n._)("input",{type:"text",id:e.count_spec,name:e.count_spec,size:"18","onUpdate:modelValue":function(t){return Z.specs[e.count_spec]=t}},null,8,H),[[n.nr,Z.specs[e.count_spec]]])])})),128)),(0,n._)("div",V,[(0,n.wy)((0,n._)("input",{type:"text",id:"made_in",name:"made_in",size:"18","onUpdate:modelValue":t[2]||(t[2]=function(e){return Z.specs.made_in=e})},null,512),[[n.nr,Z.specs.made_in]])])])]),(0,n.Wm)(K,{title:"Звучание инструмента"}),W],8,l),null!=Z.info.sound_file?((0,n.wg)(),(0,n.iD)("div",q,[(0,n._)("div",Y,[(0,n._)("button",{class:"play col-1",onClick:t[3]||(t[3]=function(){return Q.onClick&&Q.onClick.apply(Q,arguments)})},X),(0,n._)("div",$,[Z.isMounted?((0,n.wg)(),(0,n.j4)(ee,{key:0,src:"/uploads/audio/"+Z.info.sound_file,options:Z.waveOptions,ref:"wavsur"},null,8,["src","options"])):(0,n.kq)("",!0)])])])):(0,n.kq)("",!0),(0,n.Wm)(K,{title:"Отзывы"}),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Z.reviewData,(function(e){return(0,n.wg)(),(0,n.j4)(te,{name:e.user_name,score:e.score,date:e.date,text:e.text,data:e},null,8,["name","score","date","text","data"])})),256))])}]])},1796:e=>{var t;self,t=function(){return e={"./src/drawer.canvasentry.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(i("./src/util/style.js")),s=l(i("./src/util/get-id.js"));function l(e){return e&&e.__esModule?e:{default:e}}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wave=null,this.waveCtx=null,this.progress=null,this.progressCtx=null,this.start=0,this.end=1,this.id=(0,s.default)(void 0!==this.constructor.name?this.constructor.name.toLowerCase()+"_":"canvasentry_"),this.canvasContextAttributes={}}var t,i,l;return t=e,(i=[{key:"initWave",value:function(e){this.wave=e,this.waveCtx=this.wave.getContext("2d",this.canvasContextAttributes)}},{key:"initProgress",value:function(e){this.progress=e,this.progressCtx=this.progress.getContext("2d",this.canvasContextAttributes)}},{key:"updateDimensions",value:function(e,t,i,s){this.start=this.wave.offsetLeft/t||0,this.end=this.start+e/t,this.wave.width=i,this.wave.height=s;var l={width:e+"px"};(0,n.default)(this.wave,l),this.hasProgressCanvas&&(this.progress.width=i,this.progress.height=s,(0,n.default)(this.progress,l))}},{key:"clearWave",value:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height),this.hasProgressCanvas&&this.progressCtx.clearRect(0,0,this.progressCtx.canvas.width,this.progressCtx.canvas.height)}},{key:"setFillStyles",value:function(e,t){this.waveCtx.fillStyle=this.getFillStyle(this.waveCtx,e),this.hasProgressCanvas&&(this.progressCtx.fillStyle=this.getFillStyle(this.progressCtx,t))}},{key:"getFillStyle",value:function(e,t){if("string"==typeof t||t instanceof CanvasGradient)return t;var i=e.createLinearGradient(0,0,0,e.canvas.height);return t.forEach((function(e,n){return i.addColorStop(n/t.length,e)})),i}},{key:"applyCanvasTransforms",value:function(e){e&&(this.waveCtx.setTransform(0,1,1,0,0,0),this.hasProgressCanvas&&this.progressCtx.setTransform(0,1,1,0,0,0))}},{key:"fillRects",value:function(e,t,i,n,s){this.fillRectToContext(this.waveCtx,e,t,i,n,s),this.hasProgressCanvas&&this.fillRectToContext(this.progressCtx,e,t,i,n,s)}},{key:"fillRectToContext",value:function(e,t,i,n,s,l){e&&(l?this.drawRoundedRect(e,t,i,n,s,l):e.fillRect(t,i,n,s))}},{key:"drawRoundedRect",value:function(e,t,i,n,s,l){0!==s&&(s<0&&(i-=s*=-1),e.beginPath(),e.moveTo(t+l,i),e.lineTo(t+n-l,i),e.quadraticCurveTo(t+n,i,t+n,i+l),e.lineTo(t+n,i+s-l),e.quadraticCurveTo(t+n,i+s,t+n-l,i+s),e.lineTo(t+l,i+s),e.quadraticCurveTo(t,i+s,t,i+s-l),e.lineTo(t,i+l),e.quadraticCurveTo(t,i,t+l,i),e.closePath(),e.fill())}},{key:"drawLines",value:function(e,t,i,n,s,l){this.drawLineToContext(this.waveCtx,e,t,i,n,s,l),this.hasProgressCanvas&&this.drawLineToContext(this.progressCtx,e,t,i,n,s,l)}},{key:"drawLineToContext",value:function(e,t,i,n,s,l,o){if(e){var a,r,u,c=t.length/2,d=Math.round(c*this.start),h=d,p=Math.round(c*this.end)+1,f=this.wave.width/(p-h-1),g=n+s,m=i/n;for(e.beginPath(),e.moveTo((h-d)*f,g),e.lineTo((h-d)*f,g-Math.round((t[2*h]||0)/m)),a=h;a<p;a++)r=t[2*a]||0,u=Math.round(r/m),e.lineTo((a-d)*f+this.halfPixel,g-u);for(var v=p-1;v>=h;v--)r=t[2*v+1]||0,u=Math.round(r/m),e.lineTo((v-d)*f+this.halfPixel,g-u);e.lineTo((h-d)*f,g-Math.round((t[2*h+1]||0)/m)),e.closePath(),e.fill()}}},{key:"destroy",value:function(){this.waveCtx=null,this.wave=null,this.progressCtx=null,this.progress=null}},{key:"getImage",value:function(e,t,i){var n=this;return"blob"===i?new Promise((function(i){n.wave.toBlob(i,e,t)})):"dataURL"===i?this.wave.toDataURL(e,t):void 0}}])&&o(t.prototype,i),l&&o(t,l),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=a,e.exports=t.default},"./src/drawer.js":(e,t,i)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var i=l(t);if(i&&i.has(e))return i.get(e);var s={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var r=o?Object.getOwnPropertyDescriptor(e,a):null;r&&(r.get||r.set)?Object.defineProperty(s,a,r):s[a]=e[a]}return s.default=e,i&&i.set(e,s),s}(i("./src/util/index.js"));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(l=function(e){return e?i:t})(e)}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=c(e);if(t){var s=c(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return u(this,i)}}function u(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(u,e);var t,i,n,l=r(u);function u(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(i=l.call(this)).container=s.withOrientation(e,t.vertical),i.params=t,i.width=0,i.height=t.height*i.params.pixelRatio,i.lastPos=0,i.wrapper=null,i}return t=u,(i=[{key:"style",value:function(e,t){return s.style(e,t)}},{key:"createWrapper",value:function(){this.wrapper=s.withOrientation(this.container.appendChild(document.createElement("wave")),this.params.vertical),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",cursor:this.params.hideCursor?"none":"auto",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()}},{key:"handleEvent",value:function(e,t){!t&&e.preventDefault();var i,n=s.withOrientation(e.targetTouches?e.targetTouches[0]:e,this.params.vertical).clientX,l=this.wrapper.getBoundingClientRect(),o=this.width,a=this.getWidth(),r=this.getProgressPixels(l,n);return i=!this.params.fillParent&&o<a?r*(this.params.pixelRatio/o)||0:(r+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,s.clamp(i,0,1)}},{key:"getProgressPixels",value:function(e,t){return this.params.rtl?e.right-t:t-e.left}},{key:"setupWrapperEvents",value:function(){var e=this;this.wrapper.addEventListener("click",(function(t){var i=s.withOrientation(t,e.params.vertical),n=e.wrapper.offsetHeight-e.wrapper.clientHeight;if(0!==n){var l=e.wrapper.getBoundingClientRect();if(i.clientY>=l.bottom-n)return}e.params.interact&&e.fireEvent("click",t,e.handleEvent(t))})),this.wrapper.addEventListener("dblclick",(function(t){e.params.interact&&e.fireEvent("dblclick",t,e.handleEvent(t))})),this.wrapper.addEventListener("scroll",(function(t){return e.fireEvent("scroll",t)}))}},{key:"drawPeaks",value:function(e,t,i,n){this.setWidth(t)||this.clearWave(),this.params.barWidth?this.drawBars(e,0,i,n):this.drawWave(e,0,i,n)}},{key:"resetScroll",value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(e){var t=this.wrapper.scrollWidth*e;this.recenterOnPosition(t,!0)}},{key:"recenterOnPosition",value:function(e,t){var i=this.wrapper.scrollLeft,n=~~(this.wrapper.clientWidth/2),s=this.wrapper.scrollWidth-this.wrapper.clientWidth,l=e-n,o=l-i;if(0!=s){if(!t&&-n<=o&&o<n){var a=this.params.autoCenterRate;a/=n,a*=s,l=i+(o=Math.max(-a,Math.min(a,o)))}(l=Math.max(0,Math.min(s,l)))!=i&&(this.wrapper.scrollLeft=l)}}},{key:"getScrollX",value:function(){var e=0;if(this.wrapper){var t=this.params.pixelRatio;if(e=Math.round(this.wrapper.scrollLeft*t),this.params.scrollParent){var i=~~(this.wrapper.scrollWidth*t-this.getWidth());e=Math.min(i,Math.max(0,e))}}return e}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(e){if(this.width==e)return!1;if(this.width=e,this.params.fillParent||this.params.scrollParent)this.style(this.wrapper,{width:""});else{var t=~~(this.width/this.params.pixelRatio)+"px";this.style(this.wrapper,{width:t})}return this.updateSize(),!0}},{key:"setHeight",value:function(e){return e!=this.height&&(this.height=e,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"progress",value:function(e){var t=1/this.params.pixelRatio,i=Math.round(e*this.width)*t;if(i<this.lastPos||i-this.lastPos>=t){if(this.lastPos=i,this.params.scrollParent&&this.params.autoCenter){var n=~~(this.wrapper.scrollWidth*e);this.recenterOnPosition(n,this.params.autoCenterImmediately)}this.updateProgress(i)}}},{key:"destroy",value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode==this.container.domElement&&this.container.removeChild(this.wrapper.domElement),this.wrapper=null)}},{key:"updateCursor",value:function(){}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(e,t,i,n){}},{key:"drawWave",value:function(e,t,i,n){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(e){}}])&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(s.Observer);t.default=d,e.exports=t.default},"./src/drawer.multicanvas.js":(e,t,i)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(i("./src/drawer.js")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var i=a(t);if(i&&i.has(e))return i.get(e);var s={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=l?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(s,o,r):s[o]=e[o]}return s.default=e,i&&i.set(e,s),s}(i("./src/util/index.js")),o=r(i("./src/drawer.canvasentry.js"));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(a=function(e){return e?i:t})(e)}function r(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=p(e);if(t){var s=p(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return h(this,i)}}function h(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(a,e);var t,i,n,s=d(a);function a(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(i=s.call(this,e,t)).maxCanvasWidth=t.maxCanvasWidth,i.maxCanvasElementWidth=Math.round(t.maxCanvasWidth/t.pixelRatio),i.hasProgressCanvas=t.waveColor!=t.progressColor,i.halfPixel=.5/t.pixelRatio,i.canvases=[],i.progressWave=null,i.EntryClass=o.default,i.canvasContextAttributes=t.drawingContextAttributes,i.overlap=2*Math.ceil(t.pixelRatio/2),i.barRadius=t.barRadius||0,i.vertical=t.vertical,i}return t=a,i=[{key:"init",value:function(){this.createWrapper(),this.createElements()}},{key:"createElements",value:function(){this.progressWave=l.withOrientation(this.wrapper.appendChild(document.createElement("wave")),this.params.vertical),this.style(this.progressWave,{position:"absolute",zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"}),this.addCanvas(),this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){for(var e=this,t=Math.round(this.width/this.params.pixelRatio),i=Math.ceil(t/(this.maxCanvasElementWidth+this.overlap));this.canvases.length<i;)this.addCanvas();for(;this.canvases.length>i;)this.removeCanvas();var n=this.maxCanvasWidth+this.overlap,s=this.canvases.length-1;this.canvases.forEach((function(t,i){i==s&&(n=e.width-e.maxCanvasWidth*s),e.updateDimensions(t,n,e.height),t.clearWave()}))}},{key:"addCanvas",value:function(){var e=new this.EntryClass;e.canvasContextAttributes=this.canvasContextAttributes,e.hasProgressCanvas=this.hasProgressCanvas,e.halfPixel=this.halfPixel;var t=this.maxCanvasElementWidth*this.canvases.length,i=l.withOrientation(this.wrapper.appendChild(document.createElement("canvas")),this.params.vertical);if(this.style(i,{position:"absolute",zIndex:2,left:t+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"}),e.initWave(i),this.hasProgressCanvas){var n=l.withOrientation(this.progressWave.appendChild(document.createElement("canvas")),this.params.vertical);this.style(n,{position:"absolute",left:t+"px",top:0,bottom:0,height:"100%"}),e.initProgress(n)}this.canvases.push(e)}},{key:"removeCanvas",value:function(){var e=this.canvases[this.canvases.length-1];e.wave.parentElement.removeChild(e.wave.domElement),this.hasProgressCanvas&&e.progress.parentElement.removeChild(e.progress.domElement),e&&(e.destroy(),e=null),this.canvases.pop()}},{key:"updateDimensions",value:function(e,t,i){var n=Math.round(t/this.params.pixelRatio),s=Math.round(this.width/this.params.pixelRatio);e.updateDimensions(n,s,t,i),this.style(this.progressWave,{display:"block"})}},{key:"clearWave",value:function(){var e=this;l.frame((function(){e.canvases.forEach((function(e){return e.clearWave()}))}))()}},{key:"drawBars",value:function(e,t,i,n){var s=this;return this.prepareDraw(e,t,i,n,(function(e){var t=e.absmax,l=e.hasMinVals,o=(e.height,e.offsetY),a=e.halfH,r=e.peaks,u=e.channelIndex;if(void 0!==i)for(var c=l?2:1,d=r.length/c,h=s.params.barWidth*s.params.pixelRatio,p=h+(null===s.params.barGap?Math.max(s.params.pixelRatio,~~(h/2)):Math.max(s.params.pixelRatio,s.params.barGap*s.params.pixelRatio)),f=d/s.width,g=n,m=i;m<g;m+=p){var v=0,b=Math.floor(m*f)*c,_=Math.floor((m+p)*f)*c;do{var y=Math.abs(r[b]);y>v&&(v=y),b+=c}while(b<_);var x=Math.round(v/t*a);0==x&&s.params.barMinHeight&&(x=s.params.barMinHeight),s.fillRect(m+s.halfPixel,a-x+o,h+s.halfPixel,2*x,s.barRadius,u)}}))}},{key:"drawWave",value:function(e,t,i,n){var s=this;return this.prepareDraw(e,t,i,n,(function(e){var t=e.absmax,l=e.hasMinVals,o=(e.height,e.offsetY),a=e.halfH,r=e.peaks,u=e.channelIndex;if(!l){for(var c=[],d=r.length,h=0;h<d;h++)c[2*h]=r[h],c[2*h+1]=-r[h];r=c}void 0!==i&&s.drawLine(r,t,a,o,i,n,u),s.fillRect(0,a+o-s.halfPixel,s.width,s.halfPixel,s.barRadius,u)}))}},{key:"drawLine",value:function(e,t,i,n,s,l,o){var a=this,r=this.params.splitChannelsOptions.channelColors[o]||{},u=r.waveColor,c=r.progressColor;this.canvases.forEach((function(o,r){a.setFillStyles(o,u,c),a.applyCanvasTransforms(o,a.params.vertical),o.drawLines(e,t,i,n,s,l)}))}},{key:"fillRect",value:function(e,t,i,n,s,l){for(var o=Math.floor(e/this.maxCanvasWidth),a=Math.min(Math.ceil((e+i)/this.maxCanvasWidth)+1,this.canvases.length),r=o;r<a;r++){var u=this.canvases[r],c=r*this.maxCanvasWidth,d={x1:Math.max(e,r*this.maxCanvasWidth),y1:t,x2:Math.min(e+i,r*this.maxCanvasWidth+u.wave.width),y2:t+n};if(d.x1<d.x2){var h=this.params.splitChannelsOptions.channelColors[l]||{},p=h.waveColor,f=h.progressColor;this.setFillStyles(u,p,f),this.applyCanvasTransforms(u,this.params.vertical),u.fillRects(d.x1-c,d.y1,d.x2-d.x1,d.y2-d.y1,s)}}}},{key:"hideChannel",value:function(e){return this.params.splitChannels&&this.params.splitChannelsOptions.filterChannels.includes(e)}},{key:"prepareDraw",value:function(e,t,i,n,s,o,a){var r=this;return l.frame((function(){if(e[0]instanceof Array){var u=e;if(r.params.splitChannels){var c,d=u.filter((function(e,t){return!r.hideChannel(t)}));return r.params.splitChannelsOptions.overlay||r.setHeight(Math.max(d.length,1)*r.params.height*r.params.pixelRatio),r.params.splitChannelsOptions&&r.params.splitChannelsOptions.relativeNormalization&&(c=l.max(u.map((function(e){return l.absMax(e)})))),u.forEach((function(e,t){return r.prepareDraw(e,t,i,n,s,d.indexOf(e),c)}))}e=u[0]}if(!r.hideChannel(t)){var h=1/r.params.barHeight;r.params.normalize&&(h=void 0===a?l.absMax(e):a);var p=[].some.call(e,(function(e){return e<0})),f=r.params.height*r.params.pixelRatio,g=f/2,m=f*o||0;return r.params.splitChannelsOptions&&r.params.splitChannelsOptions.overlay&&(m=0),s({absmax:h,hasMinVals:p,height:f,offsetY:m,halfH:g,peaks:e,channelIndex:t})}}))()}},{key:"setFillStyles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.params.waveColor,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.params.progressColor;e.setFillStyles(t,i)}},{key:"applyCanvasTransforms",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.applyCanvasTransforms(t)}},{key:"getImage",value:function(e,t,i){if("blob"===i)return Promise.all(this.canvases.map((function(n){return n.getImage(e,t,i)})));if("dataURL"===i){var n=this.canvases.map((function(n){return n.getImage(e,t,i)}));return n.length>1?n:n[0]}}},{key:"updateProgress",value:function(e){this.style(this.progressWave,{width:e+"px"})}}],i&&u(t.prototype,i),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s.default);t.default=f,e.exports=t.default},"./src/mediaelement-webaudio.js":(e,t,i)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var s;function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=a(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(arguments.length<3?e:i):s.value}},o.apply(this,arguments)}function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var s=d(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return c(this,i)}}function c(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)}(a,e);var t,i,n,s=u(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).params=e,t.sourceMediaElement=null,t}return t=a,(i=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer(),this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode()}},{key:"_load",value:function(e,t,i){o(d(a.prototype),"_load",this).call(this,e,t,i),this.createMediaElementSource(e)}},{key:"createMediaElementSource",value:function(e){this.sourceMediaElement=this.ac.createMediaElementSource(e),this.sourceMediaElement.connect(this.analyser)}},{key:"play",value:function(e,t){return this.resumeAudioContext(),o(d(a.prototype),"play",this).call(this,e,t)}},{key:"destroy",value:function(){o(d(a.prototype),"destroy",this).call(this),this.destroyWebAudio()}}])&&l(t.prototype,i),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(((s=i("./src/mediaelement.js"))&&s.__esModule?s:{default:s}).default);t.default=h,e.exports=t.default},"./src/mediaelement.js":(e,t,i)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,l=(s=i("./src/webaudio.js"))&&s.__esModule?s:{default:s},o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var i=a(t);if(i&&i.has(e))return i.get(e);var s={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=l?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(s,o,r):s[o]=e[o]}return s.default=e,i&&i.set(e,s),s}(i("./src/util/index.js"));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(a=function(e){return e?i:t})(e)}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=c(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(arguments.length<3?e:i):s.value}},u.apply(this,arguments)}function c(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=f(e);if(t){var s=f(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return p(this,i)}}function p(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(l,e);var t,i,n,s=h(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this,e)).params=e,t.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0},t.mediaType=e.mediaType.toLowerCase(),t.elementPosition=e.elementPosition,t.peaks=null,t.playbackRate=1,t.volume=1,t.isMuted=!1,t.buffer=null,t.onPlayEnd=null,t.mediaListeners={},t}return t=l,(i=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer()}},{key:"_setupMediaListeners",value:function(){var e=this;this.mediaListeners.error=function(){e.fireEvent("error","Error loading media element")},this.mediaListeners.canplay=function(){e.fireEvent("canplay")},this.mediaListeners.ended=function(){e.fireEvent("finish")},this.mediaListeners.play=function(){e.fireEvent("play")},this.mediaListeners.pause=function(){e.fireEvent("pause")},this.mediaListeners.seeked=function(t){e.fireEvent("seek")},this.mediaListeners.volumechange=function(t){e.isMuted=e.media.muted,e.isMuted?e.volume=0:e.volume=e.media.volume,e.fireEvent("volume")},Object.keys(this.mediaListeners).forEach((function(t){e.media.removeEventListener(t,e.mediaListeners[t]),e.media.addEventListener(t,e.mediaListeners[t])}))}},{key:"createTimer",value:function(){var e=this;this.on("play",(function t(){e.isPaused()||(e.fireEvent("audioprocess",e.getCurrentTime()),o.frame(t)())})),this.on("pause",(function(){e.fireEvent("audioprocess",e.getCurrentTime())}))}},{key:"load",value:function(e,t,i,n){var s=document.createElement(this.mediaType);s.controls=this.params.mediaControls,s.autoplay=this.params.autoplay||!1,s.preload=null==n?"auto":n,s.src=e,s.style.width="100%";var l=t.querySelector(this.mediaType);l&&t.removeChild(l),t.appendChild(s),this._load(s,i,n)}},{key:"loadElt",value:function(e,t){e.controls=this.params.mediaControls,e.autoplay=this.params.autoplay||!1,this._load(e,t,e.preload)}},{key:"_load",value:function(e,t,i){if(!(e instanceof HTMLMediaElement)||void 0===e.addEventListener)throw new Error("media parameter is not a valid media element");"function"!=typeof e.load||t&&"none"==i||e.load(),this.media=e,this._setupMediaListeners(),this.peaks=t,this.onPlayEnd=null,this.buffer=null,this.isMuted=e.muted,this.setPlaybackRate(this.playbackRate),this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration)return this.explicitDuration;var e=(this.buffer||this.media).duration;return e>=1/0&&(e=this.media.seekable.end(0)),e}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(e){null==e||isNaN(e)||(this.media.currentTime=e),this.clearPlayEnd()}},{key:"play",value:function(e,t){this.seekTo(e);var i=this.media.play();return t&&this.setPlayEnd(t),i}},{key:"pause",value:function(){var e;return this.media&&(e=this.media.pause()),this.clearPlayEnd(),e}},{key:"setPlayEnd",value:function(e){var t=this;this.clearPlayEnd(),this._onPlayEnd=function(i){i>=e&&(t.pause(),t.seekTo(e))},this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(e,t,i){return this.buffer?u(f(l.prototype),"getPeaks",this).call(this,e,t,i):this.peaks||[]}},{key:"setSinkId",value:function(e){return e?this.media.setSinkId?this.media.setSinkId(e):Promise.reject(new Error("setSinkId is not supported in your browser")):Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){this.volume=e,this.media.volume!==this.volume&&(this.media.volume=this.volume)}},{key:"setMute",value:function(e){this.isMuted=this.media.muted=e}},{key:"destroy",value:function(){var e=this;this.pause(),this.unAll(),this.destroyed=!0,Object.keys(this.mediaListeners).forEach((function(t){e.media&&e.media.removeEventListener(t,e.mediaListeners[t])})),this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}])&&r(t.prototype,i),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(l.default);t.default=g,e.exports=t.default},"./src/peakcache.js":(e,t)=>{"use strict";function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clearPeakCache()}var t,n,s;return t=e,(n=[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[],this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(e,t,i){e!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=e);for(var n=[],s=0;s<this.peakCacheRanges.length&&this.peakCacheRanges[s]<t;)s++;for(s%2==0&&n.push(t);s<this.peakCacheRanges.length&&this.peakCacheRanges[s]<=i;)n.push(this.peakCacheRanges[s]),s++;s%2==0&&n.push(i),n=n.filter((function(e,t,i){return 0==t?e!=i[t+1]:t==i.length-1?e!=i[t-1]:e!=i[t-1]&&e!=i[t+1]})),this.peakCacheRanges=this.peakCacheRanges.concat(n),this.peakCacheRanges=this.peakCacheRanges.sort((function(e,t){return e-t})).filter((function(e,t,i){return 0==t?e!=i[t+1]:t==i.length-1?e!=i[t-1]:e!=i[t-1]&&e!=i[t+1]}));var l=[];for(s=0;s<n.length;s+=2)l.push([n[s],n[s+1]]);return l}},{key:"getCacheRanges",value:function(){var e,t=[];for(e=0;e<this.peakCacheRanges.length;e+=2)t.push([this.peakCacheRanges[e],this.peakCacheRanges[e+1]]);return t}}])&&i(t.prototype,n),s&&i(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=n,e.exports=t.default},"./src/util/absMax.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,n.default)(e),i=(0,s.default)(e);return-i>t?-i:t};var n=l(i("./src/util/max.js")),s=l(i("./src/util/min.js"));function l(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},"./src/util/clamp.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,i){return Math.min(Math.max(t,e),i)},e.exports=t.default},"./src/util/fetch.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)throw new Error("fetch options missing");if(!e.url)throw new Error("fetch url missing");var t=new s.default,i=new Headers,n=new Request(e.url);t.controller=new AbortController,e&&e.requestHeaders&&e.requestHeaders.forEach((function(e){i.append(e.key,e.value)}));var l=e.responseType||"json",a={method:e.method||"GET",headers:i,mode:e.mode||"cors",credentials:e.credentials||"same-origin",cache:e.cache||"default",redirect:e.redirect||"follow",referrer:e.referrer||"client",signal:t.controller.signal};return fetch(n,a).then((function(e){t.response=e;var i=!0;e.body||(i=!1);var n=e.headers.get("content-length");return null===n&&(i=!1),i?(t.onProgress=function(e){t.fireEvent("progress",e)},new Response(new ReadableStream(new o(t,n,e)),a)):e})).then((function(e){var t;if(e.ok)switch(l){case"arraybuffer":return e.arrayBuffer();case"json":return e.json();case"blob":return e.blob();case"text":return e.text();default:t="Unknown responseType: "+l}throw t||(t="HTTP error status: "+e.status),new Error(t)})).then((function(e){t.fireEvent("success",e)})).catch((function(e){t.fireEvent("error",e)})),t.fetchRequest=n,t};var n,s=(n=i("./src/util/observer.js"))&&n.__esModule?n:{default:n};function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.instance._reader=n.body.getReader(),this.total=parseInt(i,10),this.loaded=0}var t,i,n;return t=e,(i=[{key:"start",value:function(e){var t=this;!function i(){t.instance._reader.read().then((function(n){var s=n.done,l=n.value;if(s)return 0===t.total&&t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!1}),void e.close();t.loaded+=l.byteLength,t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!(0===t.total)}),e.enqueue(l),i()})).catch((function(t){e.error(t)}))}()}}])&&l(t.prototype,i),n&&l(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=t.default},"./src/util/frame.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(0,s.default)((function(){return e.apply(void 0,i)}))}};var n,s=(n=i("./src/util/request-animation-frame.js"))&&n.__esModule?n:{default:n};e.exports=t.default},"./src/util/get-id.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return void 0===e&&(e="wavesurfer_"),e+Math.random().toString(32).substring(2)},e.exports=t.default},"./src/util/index.js":(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Observer",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"absMax",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"clamp",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"fetchFile",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"frame",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"getId",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"ignoreSilenceMode",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"max",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"min",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"preventClick",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"requestAnimationFrame",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"style",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"withOrientation",{enumerable:!0,get:function(){return g.default}});var n=v(i("./src/util/get-id.js")),s=v(i("./src/util/max.js")),l=v(i("./src/util/min.js")),o=v(i("./src/util/absMax.js")),a=v(i("./src/util/observer.js")),r=v(i("./src/util/style.js")),u=v(i("./src/util/request-animation-frame.js")),c=v(i("./src/util/frame.js")),d=v(i("./node_modules/debounce/index.js")),h=v(i("./src/util/prevent-click.js")),p=v(i("./src/util/fetch.js")),f=v(i("./src/util/clamp.js")),g=v(i("./src/util/orientation.js")),m=v(i("./src/util/silence-mode.js"));function v(e){return e&&e.__esModule?e:{default:e}}},"./src/util/max.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=-1/0;return Object.keys(e).forEach((function(i){e[i]>t&&(t=e[i])})),t},e.exports=t.default},"./src/util/min.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Number(1/0);return Object.keys(e).forEach((function(i){e[i]<t&&(t=e[i])})),t},e.exports=t.default},"./src/util/observer.js":(e,t)=>{"use strict";function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._disabledEventEmissions=[],this.handlers=null}var t,n,s;return t=e,n=[{key:"on",value:function(e,t){var i=this;this.handlers||(this.handlers={});var n=this.handlers[e];return n||(n=this.handlers[e]=[]),n.push(t),{name:e,callback:t,un:function(e,t){return i.un(e,t)}}}},{key:"un",value:function(e,t){if(this.handlers){var i,n=this.handlers[e];if(n)if(t)for(i=n.length-1;i>=0;i--)n[i]==t&&n.splice(i,1);else n.length=0}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(e,t){var i=this;return this.on(e,(function n(){for(var s=arguments.length,l=new Array(s),o=0;o<s;o++)l[o]=arguments[o];t.apply(i,l),setTimeout((function(){i.un(e,n)}),0)}))}},{key:"setDisabledEventEmissions",value:function(e){this._disabledEventEmissions=e}},{key:"_isDisabledEventEmission",value:function(e){return this._disabledEventEmissions&&this._disabledEventEmissions.includes(e)}},{key:"fireEvent",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];if(this.handlers&&!this._isDisabledEventEmission(e)){var s=this.handlers[e];s&&s.forEach((function(e){e.apply(void 0,i)}))}}}],n&&i(t.prototype,n),s&&i(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=n,e.exports=t.default},"./src/util/orientation.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,i){return t[s]?t:new Proxy(t,{get:function(t,l,o){if(l===s)return!0;if("domElement"===l)return t;if("style"===l)return e(t.style,i);if("canvas"===l)return e(t.canvas,i);if("getBoundingClientRect"===l)return function(){return e(t.getBoundingClientRect.apply(t,arguments),i)};if("getContext"===l)return function(){return e(t.getContext.apply(t,arguments),i)};var a=t[n(l,i)];return"function"==typeof a?a.bind(t):a},set:function(e,t,s){return e[n(t,i)]=s,!0}})};var i={width:"height",height:"width",overflowX:"overflowY",overflowY:"overflowX",clientWidth:"clientHeight",clientHeight:"clientWidth",clientX:"clientY",clientY:"clientX",scrollWidth:"scrollHeight",scrollLeft:"scrollTop",offsetLeft:"offsetTop",offsetTop:"offsetLeft",offsetHeight:"offsetWidth",offsetWidth:"offsetHeight",left:"top",right:"bottom",top:"left",bottom:"right",borderRightStyle:"borderBottomStyle",borderRightWidth:"borderBottomWidth",borderRightColor:"borderBottomColor"};function n(e,t){return Object.prototype.hasOwnProperty.call(i,e)&&t?i[e]:e}var s=Symbol("isProxy");e.exports=t.default},"./src/util/prevent-click.js":(e,t)=>{"use strict";function i(e){e.stopPropagation(),document.body.removeEventListener("click",i,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){document.body.addEventListener("click",i,!0)},e.exports=t.default},"./src/util/request-animation-frame.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return setTimeout(e,1e3/60)}).bind(window);t.default=i,e.exports=t.default},"./src/util/silence-mode.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=document.createElement("div");e.innerHTML='<audio x-webkit-airplay="deny"></audio>';var t=e.children.item(0);t.src="data:audio/mpeg;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA//////////////////////////////////////////////////////////////////8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//sQxAADgnABGiAAQBCqgCRMAAgEAH///////////////7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq//////////////////9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",t.preload="auto",t.type="audio/mpeg",t.disableRemotePlayback=!0,t.play(),t.remove(),e.remove()},e.exports=t.default},"./src/util/style.js":(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return Object.keys(t).forEach((function(i){e.style[i]!==t[i]&&(e.style[i]=t[i])})),e},e.exports=t.default},"./src/wavesurfer.js":(e,t,i)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var i=d(t);if(i&&i.has(e))return i.get(e);var s={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=l?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(s,o,a):s[o]=e[o]}return s.default=e,i&&i.set(e,s),s}(i("./src/util/index.js")),l=c(i("./src/drawer.multicanvas.js")),o=c(i("./src/webaudio.js")),a=c(i("./src/mediaelement.js")),r=c(i("./src/peakcache.js")),u=c(i("./src/mediaelement-webaudio.js"));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(d=function(e){return e?i:t})(e)}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=m(e);if(t){var s=m(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f(this,i)}}function f(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function v(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,i){return t&&_(e.prototype,t),i&&_(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(i,e);var t=p(i);function i(e){var n;if(b(this,i),v(g(n=t.call(this)),"defaultParams",{audioContext:null,audioScriptProcessor:null,audioRate:1,autoCenter:!0,autoCenterRate:5,autoCenterImmediately:!1,backend:"WebAudio",backgroundColor:null,barHeight:1,barRadius:0,barGap:null,barMinHeight:null,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,drawingContextAttributes:{desynchronized:!1},duration:null,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,hideCursor:!1,ignoreSilenceMode:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"#555",removeMediaElementOnDestroy:!0,renderer:l.default,responsive:!1,rtl:!1,scrollParent:!1,skipLength:2,splitChannels:!1,splitChannelsOptions:{overlay:!1,channelColors:{},filterChannels:[],relativeNormalization:!1},vertical:!1,waveColor:"#999",xhr:{}}),v(g(n),"backends",{MediaElement:a.default,WebAudio:o.default,MediaElementWebAudio:u.default}),v(g(n),"util",s),n.params=Object.assign({},n.defaultParams,e),n.params.splitChannelsOptions=Object.assign({},n.defaultParams.splitChannelsOptions,e.splitChannelsOptions),n.container="string"==typeof e.container?document.querySelector(n.params.container):n.params.container,!n.container)throw new Error("Container element not found");if(null==n.params.mediaContainer?n.mediaContainer=n.container:"string"==typeof n.params.mediaContainer?n.mediaContainer=document.querySelector(n.params.mediaContainer):n.mediaContainer=n.params.mediaContainer,!n.mediaContainer)throw new Error("Media Container element not found");if(n.params.maxCanvasWidth<=1)throw new Error("maxCanvasWidth must be greater than 1");if(n.params.maxCanvasWidth%2==1)throw new Error("maxCanvasWidth must be an even number");if(!0===n.params.rtl&&(!0===n.params.vertical?s.style(n.container,{transform:"rotateX(180deg)"}):s.style(n.container,{transform:"rotateY(180deg)"})),n.params.backgroundColor&&n.setBackgroundColor(n.params.backgroundColor),n.savedVolume=0,n.isMuted=!1,n.tmpEvents=[],n.currentRequest=null,n.arraybuffer=null,n.drawer=null,n.backend=null,n.peakCache=null,"function"!=typeof n.params.renderer)throw new Error("Renderer parameter is invalid");n.Drawer=n.params.renderer,"AudioElement"==n.params.backend&&(n.params.backend="MediaElement"),"WebAudio"!=n.params.backend&&"MediaElementWebAudio"!==n.params.backend||o.default.prototype.supportsWebAudio.call(null)||(n.params.backend="MediaElement"),n.Backend=n.backends[n.params.backend],n.initialisedPluginList={},n.isDestroyed=!1,n.isReady=!1;var r=0;return n._onResize=s.debounce((function(){r==n.drawer.wrapper.clientWidth||n.params.scrollParent||(r=n.drawer.wrapper.clientWidth)&&n.drawer.fireEvent("redraw")}),"number"==typeof n.params.responsive?n.params.responsive:100),f(n,g(n))}return y(i,[{key:"init",value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this.createBackend(),this.createPeakCache(),this}},{key:"registerPlugins",value:function(e){var t=this;return e.forEach((function(e){return t.addPlugin(e)})),e.forEach((function(e){e.deferInit||t.initPlugin(e.name)})),this.fireEvent("plugins-registered",e),this}},{key:"getActivePlugins",value:function(){return this.initialisedPluginList}},{key:"addPlugin",value:function(e){var t=this;if(!e.name)throw new Error("Plugin does not have a name!");if(!e.instance)throw new Error("Plugin ".concat(e.name," does not have an instance property!"));e.staticProps&&Object.keys(e.staticProps).forEach((function(i){t[i]=e.staticProps[i]}));var i=e.instance;return Object.getOwnPropertyNames(s.Observer.prototype).forEach((function(e){i.prototype[e]=s.Observer.prototype[e]})),this[e.name]=new i(e.params||{},this),this.fireEvent("plugin-added",e.name),this}},{key:"initPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet!"));return this.initialisedPluginList[e]&&this.destroyPlugin(e),this[e].init(),this.initialisedPluginList[e]=!0,this.fireEvent("plugin-initialised",e),this}},{key:"destroyPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet and cannot be destroyed!"));if(!this.initialisedPluginList[e])throw new Error("Plugin ".concat(e," is not active and cannot be destroyed!"));if("function"!=typeof this[e].destroy)throw new Error("Plugin ".concat(e," does not have a destroy function!"));return this[e].destroy(),delete this.initialisedPluginList[e],this.fireEvent("plugin-destroyed",e),this}},{key:"destroyAllPlugins",value:function(){var e=this;Object.keys(this.initialisedPluginList).forEach((function(t){return e.destroyPlugin(t)}))}},{key:"createDrawer",value:function(){var e=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent("drawer-created",this.drawer),!1!==this.params.responsive&&(window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0)),this.drawer.on("redraw",(function(){e.drawBuffer(),e.drawer.progress(e.backend.getPlayedPercents())})),this.drawer.on("click",(function(t,i){setTimeout((function(){return e.seekTo(i)}),0)})),this.drawer.on("scroll",(function(t){e.params.partialRender&&e.drawBuffer(),e.fireEvent("scroll",t)}))}},{key:"createBackend",value:function(){var e=this;this.backend&&this.backend.destroy(),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent("backend-created",this.backend),this.backend.on("finish",(function(){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("finish")})),this.backend.on("play",(function(){return e.fireEvent("play")})),this.backend.on("pause",(function(){return e.fireEvent("pause")})),this.backend.on("audioprocess",(function(t){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("audioprocess",t)})),"MediaElement"!==this.params.backend&&"MediaElementWebAudio"!==this.params.backend||(this.backend.on("seek",(function(){e.drawer.progress(e.backend.getPlayedPercents())})),this.backend.on("volume",(function(){var t=e.getVolume();e.fireEvent("volume",t),e.backend.isMuted!==e.isMuted&&(e.isMuted=e.backend.isMuted,e.fireEvent("mute",e.isMuted))})))}},{key:"createPeakCache",value:function(){this.params.partialRender&&(this.peakCache=new r.default)}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(e){e>=this.getDuration()?this.seekTo(1):this.seekTo(e/this.getDuration())}},{key:"play",value:function(e,t){var i=this;return this.params.ignoreSilenceMode&&s.ignoreSilenceMode(),this.fireEvent("interaction",(function(){return i.play(e,t)})),this.backend.play(e,t)}},{key:"setPlayEnd",value:function(e){this.backend.setPlayEnd(e)}},{key:"pause",value:function(){if(!this.backend.isPaused())return this.backend.pause()}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(e){this.skip(-e||-this.params.skipLength)}},{key:"skipForward",value:function(e){this.skip(e||this.params.skipLength)}},{key:"skip",value:function(e){var t=this.getDuration()||1,i=this.getCurrentTime()||0;i=Math.max(0,Math.min(t,i+(e||0))),this.seekAndCenter(i/t)}},{key:"seekAndCenter",value:function(e){this.seekTo(e),this.drawer.recenter(e)}},{key:"seekTo",value:function(e){var t=this;if("number"!=typeof e||!isFinite(e)||e<0||e>1)throw new Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!");this.fireEvent("interaction",(function(){return t.seekTo(e)}));var i="WebAudio"===this.params.backend,n=this.backend.isPaused();i&&!n&&this.backend.pause();var s=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(e*this.getDuration()),this.drawer.progress(e),i&&!n&&this.backend.play(),this.params.scrollParent=s,this.fireEvent("seek",e)}},{key:"stop",value:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)}},{key:"setSinkId",value:function(e){return this.backend.setSinkId(e)}},{key:"setVolume",value:function(e){this.backend.setVolume(e),this.fireEvent("volume",e)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(e){this.backend.setPlaybackRate(e)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(e){e!==this.isMuted?(this.backend.setMute?(this.backend.setMute(e),this.isMuted=e):e?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0,this.fireEvent("volume",0)):(this.backend.setVolume(this.savedVolume),this.isMuted=!1,this.fireEvent("volume",this.savedVolume)),this.fireEvent("mute",this.isMuted)):this.fireEvent("mute",this.isMuted)}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.params.splitChannelsOptions.channelColors[e]?this.params.splitChannelsOptions.channelColors[e].waveColor:this.params.waveColor}},{key:"setWaveColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.params.splitChannelsOptions.channelColors[t]?this.params.splitChannelsOptions.channelColors[t].waveColor=e:this.params.waveColor=e,this.drawBuffer()}},{key:"getProgressColor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.params.splitChannelsOptions.channelColors[e]?this.params.splitChannelsOptions.channelColors[e].progressColor:this.params.progressColor}},{key:"setProgressColor",value:function(e,t){this.params.splitChannelsOptions.channelColors[t]?this.params.splitChannelsOptions.channelColors[t].progressColor=e:this.params.progressColor=e,this.drawBuffer()}},{key:"getBackgroundColor",value:function(){return this.params.backgroundColor}},{key:"setBackgroundColor",value:function(e){this.params.backgroundColor=e,s.style(this.container,{background:this.params.backgroundColor})}},{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(e){this.params.cursorColor=e,this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(e){this.params.height=e,this.drawer.setHeight(e*this.params.pixelRatio),this.drawBuffer()}},{key:"setFilteredChannels",value:function(e){this.params.splitChannelsOptions.filterChannels=e,this.drawBuffer()}},{key:"drawBuffer",value:function(){var e,t=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),i=this.drawer.getWidth(),n=t,s=0,l=Math.max(s+i,n);if(this.params.fillParent&&(!this.params.scrollParent||t<i)&&(s=0,l=n=i),this.params.partialRender){var o,a=this.peakCache.addRangeToPeakCache(n,s,l);for(o=0;o<a.length;o++)e=this.backend.getPeaks(n,a[o][0],a[o][1]),this.drawer.drawPeaks(e,n,a[o][0],a[o][1])}else e=this.backend.getPeaks(n,s,l),this.drawer.drawPeaks(e,n,s,l);this.fireEvent("redraw",e,n)}},{key:"zoom",value:function(e){e?(this.params.minPxPerSec=e,this.params.scrollParent=!0):(this.params.minPxPerSec=this.defaultParams.minPxPerSec,this.params.scrollParent=!1),this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",e)}},{key:"loadArrayBuffer",value:function(e){var t=this;this.decodeArrayBuffer(e,(function(e){t.isDestroyed||t.loadDecodedBuffer(e)}))}},{key:"loadDecodedBuffer",value:function(e){this.backend.load(e),this.drawBuffer(),this.isReady=!0,this.fireEvent("ready")}},{key:"loadBlob",value:function(e){var t=this,i=new FileReader;i.addEventListener("progress",(function(e){return t.onProgress(e)})),i.addEventListener("load",(function(e){return t.loadArrayBuffer(e.target.result)})),i.addEventListener("error",(function(){return t.fireEvent("error","Error reading file")})),i.readAsArrayBuffer(e),this.empty()}},{key:"load",value:function(e,t,i,n){if(!e)throw new Error("url parameter cannot be empty");if(this.empty(),i){var s={"Preload is not 'auto', 'none' or 'metadata'":-1===["auto","metadata","none"].indexOf(i),"Peaks are not provided":!t,"Backend is not of type 'MediaElement' or 'MediaElementWebAudio'":-1===["MediaElement","MediaElementWebAudio"].indexOf(this.params.backend),"Url is not of type string":"string"!=typeof e},l=Object.keys(s).filter((function(e){return s[e]}));l.length&&(console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- "+l.join("\n\t- ")),i=null)}switch("WebAudio"===this.params.backend&&e instanceof HTMLMediaElement&&(e=e.src),this.params.backend){case"WebAudio":return this.loadBuffer(e,t,n);case"MediaElement":case"MediaElementWebAudio":return this.loadMediaElement(e,t,i,n)}}},{key:"loadBuffer",value:function(e,t,i){var n=this,s=function(t){return t&&n.tmpEvents.push(n.once("ready",t)),n.getArrayBuffer(e,(function(e){return n.loadArrayBuffer(e)}))};if(!t)return s();this.backend.setPeaks(t,i),this.drawBuffer(),this.fireEvent("waveform-ready"),this.tmpEvents.push(this.once("interaction",s))}},{key:"loadMediaElement",value:function(e,t,i,n){var s=this,l=e;if("string"==typeof e)this.backend.load(l,this.mediaContainer,t,i);else{var o=e;this.backend.loadElt(o,t),l=o.src}this.tmpEvents.push(this.backend.once("canplay",(function(){s.backend.destroyed||(s.drawBuffer(),s.isReady=!0,s.fireEvent("ready"))})),this.backend.once("error",(function(e){return s.fireEvent("error",e)}))),t&&(this.backend.setPeaks(t,n),this.drawBuffer(),this.fireEvent("waveform-ready")),t&&!this.params.forceDecode||!this.backend.supportsWebAudio()||this.getArrayBuffer(l,(function(e){s.decodeArrayBuffer(e,(function(e){s.backend.buffer=e,s.backend.setPeaks(null),s.drawBuffer(),s.fireEvent("waveform-ready")}))}))}},{key:"decodeArrayBuffer",value:function(e,t){var i=this;this.isDestroyed||(this.arraybuffer=e,this.backend.decodeArrayBuffer(e,(function(n){i.isDestroyed||i.arraybuffer!=e||(t(n),i.arraybuffer=null)}),(function(){return i.fireEvent("error","Error decoding audiobuffer")})))}},{key:"getArrayBuffer",value:function(e,t){var i=this,n=Object.assign({url:e,responseType:"arraybuffer"},this.params.xhr),l=s.fetchFile(n);return this.currentRequest=l,this.tmpEvents.push(l.on("progress",(function(e){i.onProgress(e)})),l.on("success",(function(e){t(e),i.currentRequest=null})),l.on("error",(function(e){i.fireEvent("error",e),i.currentRequest=null}))),l}},{key:"onProgress",value:function(e){var t;t=e.lengthComputable?e.loaded/e.total:e.loaded/(e.loaded+1e6),this.fireEvent("loading",Math.round(100*t),e.target)}},{key:"exportPCM",value:function(e,t,i,n,s){e=e||1024,n=n||0,t=t||1e4,i=i||!1;var l=this.backend.getPeaks(e,n,s),o=[].map.call(l,(function(e){return Math.round(e*t)/t}));return new Promise((function(e,t){if(!i){var n=new Blob([JSON.stringify(o)],{type:"application/json;charset=utf-8"}),s=URL.createObjectURL(n);window.open(s),URL.revokeObjectURL(s)}e(o)}))}},{key:"exportImage",value:function(e,t,i){return e||(e="image/png"),t||(t=1),i||(i="dataURL"),this.drawer.getImage(e,t,i)}},{key:"cancelAjax",value:function(){this.currentRequest&&this.currentRequest.controller&&(this.currentRequest._reader&&this.currentRequest._reader.cancel().catch((function(e){})),this.currentRequest.controller.abort(),this.currentRequest=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach((function(e){return e.un()}))}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.isReady=!1,this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins(),this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),!1!==this.params.responsive&&(window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0)),this.backend&&(this.backend.destroy(),this.backend=null),this.drawer&&this.drawer.destroy(),this.isDestroyed=!0,this.isReady=!1,this.arraybuffer=null}}],[{key:"create",value:function(e){return new i(e).init()}}]),i}(s.Observer);t.default=x,v(x,"VERSION","6.1.0"),v(x,"util",s),e.exports=t.default},"./src/webaudio.js":(e,t,i)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var i=l(t);if(i&&i.has(e))return i.get(e);var s={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var r=o?Object.getOwnPropertyDescriptor(e,a):null;r&&(r.get||r.set)?Object.defineProperty(s,a,r):s[a]=e[a]}return s.default=e,i&&i.set(e,s),s}(i("./src/util/index.js"));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(l=function(e){return e?i:t})(e)}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var s=d(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return u(this,i)}}function u(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var p="playing",f="paused",g="finished",m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(l,e);var t,i,n,s=r(l);function l(e){var t,i,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),h(c(n=s.call(this)),"audioContext",null),h(c(n),"offlineAudioContext",null),h(c(n),"stateBehaviors",(h(t={},p,{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),h(t,f,{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition}}),h(t,g,{init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),t)),n.params=e,n.ac=e.audioContext||(n.supportsWebAudio()?n.getAudioContext():{}),n.lastPlay=n.ac.currentTime,n.startPosition=0,n.scheduledPause=null,n.states=(h(i={},p,Object.create(n.stateBehaviors.playing)),h(i,f,Object.create(n.stateBehaviors.paused)),h(i,g,Object.create(n.stateBehaviors.finished)),i),n.buffer=null,n.filters=[],n.gainNode=null,n.mergedPeaks=null,n.offlineAc=null,n.peaks=null,n.playbackRate=1,n.analyser=null,n.scriptNode=null,n.source=null,n.splitPeaks=[],n.state=null,n.explicitDuration=e.duration,n.sinkStreamDestination=null,n.sinkAudioElement=null,n.destroyed=!1,n}return t=l,i=[{key:"supportsWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"getAudioContext",value:function(){return window.WaveSurferAudioContext||(window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(e){return window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)),window.WaveSurferOfflineAudioContext}},{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(f),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach((function(e){e&&e.disconnect()})),this.filters=null,this.analyser.connect(this.gainNode))}},{key:"setState",value:function(e){this.state!==this.states[e]&&(this.state=this.states[e],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.setFilters(t)}},{key:"setFilters",value:function(e){this.disconnectFilters(),e&&e.length&&(this.filters=e,this.analyser.disconnect(),e.reduce((function(e,t){return e.connect(t),t}),this.analyser).connect(this.gainNode))}},{key:"createScriptNode",value:function(){this.params.audioScriptProcessor?this.scriptNode=this.params.audioScriptProcessor:this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(l.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(l.scriptBufferSize),this.scriptNode.connect(this.ac.destination)}},{key:"addOnAudioProcess",value:function(){var e=this;this.scriptNode.onaudioprocess=function(){var t=e.getCurrentTime();t>=e.getDuration()?(e.setState(g),e.fireEvent("pause")):t>=e.scheduledPause?e.pause():e.state===e.states.playing&&e.fireEvent("audioprocess",t)}}},{key:"removeOnAudioProcess",value:function(){this.scriptNode.onaudioprocess=null}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:"setSinkId",value:function(e){return e?(this.sinkAudioElement||(this.sinkAudioElement=new window.Audio,this.sinkAudioElement.autoplay=!0),this.sinkAudioElement.setSinkId?(this.sinkStreamDestination||(this.sinkStreamDestination=this.ac.createMediaStreamDestination()),this.gainNode.disconnect(),this.gainNode.connect(this.sinkStreamDestination),this.sinkAudioElement.srcObject=this.sinkStreamDestination.stream,this.sinkAudioElement.setSinkId(e)):Promise.reject(new Error("setSinkId is not supported in your browser"))):Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"setVolume",value:function(e){this.gainNode.gain.setValueAtTime(e,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(e,t,i){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac&&this.ac.sampleRate?this.ac.sampleRate:44100)),"webkitAudioContext"in window?this.offlineAc.decodeAudioData(e,(function(e){return t(e)}),i):this.offlineAc.decodeAudioData(e).then((function(e){return t(e)})).catch((function(e){return i(e)}))}},{key:"setPeaks",value:function(e,t){null!=t&&(this.explicitDuration=t),this.peaks=e}},{key:"setLength",value:function(e){if(!this.mergedPeaks||e!=2*this.mergedPeaks.length-1+2){this.splitPeaks=[],this.mergedPeaks=[];var t,i=this.buffer?this.buffer.numberOfChannels:1;for(t=0;t<i;t++)this.splitPeaks[t]=[],this.splitPeaks[t][2*(e-1)]=0,this.splitPeaks[t][2*(e-1)+1]=0;this.mergedPeaks[2*(e-1)]=0,this.mergedPeaks[2*(e-1)+1]=0}}},{key:"getPeaks",value:function(e,t,i){if(this.peaks)return this.peaks;if(!this.buffer)return[];if(t=t||0,i=i||e-1,this.setLength(e),!this.buffer)return this.params.splitChannels?this.splitPeaks:this.mergedPeaks;if(!this.buffer.length){var n=this.createBuffer(1,4096,this.sampleRate);this.buffer=n.buffer}var s,l=this.buffer.length/e,o=~~(l/10)||1,a=this.buffer.numberOfChannels;for(s=0;s<a;s++){var r=this.splitPeaks[s],u=this.buffer.getChannelData(s),c=void 0;for(c=t;c<=i;c++){var d=~~(c*l),h=~~(d+l),p=u[d],f=p,g=void 0;for(g=d;g<h;g+=o){var m=u[g];m>f&&(f=m),m<p&&(p=m)}r[2*c]=f,r[2*c+1]=p,(0==s||f>this.mergedPeaks[2*c])&&(this.mergedPeaks[2*c]=f),(0==s||p<this.mergedPeaks[2*c+1])&&(this.mergedPeaks[2*c+1]=p)}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroyWebAudio",value:function(){this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&("function"==typeof this.ac.close&&"closed"!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=null),this.sinkStreamDestination&&(this.sinkAudioElement.pause(),this.sinkAudioElement.srcObject=null,this.sinkStreamDestination.disconnect(),this.sinkStreamDestination=null)}},{key:"destroy",value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.destroyed=!0,this.destroyWebAudio()}},{key:"load",value:function(e){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=e,this.createSource()}},{key:"createSource",value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.setPlaybackRate(this.playbackRate),this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:"resumeAudioContext",value:function(){"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume()}},{key:"isPaused",value:function(){return this.state!==this.states.playing}},{key:"getDuration",value:function(){return this.explicitDuration?this.explicitDuration:this.buffer?this.buffer.duration:0}},{key:"seekTo",value:function(e,t){if(this.buffer)return this.scheduledPause=null,null==e&&(e=this.getCurrentTime())>=this.getDuration()&&(e=0),null==t&&(t=this.getDuration()),this.startPosition=e,this.lastPlay=this.ac.currentTime,this.state===this.states.finished&&this.setState(f),{start:e,end:t}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(e,t){if(this.buffer){this.createSource();var i=this.seekTo(e,t);e=i.start,t=i.end,this.scheduledPause=t,this.source.start(0,e),this.resumeAudioContext(),this.setState(p),this.fireEvent("play")}}},{key:"pause",value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime();try{this.source&&this.source.stop(0)}catch(e){}this.setState(f),this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.source&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime)}},{key:"setPlayEnd",value:function(e){this.scheduledPause=e}}],i&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(s.Observer);t.default=m,h(m,"scriptBufferSize",256),e.exports=t.default},"./node_modules/debounce/index.js":e=>{function t(e,t,i){var n,s,l,o,a;function r(){var u=Date.now()-o;u<t&&u>=0?n=setTimeout(r,t-u):(n=null,i||(a=e.apply(l,s),l=s=null))}null==t&&(t=100);var u=function(){l=this,s=arguments,o=Date.now();var u=i&&!n;return n||(n=setTimeout(r,t)),u&&(a=e.apply(l,s),l=s=null),a};return u.clear=function(){n&&(clearTimeout(n),n=null)},u.flush=function(){n&&(a=e.apply(l,s),l=s=null,clearTimeout(n),n=null)},u}t.debounce=t,e.exports=t}},t={},i=function i(n){var s=t[n];if(void 0!==s)return s.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,i),l.exports}("./src/wavesurfer.js"),i;var e,t,i},e.exports=t()}}]);